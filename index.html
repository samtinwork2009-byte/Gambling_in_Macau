<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豪華博彩娛樂模擬系統體驗 | 澳門至尊VIP娛樂平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #c62828;
            --primary-dark: #8b0000;
            --primary-light: #ff5252;
            --secondary-color: #0a0a0a;
            --accent-gold: #ffd700;
            --accent-gold-light: #ffed85;
            --accent-silver: #c0c0c0;
            --accent-bronze: #cd7f32;
            --vip-purple: #9c27b0;
            --diamond-blue: #00bcd4;
            --emerald-green: #00c853;
            --ruby-red: #ff1744;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #ff4444;
            --dark-color: #1a1a1a;
            --darker-color: #0a0a0a;
            --light-color: #ffffff;
            --light-gray: #f5f5f5;
            --shadow-heavy: 0 10px 30px rgba(0, 0, 0, 0.5);
            --shadow-medium: 0 5px 15px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --border-radius-lg: 20px;
            --border-radius-xl: 30px;
            --glow-gold: 0 0 20px rgba(255, 215, 0, 0.5);
            --glow-purple: 0 0 20px rgba(156, 39, 176, 0.5);
            --glow-blue: 0 0 20px rgba(0, 188, 212, 0.5);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 30%, #0a0a1a 70%, #0a0a0a 100%);
            color: var(--light-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(198, 40, 40, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(255, 215, 0, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 50% 50%, rgba(156, 39, 176, 0.1) 0%, transparent 35%),
                radial-gradient(circle at 30% 70%, rgba(0, 188, 212, 0.1) 0%, transparent 30%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            z-index: -2;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        /* 霓虹燈大標題 - 漸變色效果 */
        .main-header {
            text-align: center;
            padding: 30px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, 
                rgba(20, 20, 20, 0.95) 0%, 
                rgba(30, 0, 0, 0.95) 50%, 
                rgba(20, 0, 20, 0.95) 100%);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-heavy), inset 0 0 0 2px rgba(255, 215, 0, 0.2);
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
            background-clip: padding-box;
        }
        
        .main-header::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                var(--primary-color), 
                var(--accent-gold), 
                var(--vip-purple), 
                var(--diamond-blue),
                var(--primary-color));
            border-radius: var(--border-radius-xl);
            z-index: -1;
            animation: borderGlow 3s linear infinite;
            background-size: 400% 400%;
        }
        
        @keyframes borderGlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .main-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(90deg, 
                #ffffff 0%, 
                var(--accent-gold) 25%, 
                #ffffff 50%, 
                var(--accent-gold) 75%, 
                #ffffff 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            animation: shine 3s linear infinite;
        }
        
        @keyframes shine {
            to { background-position: 200% center; }
        }
        
        .subtitle {
            font-size: 1.4rem;
            opacity: 0.9;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            background: linear-gradient(90deg, #ffd700, #ffed85, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* 頁面容器 */
        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            animation: pageFadeIn 0.5s ease forwards;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes pageFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* 導航按鈕 */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        /* 按鈕系統 */
        .btn {
            padding: 18px 36px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 50px;
            font-weight: 800;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(198, 40, 40, 0.4);
            font-size: 1.1rem;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(198, 40, 40, 0.6);
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
        }
        
        .btn-gold {
            background: linear-gradient(135deg, var(--accent-gold), #ff8c00);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }
        
        .btn-gold:hover {
            background: linear-gradient(135deg, var(--accent-gold-light), var(--accent-gold));
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--vip-purple), #7b1fa2);
            box-shadow: 0 5px 20px rgba(156, 39, 176, 0.4);
        }
        
        .btn-purple:hover {
            background: linear-gradient(135deg, #ba68c8, var(--vip-purple));
        }
        
        .btn-blue {
            background: linear-gradient(135deg, var(--diamond-blue), #0097a7);
            box-shadow: 0 5px 20px rgba(0, 188, 212, 0.4);
        }
        
        .btn-blue:hover {
            background: linear-gradient(135deg, #80deea, var(--diamond-blue));
        }
        
        .btn-green {
            background: linear-gradient(135deg, var(--success-color), #2e7d32);
            box-shadow: 0 5px 20px rgba(76, 175, 80, 0.4);
        }
        
        .btn-green:hover {
            background: linear-gradient(135deg, #66bb6a, var(--success-color));
        }
        
        /* 類別選擇邊框 */
        .category-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .category-box {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .category-box:hover {
            transform: translateY(-10px);
            border-color: var(--accent-gold);
            box-shadow: var(--shadow-heavy), var(--glow-gold);
        }
        
        .category-icon {
            font-size: 4rem;
            color: var(--accent-gold);
            margin-bottom: 20px;
        }
        
        .category-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(90deg, #ffffff, var(--accent-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .category-description {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
        }
        
        /* 遊戲說明系統 */
        .instructions-container {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 20, 0, 0.8));
            border-radius: var(--border-radius-xl);
            padding: 40px;
            margin-top: 30px;
            box-shadow: var(--shadow-heavy);
            border: 2px solid rgba(0, 255, 0, 0.3);
        }
        
        .instruction-step {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(0, 255, 0, 0.05);
            border-radius: var(--border-radius);
            border-left: 4px solid #00c853;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #00c853, #00ff00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: var(--darker-color);
            flex-shrink: 0;
        }
        
        /* 遊戲模擬區域 */
        .game-simulation {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(30, 0, 0, 0.8));
            border-radius: var(--border-radius-xl);
            padding: 40px;
            margin-top: 30px;
            box-shadow: var(--shadow-heavy);
            border: 2px solid rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .game-simulation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-gold), var(--vip-purple));
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .balance-display {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(30, 0, 0, 0.9));
            padding: 20px 35px;
            border-radius: var(--border-radius-lg);
            font-size: 2.2rem;
            font-weight: 900;
            color: var(--accent-gold);
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: var(--shadow-medium);
            border: 2px solid rgba(255, 215, 0, 0.3);
            min-width: 300px;
        }
        
        /* 賭枱樣式 */
        .betting-table {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 12px;
            margin: 40px 0;
            padding: 30px;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
            border-radius: var(--border-radius-lg);
            border: 2px solid rgba(255, 215, 0, 0.2);
        }
        
        .bet-cell {
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 700;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }
        
        .bet-cell:hover {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.2));
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }
        
        .bet-cell.selected {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.5), rgba(255, 215, 0, 0.3));
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            color: var(--darker-color);
            font-weight: 900;
        }
        
        /* 卡片樣式 */
        .card {
            width: 100px;
            height: 140px;
            background: linear-gradient(135deg, #ffffff, #f0f0f0);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: #c62828;
            font-weight: bold;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: scale(1.05);
        }
        
        .card.suit-heart, .card.suit-diamond {
            color: #c62828;
        }
        
        .card.suit-club, .card.suit-spade {
            color: #000000;
        }
        
        /* 老虎機樣式 */
        .slot-machine {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            perspective: 1000px;
        }
        
        .slot-reel {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #ffffff, #e0e0e0);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.4), 0 10px 25px rgba(0, 0, 0, 0.3);
            transition: transform 0.1s ease;
        }
        
        .slot-reel.spinning {
            animation: slotSpin 0.1s linear infinite;
        }
        
        @keyframes slotSpin {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }
        
        /* 輪盤樣式 */
        .roulette-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin: 40px 0;
        }
        
        .roulette-wheel {
            width: 350px;
            height: 350px;
            border-radius: 50%;
            background: conic-gradient(
                red 0deg 15deg,
                black 15deg 30deg,
                red 30deg 45deg,
                black 45deg 60deg,
                red 60deg 75deg,
                black 75deg 90deg,
                red 90deg 105deg,
                black 105deg 120deg,
                red 120deg 135deg,
                black 135deg 150deg,
                red 150deg 165deg,
                black 165deg 180deg,
                red 180deg 195deg,
                black 195deg 210deg,
                red 210deg 225deg,
                black 225deg 240deg,
                red 240deg 255deg,
                black 255deg 270deg,
                red 270deg 285deg,
                black 285deg 300deg,
                red 300deg 315deg,
                black 315deg 330deg,
                red 330deg 345deg,
                black 345deg 360deg
            );
            position: relative;
            transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);
            margin-bottom: 40px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.8), inset 0 0 30px rgba(0, 0, 0, 0.5);
            border: 8px solid var(--accent-gold);
        }
        
        .roulette-pointer {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid var(--accent-gold);
            z-index: 10;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
        }
        
        /* 提示系統 */
        .hint-box {
            background: linear-gradient(135deg, rgba(0, 188, 212, 0.1), rgba(0, 188, 212, 0.05));
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--diamond-blue);
        }
        
        .hint-title {
            font-weight: 700;
            color: var(--diamond-blue);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* 結果彈窗 */
        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .result-content {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 0, 0, 0.95));
            padding: 40px;
            border-radius: var(--border-radius-xl);
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 3px solid var(--accent-gold);
            box-shadow: var(--shadow-heavy);
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* 麻將牌樣式 */
        .mahjong-tile {
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, #ffffff, #f0f0f0);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #c62828;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.2s ease;
            padding: 5px;
        }
        
        .mahjong-tile:hover {
            transform: translateY(-5px);
        }
        
        .mahjong-tile.selected {
            background: linear-gradient(135deg, #ffed85, #ffd700);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }
        
        /* 頁腳 */
        .main-footer {
            text-align: center;
            padding: 40px;
            margin-top: 60px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(30, 0, 0, 0.9));
            border-radius: var(--border-radius-xl);
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.6);
            border-top: 3px solid rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .main-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
        }
        
        .disclaimer {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.2), rgba(255, 152, 0, 0.1));
            padding: 25px;
            border-radius: var(--border-radius-lg);
            margin-top: 40px;
            border-left: 6px solid var(--warning-color);
            box-shadow: var(--shadow-medium);
        }
        
        /* 遊戲歷史記錄 */
        .history-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-item.win {
            color: var(--accent-gold);
        }
        
        .history-item.loss {
            color: var(--primary-color);
        }
        
        /* 進度條 */
        .progress-bar {
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-gold), #ff8c00);
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        
        /* 賽馬場地樣式 */
        .race-track {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #228b22, #2e8b57);
            border-radius: var(--border-radius-lg);
            position: relative;
            overflow: hidden;
            margin: 30px 0;
            border: 5px solid #8b4513;
        }
        
        .race-lane {
            position: absolute;
            height: 40px;
            width: 100%;
            border-bottom: 2px dashed rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
        }
        
        .race-horse {
            width: 50px;
            height: 40px;
            background-size: contain;
            background-repeat: no-repeat;
            position: absolute;
            transition: left 0.1s linear;
        }
        
        /* 彩票號碼樣式 */
        .lottery-numbers {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 30px 0;
        }
        
        .lottery-ball {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #ffffff, #ff5252);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* 任務與成就樣式 */
        .task-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-gold);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        /* 排行榜樣式 */
        .leaderboard {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .leaderboard-rank {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-gold), #ff8c00);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: var(--darker-color);
        }
        
        /* 分析圖表樣式 */
        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 20px 0;
            height: 300px;
            position: relative;
        }
        
        /* 手機版適應 */
        @media (max-width: 1200px) {
            .container {
                padding: 15px;
            }
            
            .main-title {
                font-size: 2.8rem;
            }
            
            .category-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            
            .betting-table {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .main-title {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .category-container {
                grid-template-columns: 1fr;
            }
            
            .balance-display {
                min-width: 100%;
                justify-content: center;
                font-size: 1.8rem;
                padding: 15px 25px;
            }
            
            .game-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .betting-table {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .btn {
                padding: 15px 25px;
                font-size: 1rem;
            }
            
            .roulette-wheel {
                width: 280px;
                height: 280px;
            }
            
            .slot-reel {
                width: 80px;
                height: 80px;
                font-size: 2.5rem;
            }
            
            .race-track {
                height: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .main-title {
                font-size: 1.8rem;
            }
            
            .category-box {
                padding: 20px;
            }
            
            .category-icon {
                font-size: 3rem;
            }
            
            .category-title {
                font-size: 1.5rem;
            }
            
            .betting-table {
                grid-template-columns: repeat(3, 1fr);
                padding: 15px;
                gap: 8px;
            }
            
            .bet-cell {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .lottery-ball {
                width: 45px;
                height: 45px;
                font-size: 1.4rem;
            }
        }
        
        /* 載入動畫 */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            flex-direction: column;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 215, 0, 0.3);
            border-top-color: var(--accent-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 工具輸入框 */
        .tool-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: var(--border-radius);
            color: white;
            font-size: 1.2rem;
        }
        
        .tool-input:focus {
            outline: none;
            border-color: var(--accent-gold);
        }
        
        /* 統計卡片 */
        .stat-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent-gold);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        /* 新增功能專用樣式 */
        .theme-selector {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .theme-option {
            width: 100px;
            height: 60px;
            border-radius: 10px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
        }
        
        .theme-option.selected {
            border-color: var(--accent-gold);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }
        
        .theme-chinese {
            background: linear-gradient(135deg, #d32f2f, #f44336);
        }
        
        .theme-christmas {
            background: linear-gradient(135deg, #2e7d32, #d32f2f);
        }
        
        .theme-lunar {
            background: linear-gradient(135deg, #ff9800, #ff5722);
        }
        
        .theme-ocean {
            background: linear-gradient(135deg, #1976d2, #0288d1);
        }
        
        .profile-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255, 215, 0, 0.2);
        }
        
        .badge-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .badge-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 120px;
            text-align: center;
        }
        
        .badge-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .badge-locked {
            filter: grayscale(1) brightness(0.5);
        }
        
        .time-reminder {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--warning-color), #ff5722);
            color: white;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            z-index: 100;
            animation: pulse 2s infinite;
            display: none;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .ai-coach-container {
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            border: 2px solid var(--vip-purple);
        }
        
        .coach-message {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid var(--vip-purple);
        }
        
        .exchange-market {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .exchange-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255, 215, 0, 0.2);
            transition: var(--transition);
        }
        
        .exchange-item:hover {
            transform: translateY(-5px);
            border-color: var(--accent-gold);
            box-shadow: var(--shadow-medium);
        }
        
        .risk-test-container {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), rgba(244, 67, 54, 0.05));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            border: 2px solid var(--primary-color);
        }
        
        .test-question {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
        }
        
        .test-option {
            margin: 10px 0;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .test-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .test-option.selected {
            background: rgba(244, 67, 54, 0.3);
            border-left: 4px solid var(--primary-color);
        }
        
        .knowledge-base {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .knowledge-card {
            background: linear-gradient(135deg, rgba(0, 188, 212, 0.1), rgba(0, 188, 212, 0.05));
            border-radius: var(--border-radius);
            padding: 25px;
            border: 2px solid var(--diamond-blue);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .knowledge-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .case-study {
            background: linear-gradient(135deg, rgba(96, 125, 139, 0.1), rgba(96, 125, 139, 0.05));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #607d8b;
        }
        
        .share-button {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            transition: var(--transition);
        }
        
        .share-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }
        
        .room-container {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
            border-radius: var(--border-radius-xl);
            padding: 30px;
            margin: 30px 0;
            border: 2px solid var(--accent-gold);
        }
        
        .player-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 10px;
        }
    </style>
</head>
<body>
    <!-- 遊戲時間提醒 -->
    <div id="time-reminder" class="time-reminder">
        <i class="fas fa-clock"></i> 您已連續遊戲超過1小時，建議休息一下！
        <button onclick="hideReminder()" style="margin-left: 15px; background: transparent; border: none; color: white; cursor: pointer;">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <div class="container">
        <!-- 主頁 -->
        <div id="main-page" class="page active">
            <!-- 大標題 -->
            <header class="main-header">
                <h1 class="main-title">豪華博彩娛樂模擬系統體驗</h1>
                <p class="subtitle">澳門至尊博彩娛樂平台 - 模擬遊戲</p>
            </header>
            
            <!-- 玩家資訊 -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 20px;">
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--accent-gold), #ff8c00); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--darker-color);">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent-gold);">VIP玩家</div>
                        <div style="color: rgba(255,255,255,0.7);">鑽石會員 等級 5</div>
                    </div>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="main-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <!-- 遊戲簡介 -->
            <div style="text-align: center; margin: 40px 0;">
                <h2 style="font-size: 2.2rem; margin-bottom: 20px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    歡迎來到澳門豪華博彩模擬平台
                </h2>
                <p style="font-size: 1.2rem; color: rgba(255,255,255,0.8); max-width: 800px; margin: 0 auto 40px; line-height: 1.6;">
                    體驗最真實的澳門博彩娛樂環境，包含多種經典博彩遊戲、專業工具系統和多層級VIP體驗。所有遊戲使用虛擬貨幣，僅供娛樂和教育目的。
                </p>
                
                <!-- 平台操作指南按鈕 -->
                <div style="margin: 40px 0;">
                    <button class="btn btn-green" onclick="showPage('instructions-page')">
                        <i class="fas fa-book"></i> 平台操作指南
                    </button>
                    
                    <!-- 新增功能按鈕 -->
                    <button class="btn btn-purple" onclick="showPage('tasks-page')" style="margin-left: 15px;">
                        <i class="fas fa-tasks"></i> 任務與成就
                    </button>
                    
                    <button class="btn btn-blue" onclick="showPage('knowledge-page')" style="margin-left: 15px;">
                        <i class="fas fa-graduation-cap"></i> 博彩知識
                    </button>
                </div>
                
                <!-- 提示 -->
                <div class="hint-box" style="max-width: 800px; margin: 30px auto;">
                    <div class="hint-title">
                        <i class="fas fa-info-circle"></i> 平台使用提示
                    </div>
                    <p>1. 點擊下方類別選擇進入不同遊戲區域<br>
                    2. 每個頁面都是獨立的，不會互相干擾<br>
                    3. 使用「平台操作指南」了解詳細玩法<br>
                    4. 所有頁面都有返回主頁和上一頁按鈕<br>
                    5. 新增主題切換功能，點擊右上角主題按鈕體驗</p>
                </div>
            </div>
            
            <!-- 主題切換 -->
            <div style="text-align: right; margin-bottom: 20px;">
                <button class="btn" onclick="toggleThemeSelector()" style="padding: 10px 20px;">
                    <i class="fas fa-palette"></i> 切換主題
                </button>
                
                <div id="theme-selector" style="display: none; margin-top: 15px;">
                    <div class="theme-selector">
                        <div class="theme-option theme-chinese selected" onclick="changeTheme('default')" title="默認主題"></div>
                        <div class="theme-option theme-christmas" onclick="changeTheme('christmas')" title="聖誕主題"></div>
                        <div class="theme-option theme-lunar" onclick="changeTheme('lunar')" title="新春主題"></div>
                        <div class="theme-option theme-ocean" onclick="changeTheme('ocean')" title="海洋主題"></div>
                    </div>
                </div>
            </div>
            
            <!-- 類別選擇邊框 -->
            <h3 style="text-align: center; font-size: 1.8rem; margin: 40px 0 20px; color: var(--accent-gold);">
                <i class="fas fa-th-large"></i> 選擇遊戲類別
            </h3>
            
            <div class="category-container">
                <div class="category-box" onclick="showPage('poker-page')">
                    <div class="category-icon">
                        <i class="fas fa-club"></i>
                    </div>
                    <div class="category-title">紙牌遊戲</div>
                    <div class="category-description">
                        包含德州撲克、二十一點、百家樂等經典紙牌遊戲，與AI智能對手對戰。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('mahjong-page')">
                    <div class="category-icon">
                        <i class="fas fa-chess-board"></i>
                    </div>
                    <div class="category-title">澳門麻將</div>
                    <div class="category-description">
                        經典澳門麻將玩法，包含多種番型和規則，真實計番系統。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('roulette-page')">
                    <div class="category-icon">
                        <i class="fas fa-circle-notch"></i>
                    </div>
                    <div class="category-title">輪盤賭博</div>
                    <div class="category-description">
                        歐洲輪盤遊戲，多種投注方式，實時動畫效果，真實賠率計算。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('slot-page')">
                    <div class="category-icon">
                        <i class="fas fa-sliders-h"></i>
                    </div>
                    <div class="category-title">老虎機</div>
                    <div class="category-description">
                        經典老虎機遊戲，多種主題和累積獎金，簡單易玩。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('tools-page')">
                    <div class="category-icon">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="category-title">專業工具</div>
                    <div class="category-description">
                        賠率計算器、資金管理、勝率分析等專業工具，輔助遊戲決策。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('vip-page')">
                    <div class="category-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="category-title">VIP專區</div>
                    <div class="category-description">
                        多層級VIP系統，專屬功能和獎勵，至尊娛樂體驗。
                    </div>
                </div>
                
                <!-- 新增遊戲類別 -->
                <div class="category-box" onclick="showPage('racing-page')">
                    <div class="category-icon">
                        <i class="fas fa-horse"></i>
                    </div>
                    <div class="category-title">賽馬/賽狗</div>
                    <div class="category-description">
                        還原澳門賽事場景，虛擬投注、賽事數據分析，即時賽事動畫。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('lottery-page')">
                    <div class="category-icon">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <div class="category-title">彩票模擬</div>
                    <div class="category-description">
                        包含樂透、賓果等玩法，隨機搖號、獎池累積，歷史開獎記錄查詢。
                    </div>
                </div>
                
                <div class="category-box" onclick="showPage('social-page')">
                    <div class="category-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="category-title">社交互動</div>
                    <div class="category-description">
                        排行榜系統、多人聯機模擬、遊戲錄影分享，提升用戶參與感。
                    </div>
                </div>
            </div>
            
            <!-- 下一頁按鈕 -->
            <div style="text-align: center; margin-top: 50px;">
                <button class="btn btn-gold" onclick="showPage('instructions-page')">
                    <i class="fas fa-arrow-right"></i> 下一頁：平台操作指南
                </button>
            </div>
            
            <!-- 遊戲歷史記錄 -->
            <div style="margin-top: 60px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px;">
                    <i class="fas fa-history"></i> 最近遊戲記錄
                </h3>
                <div class="history-container" id="main-history">
                    <!-- 遊戲歷史記錄會在這裡動態顯示 -->
                </div>
            </div>
            
            <!-- 免責聲明 -->
            <div class="disclaimer" style="margin-top: 60px;">
                <h4 style="color: var(--warning-color); margin-bottom: 15px;">
                    <i class="fas fa-exclamation-triangle"></i> 重要聲明
                </h4>
                <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                    本系統為純粹的博彩娛樂模擬體驗平台，僅供娛樂和教育目的。所有遊戲使用虛擬貨幣，不涉及真實金錢交易。本系統不鼓勵真實賭博行為，實際賭博可能導致嚴重的財務損失和心理問題。
                </p>
            </div>
        </div>
        
        <!-- 平台操作指南頁 -->
        <div id="instructions-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--success-color), #66bb6a); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-book"></i> 平台操作指南
                </h2>
                <p style="color: rgba(255,255,255,0.8);">詳細了解平台操作方法和遊戲規則</p>
            </div>
            
            <div class="instructions-container">
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">平台導航</h3>
                        <p>每個頁面都是獨立的，使用頁面頂部的「返回主頁」或「返回上一頁」按鈕進行導航。主頁包含所有類別選擇，進入後續頁面體驗具體遊戲。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">遊戲選擇</h3>
                        <p>在主頁選擇您感興趣的遊戲類別，系統將進入對應的模擬頁面。每個遊戲頁面都包含完整的遊戲設置和AI對手選擇功能。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">虛擬資金</h3>
                        <p>系統使用虛擬貨幣進行遊戲，不涉及真實金錢交易。所有玩家起始資金相同，可通過遊戲勝利增加虛擬資金。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">4</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">AI對手</h3>
                        <p>每個遊戲都配備多個難度級別的AI對手，從初學者到專家級。可以根據自己的水平選擇合適的對手進行對戰。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">5</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">專業工具</h3>
                        <p>平台提供多種專業工具，包括賠率計算器、資金管理工具和勝率分析，幫助您做出更明智的遊戲決策。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">6</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">VIP系統</h3>
                        <p>通過遊戲表現可以提升VIP等級，解鎖更多專屬功能和獎勵。VIP等級從青銅到鑽石，提供不同級別的娛樂體驗。</p>
                    </div>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">7</div>
                    <div>
                        <h3 style="color: var(--accent-gold); margin-bottom: 10px;">新增功能</h3>
                        <p>系統新增賽馬/賽狗、彩票模擬、社交互動、任務與成就、主題切換、AI教練、風險評測等多種功能，全面提升遊戲體驗。</p>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
                <button class="btn btn-gold" onclick="showPage('poker-page')">
                    下一頁：紙牌遊戲 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 紙牌遊戲頁 -->
        <div id="poker-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('instructions-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-club"></i> 紙牌遊戲模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">包含德州撲克、二十一點、百家樂等經典紙牌遊戲</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="poker-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>選擇您想玩的紙牌遊戲，設置下注金額和AI對手難度，點擊「開始遊戲」按鈕開始模擬。</p>
            </div>
            
            <!-- 遊戲選擇 -->
            <div style="margin: 40px 0;">
                <h3 style="font-size: 1.8rem; margin-bottom: 20px; color: var(--accent-gold);">
                    <i class="fas fa-gamepad"></i> 選擇遊戲類型
                </h3>
                
                <div style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
                    <button class="btn" onclick="selectPokerGame('texas')" id="texas-btn">
                        <i class="fas fa-club"></i> 德州撲克
                    </button>
                    <button class="btn" onclick="selectPokerGame('blackjack')" id="blackjack-btn">
                        <i class="fas fa-spade"></i> 二十一點
                    </button>
                    <button class="btn" onclick="selectPokerGame('baccarat')" id="baccarat-btn">
                        <i class="fas fa-gem"></i> 百家樂
                    </button>
                    <button class="btn" onclick="selectPokerGame('dragon')" id="dragon-btn">
                        <i class="fas fa-dragon"></i> 龍虎鬥
                    </button>
                    <button class="btn" onclick="selectPokerGame('three')" id="three-btn">
                        <i class="fas fa-crown"></i> 三公
                    </button>
                </div>
            </div>
            
            <!-- 德州撲克遊戲區域 -->
            <div id="texas-game" class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    德州撲克模擬
                </h3>
                
                <div style="display: flex; justify-content: center; gap: 40px; margin-bottom: 40px; flex-wrap: wrap;">
                    <!-- AI玩家1 -->
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white; border: 3px solid var(--accent-gold);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">AI玩家1</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">籌碼: <span id="ai1-chips">50,000</span></div>
                    </div>
                    
                    <!-- AI玩家2 -->
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--vip-purple), #7b1fa2); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white; border: 3px solid var(--accent-gold);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">AI玩家2</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">籌碼: <span id="ai2-chips">75,000</span></div>
                    </div>
                    
                    <!-- 公共牌 -->
                    <div style="text-align: center;">
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 15px;">公共牌</div>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <div class="card" id="community-card1">?</div>
                            <div class="card" id="community-card2">?</div>
                            <div class="card" id="community-card3">?</div>
                            <div class="card" id="community-card4">?</div>
                            <div class="card" id="community-card5">?</div>
                        </div>
                    </div>
                    
                    <!-- 玩家 -->
                    <div style="text-align: center;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--accent-gold), #ff8c00); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: var(--darker-color); border: 3px solid var(--accent-gold);">
                            <i class="fas fa-user"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">您</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">籌碼: <span id="player-chips">100,000</span></div>
                    </div>
                </div>
                
                <!-- 玩家手牌 -->
                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 15px;">您的手牌</div>
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <div class="card" id="player-card1">A♠</div>
                        <div class="card" id="player-card2">K♠</div>
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; flex-wrap: wrap;">
                    <button class="btn btn-gold" onclick="playTexasPoker()" id="start-poker-btn">
                        <i class="fas fa-play"></i> 開始新遊戲
                    </button>
                    <button class="btn" onclick="texasPokerAction('fold')" id="fold-btn" disabled>
                        棄牌
                    </button>
                    <button class="btn" onclick="texasPokerAction('call')" id="call-btn" disabled>
                        跟注
                    </button>
                    <button class="btn" onclick="texasPokerAction('raise')" id="raise-btn" disabled>
                        加注
                    </button>
                    
                    <!-- 手牌分析工具按鈕 -->
                    <button class="btn btn-blue" onclick="analyzePokerHand()" id="analyze-btn">
                        <i class="fas fa-brain"></i> 手牌分析
                    </button>
                </div>
                
                <!-- 下注控制 -->
                <div style="text-align: center; margin-top: 30px;">
                    <div style="margin-bottom: 15px; color: rgba(255,255,255,0.8);">下注金額</div>
                    <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                        <input type="range" min="100" max="5000" value="500" step="100" id="poker-bet-slider" style="width: 300px;">
                        <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.2rem;">
                            <span id="poker-bet-amount">500</span> MOP
                        </div>
                    </div>
                </div>
                
                <!-- 遊戲狀態 -->
                <div style="text-align: center; margin-top: 30px; color: rgba(255,255,255,0.8);">
                    <div id="poker-status">等待遊戲開始...</div>
                    <div id="pot-amount" style="color: var(--accent-gold); font-weight: 700; margin-top: 10px;">底池: 0 MOP</div>
                </div>
                
                <!-- 手牌分析結果 -->
                <div id="poker-analysis" style="display: none; margin-top: 30px; padding: 20px; background: rgba(0, 188, 212, 0.1); border-radius: var(--border-radius); border-left: 4px solid var(--diamond-blue);">
                    <h4 style="color: var(--diamond-blue); margin-bottom: 15px;"><i class="fas fa-brain"></i> 手牌分析結果</h4>
                    <div id="analysis-content">
                        <!-- 分析結果會在這裡動態顯示 -->
                    </div>
                </div>
            </div>
            
            <!-- 遊戲結果顯示 -->
            <div id="poker-result" style="display: none; text-align: center; margin-top: 40px;">
                <!-- 由JavaScript動態生成 -->
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('instructions-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('mahjong-page')">
                    下一頁：澳門麻將 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 澳門麻將頁 -->
        <div id="mahjong-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('poker-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-chess-board"></i> 澳門麻將模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">經典澳門麻將玩法，包含多種番型和規則</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="mahjong-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>澳門麻將使用144張牌，包含花牌。可以吃、碰、槓，胡牌需要至少一番。選擇AI對手難度後開始遊戲。</p>
            </div>
            
            <!-- 麻將遊戲區域 -->
            <div class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    澳門麻將遊戲
                </h3>
                
                <!-- 麻將桌 -->
                <div style="position: relative; height: 500px; background: linear-gradient(135deg, #2e8b57, #228b22); border-radius: var(--border-radius-lg); border: 10px solid #8b4513; margin-bottom: 40px; overflow: hidden;">
                    <!-- 東風玩家 -->
                    <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); text-align: center;">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; border: 2px solid var(--accent-gold);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">東風 (AI)</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;"><span id="east-tiles">13</span>張牌</div>
                    </div>
                    
                    <!-- 南風玩家 -->
                    <div style="position: absolute; top: 50%; right: 20px; transform: translateY(-50%); text-align: center;">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--vip-purple), #7b1fa2); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; border: 2px solid var(--accent-gold);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">南風 (AI)</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;"><span id="south-tiles">13</span>張牌</div>
                    </div>
                    
                    <!-- 西風玩家 -->
                    <div style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); text-align: center;">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--diamond-blue), #0097a7); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; border: 2px solid var(--accent-gold);">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">西風 (AI)</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;"><span id="west-tiles">13</span>張牌</div>
                    </div>
                    
                    <!-- 北風玩家 (您) -->
                    <div style="position: absolute; top: 50%; left: 20px; transform: translateY(-50%); text-align: center;">
                        <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--accent-gold), #ff8c00); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: var(--darker-color); border: 2px solid var(--accent-gold);">
                            <i class="fas fa-user"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold);">北風 (您)</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;"><span id="player-tiles">13</span>張牌</div>
                    </div>
                    
                    <!-- 牌牆 -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 15px;">牌牆剩餘</div>
                        <div style="font-size: 3rem; color: rgba(255,255,255,0.7);" id="wall-tiles">
                            72
                        </div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">張牌</div>
                    </div>
                </div>
                
                <!-- 玩家手牌區域 -->
                <div style="margin-bottom: 40px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 15px;">您的手牌</h4>
                    <div id="player-hand" style="display: flex; gap: 10px; flex-wrap: wrap; min-height: 80px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: var(--border-radius);">
                        <!-- 麻將牌會在這裡動態生成 -->
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; flex-wrap: wrap;">
                    <button class="btn btn-gold" onclick="playMahjong()" id="start-mahjong-btn">
                        <i class="fas fa-play"></i> 開始新局
                    </button>
                    <button class="btn" onclick="mahjongAction('draw')" id="draw-btn" disabled>
                        摸牌
                    </button>
                    <button class="btn" onclick="mahjongAction('discard')" id="discard-btn" disabled>
                        出牌
                    </button>
                    <button class="btn" onclick="mahjongAction('pong')" id="pong-btn" disabled>
                        碰
                    </button>
                    <button class="btn" onclick="mahjongAction('kong')" id="kong-btn" disabled>
                        槓
                    </button>
                    <button class="btn" onclick="mahjongAction('win')" id="win-btn" disabled>
                        胡牌
                    </button>
                    
                    <!-- 麻將分析工具按鈕 -->
                    <button class="btn btn-blue" onclick="analyzeMahjongHand()" id="mahjong-analyze-btn">
                        <i class="fas fa-lightbulb"></i> 牌型分析
                    </button>
                </div>
                
                <!-- 遊戲信息 -->
                <div style="text-align: center; color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                    當前圈風: <span style="color: var(--accent-gold); font-weight: 700;" id="current-wind">東風圈</span> | 
                    當前局數: <span style="color: var(--accent-gold); font-weight: 700;" id="current-round">第1局</span> | 
                    底注: <span style="color: var(--accent-gold); font-weight: 700;" id="base-bet">100</span> MOP
                </div>
                
                <div style="text-align: center; color: var(--accent-gold); font-weight: 700;" id="mahjong-status">
                    等待遊戲開始...
                </div>
                
                <!-- 麻將分析結果 -->
                <div id="mahjong-analysis" style="display: none; margin-top: 30px; padding: 20px; background: rgba(0, 188, 212, 0.1); border-radius: var(--border-radius); border-left: 4px solid var(--diamond-blue);">
                    <h4 style="color: var(--diamond-blue); margin-bottom: 15px;"><i class="fas fa-lightbulb"></i> 牌型分析結果</h4>
                    <div id="mahjong-analysis-content">
                        <!-- 分析結果會在這裡動態顯示 -->
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('poker-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('roulette-page')">
                    下一頁：輪盤賭博 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 輪盤賭博頁 -->
        <div id="roulette-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('mahjong-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-circle-notch"></i> 輪盤賭博模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">歐洲輪盤遊戲，37個數字，多種投注組合</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="roulette-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>輪盤有37個數字（0-36），0為綠色，其餘紅色和黑色交替。可以投注紅色/黑色、單一數字、數字組合等。</p>
            </div>
            
            <!-- 輪盤遊戲區域 -->
            <div class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    歐洲輪盤
                </h3>
                
                <!-- 輪盤 -->
                <div class="roulette-container">
                    <div class="roulette-pointer"></div>
                    <div class="roulette-wheel" id="roulette-wheel"></div>
                </div>
                
                <!-- 投注區域 -->
                <div style="margin: 40px 0;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">投注區域</h4>
                    <div class="betting-table" id="roulette-betting-table">
                        <!-- 數字投注區域 -->
                        <div class="bet-cell" onclick="selectRouletteBet('0')">0</div>
                        <div class="bet-cell" onclick="selectRouletteBet('1')">1</div>
                        <div class="bet-cell" onclick="selectRouletteBet('2')">2</div>
                        <div class="bet-cell" onclick="selectRouletteBet('3')">3</div>
                        <div class="bet-cell" onclick="selectRouletteBet('4')">4</div>
                        <div class="bet-cell" onclick="selectRouletteBet('5')">5</div>
                        <div class="bet-cell" onclick="selectRouletteBet('6')">6</div>
                        <div class="bet-cell" onclick="selectRouletteBet('7')">7</div>
                        
                        <!-- 第二排 -->
                        <div class="bet-cell" onclick="selectRouletteBet('8')">8</div>
                        <div class="bet-cell" onclick="selectRouletteBet('9')">9</div>
                        <div class="bet-cell" onclick="selectRouletteBet('10')">10</div>
                        <div class="bet-cell" onclick="selectRouletteBet('11')">11</div>
                        <div class="bet-cell" onclick="selectRouletteBet('12')">12</div>
                        <div class="bet-cell" onclick="selectRouletteBet('13')">13</div>
                        <div class="bet-cell" onclick="selectRouletteBet('14')">14</div>
                        <div class="bet-cell" onclick="selectRouletteBet('15')">15</div>
                        
                        <!-- 第三排 -->
                        <div class="bet-cell" onclick="selectRouletteBet('16')">16</div>
                        <div class="bet-cell" onclick="selectRouletteBet('17')">17</div>
                        <div class="bet-cell" onclick="selectRouletteBet('18')">18</div>
                        <div class="bet-cell" onclick="selectRouletteBet('19')">19</div>
                        <div class="bet-cell" onclick="selectRouletteBet('20')">20</div>
                        <div class="bet-cell" onclick="selectRouletteBet('21')">21</div>
                        <div class="bet-cell" onclick="selectRouletteBet('22')">22</div>
                        <div class="bet-cell" onclick="selectRouletteBet('23')">23</div>
                        
                        <!-- 第四排 -->
                        <div class="bet-cell" onclick="selectRouletteBet('24')">24</div>
                        <div class="bet-cell" onclick="selectRouletteBet('25')">25</div>
                        <div class="bet-cell" onclick="selectRouletteBet('26')">26</div>
                        <div class="bet-cell" onclick="selectRouletteBet('27')">27</div>
                        <div class="bet-cell" onclick="selectRouletteBet('28')">28</div>
                        <div class="bet-cell" onclick="selectRouletteBet('29')">29</div>
                        <div class="bet-cell" onclick="selectRouletteBet('30')">30</div>
                        <div class="bet-cell" onclick="selectRouletteBet('31')">31</div>
                        
                        <!-- 第五排 -->
                        <div class="bet-cell" onclick="selectRouletteBet('32')">32</div>
                        <div class="bet-cell" onclick="selectRouletteBet('33')">33</div>
                        <div class="bet-cell" onclick="selectRouletteBet('34')">34</div>
                        <div class="bet-cell" onclick="selectRouletteBet('35')">35</div>
                        <div class="bet-cell" onclick="selectRouletteBet('36')">36</div>
                        
                        <!-- 特殊投注 -->
                        <div class="bet-cell" style="grid-column: span 2; background: linear-gradient(135deg, rgba(255,0,0,0.3), rgba(255,0,0,0.2));" onclick="selectRouletteBet('red')">
                            紅色
                        </div>
                        <div class="bet-cell" style="grid-column: span 2; background: linear-gradient(135deg, rgba(0,0,0,0.3), rgba(0,0,0,0.2));" onclick="selectRouletteBet('black')">
                            黑色
                        </div>
                        <div class="bet-cell" style="grid-column: span 2; background: linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,215,0,0.2));" onclick="selectRouletteBet('even')">
                            偶數
                        </div>
                        <div class="bet-cell" style="grid-column: span 2; background: linear-gradient(135deg, rgba(0,188,212,0.3), rgba(0,188,212,0.2));" onclick="selectRouletteBet('odd')">
                            奇數
                        </div>
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="text-align: center; margin: 30px 0;">
                    <div style="margin-bottom: 20px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">下注金額 (MOP)</div>
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                            <input type="range" min="10" max="1000" value="100" step="10" id="roulette-bet-slider" style="width: 300px;">
                            <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.2rem;">
                                <span id="roulette-bet-amount">100</span> MOP
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">當前投注</div>
                        <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.2rem;" id="current-bet">
                            未選擇
                        </div>
                    </div>
                    
                    <!-- 追號策略設置 -->
                    <div style="margin-bottom: 30px; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto;">
                        <h4 style="color: var(--accent-gold); margin-bottom: 15px;"><i class="fas fa-chess-board"></i> 追號策略設置</h4>
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                            <div>
                                <input type="checkbox" id="chase-strategy" onchange="toggleChaseStrategy()">
                                <label for="chase-strategy" style="color: rgba(255,255,255,0.8); margin-left: 8px;">啟用追號策略</label>
                            </div>
                            <div id="chase-settings" style="display: none; flex-grow: 1;">
                                <div style="color: rgba(255,255,255,0.8); margin-bottom: 5px;">輸局後下注倍數</div>
                                <input type="range" min="1" max="5" value="2" step="0.5" id="chase-multiplier" style="width: 200px;">
                                <span style="color: var(--accent-gold); margin-left: 10px;" id="chase-multiplier-value">2x</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-gold" onclick="spinRoulette()" id="spin-button">
                        <i class="fas fa-play"></i> 旋轉輪盤
                    </button>
                    
                    <!-- 走勢圖按鈕 -->
                    <button class="btn btn-blue" onclick="showRouletteTrendChart()" style="margin-left: 15px;">
                        <i class="fas fa-chart-line"></i> 走勢圖
                    </button>
                </div>
                
                <!-- 最近結果 -->
                <div style="text-align: center;">
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">最近結果</div>
                    <div id="recent-results" style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                        <!-- 最近結果會在這裡動態顯示 -->
                    </div>
                </div>
                
                <!-- 走勢圖容器 -->
                <div id="trend-chart-container" style="display: none; margin-top: 30px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 15px; text-align: center;"><i class="fas fa-chart-line"></i> 輪盤走勢圖</h4>
                    <div id="trend-chart" class="chart-container">
                        <!-- 走勢圖會在這裡動態生成 -->
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn" onclick="hideTrendChart()">關閉走勢圖</button>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('mahjong-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('slot-page')">
                    下一頁：老虎機 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 老虎機頁 -->
        <div id="slot-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('roulette-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-sliders-h"></i> 老虎機模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">經典老虎機遊戲，多種主題和累積獎金</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="slot-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>選擇下注金額和支付線數量，點擊「旋轉」按鈕開始遊戲。匹配相同符號可以贏得獎金，三個7為最高獎金。</p>
            </div>
            
            <!-- 老虎機遊戲區域 -->
            <div class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    豪華老虎機
                </h3>
                
                <!-- 老虎機 -->
                <div style="background: linear-gradient(135deg, #800000, #a52a2a); border-radius: var(--border-radius-lg); padding: 30px; border: 10px solid #8b4513; margin-bottom: 40px;">
                    <!-- 累積獎金 -->
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 5px;">累積獎金</div>
                        <div style="font-size: 2.5rem; font-weight: 900; color: var(--accent-gold);" id="jackpot">1,248,750</div>
                    </div>
                    
                    <!-- 滾輪 -->
                    <div class="slot-machine">
                        <div class="slot-reel" id="slot-reel1">🍒</div>
                        <div class="slot-reel" id="slot-reel2">7️⃣</div>
                        <div class="slot-reel" id="slot-reel3">🔔</div>
                        <div class="slot-reel" id="slot-reel4">⭐</div>
                        <div class="slot-reel" id="slot-reel5">🍋</div>
                    </div>
                    
                    <!-- 支付線 -->
                    <div style="display: flex; justify-content: center; margin-top: 30px;">
                        <div style="width: 100%; height: 3px; background: var(--accent-gold); position: relative;">
                            <div style="position: absolute; top: -8px; left: 20%; width: 20px; height: 20px; background: var(--accent-gold); border-radius: 50%;"></div>
                            <div style="position: absolute; top: -8px; left: 40%; width: 20px; height: 20px; background: var(--accent-gold); border-radius: 50%;"></div>
                            <div style="position: absolute; top: -8px; left: 60%; width: 20px; height: 20px; background: var(--accent-gold); border-radius: 50%;"></div>
                            <div style="position: absolute; top: -8px; left: 80%; width: 20px; height: 20px; background: var(--accent-gold); border-radius: 50%;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="text-align: center; margin: 30px 0;">
                    <div style="display: flex; justify-content: center; gap: 40px; margin-bottom: 30px; flex-wrap: wrap;">
                        <div>
                            <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">下注金額 (MOP)</div>
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <button class="btn" style="padding: 10px 15px;" onclick="changeSlotBet(-10)">-10</button>
                                <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.5rem; min-width: 80px;" id="slot-bet-amount">50</div>
                                <button class="btn" style="padding: 10px 15px;" onclick="changeSlotBet(10)">+10</button>
                            </div>
                        </div>
                        
                        <div>
                            <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">支付線</div>
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <button class="btn" style="padding: 10px 15px;" onclick="changeSlotLines(-1)">-1</button>
                                <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.5rem; min-width: 80px;" id="slot-lines">3</div>
                                <button class="btn" style="padding: 10px 15px;" onclick="changeSlotLines(1)">+1</button>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">總下注金額</div>
                        <div style="font-weight: 700; color: var(--accent-gold); font-size: 2rem;" id="slot-total-bet">
                            150 MOP
                        </div>
                    </div>
                    
                    <!-- 自動旋轉設置 -->
                    <div style="margin-bottom: 30px; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto;">
                        <h4 style="color: var(--accent-gold); margin-bottom: 15px;"><i class="fas fa-cog"></i> 自動旋轉設置</h4>
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                            <div>
                                <input type="checkbox" id="auto-spin" onchange="toggleAutoSpin()">
                                <label for="auto-spin" style="color: rgba(255,255,255,0.8); margin-left: 8px;">啟用自動旋轉</label>
                            </div>
                            <div id="auto-spin-settings" style="display: none; flex-grow: 1;">
                                <div style="color: rgba(255,255,255,0.8); margin-bottom: 5px;">旋轉次數</div>
                                <input type="range" min="5" max="100" value="20" step="5" id="auto-spin-count" style="width: 200px;">
                                <span style="color: var(--accent-gold); margin-left: 10px;" id="auto-spin-count-value">20次</span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-gold" onclick="spinSlots()" id="slot-spin-button" style="padding: 25px 50px; font-size: 1.5rem;">
                        <i class="fas fa-play"></i> 旋轉
                    </button>
                    
                    <!-- 錄影分享按鈕 -->
                    <button class="btn share-button" onclick="recordSlotWin()" style="margin-left: 15px;">
                        <i class="fas fa-video"></i> 錄影分享
                    </button>
                </div>
                
                <!-- 賠率表 -->
                <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                    <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">賠率表</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: var(--border-radius);">
                            <span>🍒🍒🍒</span>
                            <span style="color: var(--accent-gold); font-weight: 700;">10x</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: var(--border-radius);">
                            <span>7️⃣7️⃣7️⃣</span>
                            <span style="color: var(--accent-gold); font-weight: 700;">20x</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: var(--border-radius);">
                            <span>🔔🔔🔔</span>
                            <span style="color: var(--accent-gold); font-weight: 700;">15x</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: var(--border-radius);">
                            <span>⭐⭐⭐</span>
                            <span style="color: var(--accent-gold); font-weight: 700;">8x</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: var(--border-radius);">
                            <span>🍋🍋🍋</span>
                            <span style="color: var(--accent-gold); font-weight: 700;">5x</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('roulette-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('tools-page')">
                    下一頁：專業工具 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 專業工具頁 -->
        <div id="tools-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('slot-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--diamond-blue), #80deea); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-tools"></i> 專業工具系統
                </h2>
                <p style="color: rgba(255,255,255,0.8);">使用專業工具輔助遊戲決策，提高勝率和資金管理能力</p>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-calculator"></i> 工具使用提示
                </div>
                <p>專業工具可以幫助您計算賠率、管理資金、分析勝率和制定遊戲策略，提高遊戲表現。</p>
            </div>
            
            <!-- 工具選擇 -->
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px; margin: 40px 0;">
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('odds')">
                    <div style="font-size: 3rem; color: var(--diamond-blue); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--diamond-blue);">
                        賠率計算器
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        計算各種投注組合的潛在回報、概率和期望值，支援自定義賠率和下注金額。
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('bankroll')">
                    <div style="font-size: 3rem; color: var(--success-color); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--success-color);">
                        資金管理
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        設定下注限制、止損止盈點，管理遊戲資金，提供資金分配建議和風險控制。
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('analysis')">
                    <div style="font-size: 3rem; color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--accent-gold);">
                        勝率分析
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        分析您的遊戲歷史數據，提供勝率統計、熱門遊戲和時段分析，幫助制定策略。
                    </div>
                </div>
                
                <!-- 新增工具 -->
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('report')">
                    <div style="font-size: 3rem; color: var(--warning-color); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--warning-color);">
                        消費報表
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        按日/月生成遊戲消費報表，統計各遊戲投入金額、盈利比例，掌握資金流向。
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('trend')">
                    <div style="font-size: 3rem; color: var(--primary-color); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--primary-color);">
                        走勢圖生成器
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        針對輪盤、老虎機等遊戲，生成歷史開獎數據走勢圖，輔助判斷投注方向。
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border-radius: var(--border-radius-xl); padding: 30px; border: 2px solid rgba(255,215,0,0.2); cursor: pointer;" onclick="selectTool('plan')">
                    <div style="font-size: 3rem; color: var(--vip-purple); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <div style="font-size: 1.8rem; font-weight: 800; margin-bottom: 15px; text-align: center; color: var(--vip-purple);">
                        投注計劃
                    </div>
                    <div style="color: rgba(255,255,255,0.7); text-align: center; line-height: 1.6;">
                        設定追號策略、盈利止盈點，自定義投注計劃，降低操作負擔，提高盈利機會。
                    </div>
                </div>
            </div>
            
            <!-- 工具詳細區域 -->
            <div id="tool-detail" style="margin-top: 40px;">
                <!-- 由JavaScript動態生成 -->
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('slot-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('vip-page')">
                    下一頁：VIP專區 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- VIP專區頁 -->
        <div id="vip-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('tools-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--vip-purple), #ba68c8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-crown"></i> VIP專屬特權
                </h2>
                <p style="color: rgba(255,255,255,0.8);">尊享VIP專屬功能、更高獎金和獨家遊戲體驗</p>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-crown"></i> VIP升級提示
                </div>
                <p>提升遊戲等級、增加遊戲時間和盈利金額可以提升VIP等級，解鎖更多專屬功能。</p>
            </div>
            
            <!-- VIP等級系統 -->
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; margin: 40px 0;">
                <div style="background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.1)); border-radius: var(--border-radius-xl); padding: 25px; text-align: center; border: 2px solid var(--accent-bronze);">
                    <div style="font-size: 3rem; color: var(--accent-bronze); margin-bottom: 15px;">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3 style="color: var(--accent-bronze); margin-bottom: 10px;">青銅會員</h3>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        <div>• 基礎遊戲功能</div>
                        <div>• 基礎AI對手</div>
                        <div>• 每日登入獎勵</div>
                    </div>
                    <div style="color: var(--accent-bronze); font-weight: 700;">等級要求: 1-3</div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.1)); border-radius: var(--border-radius-xl); padding: 25px; text-align: center; border: 2px solid var(--accent-silver);">
                    <div style="font-size: 3rem; color: var(--accent-silver); margin-bottom: 15px;">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3 style="color: var(--accent-silver); margin-bottom: 10px;">白銀會員</h3>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        <div>• 進階遊戲功能</div>
                        <div>• 中級AI對手</div>
                        <div>• 更高獎金池</div>
                        <div>• 專屬客服</div>
                    </div>
                    <div style="color: var(--accent-silver); font-weight: 700;">等級要求: 4-6</div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1)); border-radius: var(--border-radius-xl); padding: 25px; text-align: center; border: 2px solid var(--accent-gold);">
                    <div style="font-size: 3rem; color: var(--accent-gold); margin-bottom: 15px;">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3 style="color: var(--accent-gold); margin-bottom: 10px;">黃金會員</h3>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        <div>• 高級遊戲功能</div>
                        <div>• 高級AI對手</div>
                        <div>• 專屬遊戲房間</div>
                        <div>• 個人數據分析</div>
                        <div>• 生日特別獎勵</div>
                    </div>
                    <div style="color: var(--accent-gold); font-weight: 700;">等級要求: 7-9</div>
                </div>
                
                <div style="background: linear-gradient(135deg, rgba(0, 188, 212, 0.2), rgba(0, 188, 212, 0.1)); border-radius: var(--border-radius-xl); padding: 25px; text-align: center; border: 2px solid var(--diamond-blue);">
                    <div style="font-size: 3rem; color: var(--diamond-blue); margin-bottom: 15px;">
                        <i class="fas fa-gem"></i>
                    </div>
                    <h3 style="color: var(--diamond-blue); margin-bottom: 10px;">鑽石會員</h3>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        <div>• 全部遊戲功能</div>
                        <div>• 專家級AI對手</div>
                        <div>• 私人遊戲房間</div>
                        <div>• 專屬VIP經理</div>
                        <div>• 豪華禮品兌換</div>
                        <div>• 邀請專屬活動</div>
                    </div>
                    <div style="color: var(--diamond-blue); font-weight: 700;">等級要求: 10-12</div>
                </div>
            </div>
            
            <!-- 當前VIP狀態 -->
            <div style="background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05)); border-radius: var(--border-radius-xl); padding: 30px; margin-top: 40px; text-align: center; border: 2px solid rgba(255,215,0,0.3);">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px;">您的VIP狀態</h3>
                <div style="display: flex; justify-content: center; align-items: center; gap: 30px; flex-wrap: wrap;">
                    <div>
                        <div style="font-size: 4rem; color: var(--accent-gold);">
                            <i class="fas fa-gem" id="vip-icon"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold); margin-top: 10px;" id="vip-level-name">鑽石會員</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 2.5rem; color: var(--accent-gold);" id="vip-level">等級 5</div>
                        <div style="color: rgba(255,255,255,0.7); margin-top: 5px;">VIP等級</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 2.5rem; color: var(--accent-gold);" id="vip-exp">850/1000</div>
                        <div style="color: rgba(255,255,255,0.7); margin-top: 5px;">經驗值</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 2.5rem; color: var(--accent-gold);" id="win-rate-bonus">+85%</div>
                        <div style="color: rgba(255,255,255,0.7); margin-top: 5px;">勝率加成</div>
                    </div>
                </div>
                
                <!-- 升級進度條 -->
                <div style="margin-top: 30px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: rgba(255,255,255,0.8);">
                        <span id="next-level-text">升級到等級 6</span>
                        <span id="exp-percentage">85%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="exp-progress" style="width: 85%;"></div>
                    </div>
                </div>
            </div>
            
            <!-- AI私人教練 -->
            <div id="ai-coach-section" class="ai-coach-container">
                <h3 style="color: var(--vip-purple); margin-bottom: 20px;">
                    <i class="fas fa-robot"></i> 私人AI教練 (鑽石會員專屬)
                </h3>
                
                <div class="coach-message" id="coach-message">
                    歡迎，VIP玩家！我是您的私人AI教練。我可以幫助您提升遊戲技巧，分析您的遊戲策略，並提供個性化的建議。
                </div>
                
                <div style="margin-top: 20px;">
                    <h4 style="color: var(--vip-purple); margin-bottom: 15px;">選擇指導項目</h4>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn" onclick="askCoach('texas')">
                            <i class="fas fa-club"></i> 德州撲克指導
                        </button>
                        <button class="btn" onclick="askCoach('mahjong')">
                            <i class="fas fa-chess-board"></i> 麻將技巧
                        </button>
                        <button class="btn" onclick="askCoach('roulette')">
                            <i class="fas fa-circle-notch"></i> 輪盤策略
                        </button>
                        <button class="btn" onclick="askCoach('bankroll')">
                            <i class="fas fa-wallet"></i> 資金管理
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 積分兌換市場 -->
            <div style="margin-top: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-gift"></i> VIP積分兌換市場
                </h3>
                
                <div class="exchange-market">
                    <div class="exchange-item">
                        <div style="font-size: 3rem; color: var(--accent-gold); margin-bottom: 15px;">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px;">免費旋轉次數</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">10次老虎機免費旋轉</div>
                        <div style="color: var(--accent-gold); font-weight: 700; margin-bottom: 15px;">兌換價格: 500 VIP積分</div>
                        <button class="btn" style="padding: 10px 20px;">立即兌換</button>
                    </div>
                    
                    <div class="exchange-item">
                        <div style="font-size: 3rem; color: var(--success-color); margin-bottom: 15px;">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--success-color); margin-bottom: 10px;">手牌提示次數</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">5次撲克/麻將手牌分析</div>
                        <div style="color: var(--success-color); font-weight: 700; margin-bottom: 15px;">兌換價格: 300 VIP積分</div>
                        <button class="btn" style="padding: 10px 20px;">立即兌換</button>
                    </div>
                    
                    <div class="exchange-item">
                        <div style="font-size: 3rem; color: var(--diamond-blue); margin-bottom: 15px;">
                            <i class="fas fa-hotel"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--diamond-blue); margin-bottom: 10px;">模擬酒店住宿券</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">澳門豪華酒店模擬體驗</div>
                        <div style="color: var(--diamond-blue); font-weight: 700; margin-bottom: 15px;">兌換價格: 5000 VIP積分</div>
                        <button class="btn" style="padding: 10px 20px;">立即兌換</button>
                    </div>
                    
                    <div class="exchange-item">
                        <div style="font-size: 3rem; color: var(--vip-purple); margin-bottom: 15px;">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--vip-purple); margin-bottom: 10px;">模擬餐飲券</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">高級餐廳模擬用餐體驗</div>
                        <div style="color: var(--vip-purple); font-weight: 700; margin-bottom: 15px;">兌換價格: 3000 VIP積分</div>
                        <button class="btn" style="padding: 10px 20px;">立即兌換</button>
                    </div>
                </div>
            </div>
            
            <!-- 自定義遊戲房間 -->
            <div class="room-container" style="margin-top: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-door-open"></i> 自定義遊戲房間 (黃金以上會員專屬)
                </h3>
                
                <div style="text-align: center; margin-bottom: 30px;">
                    <button class="btn btn-gold" onclick="createPrivateRoom()">
                        <i class="fas fa-plus-circle"></i> 創建私人房間
                    </button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: var(--border-radius);">
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px;">房間設定</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
                            <div>• 自定義底注: 100-5000 MOP</div>
                            <div>• 自定義賠率: 可調整範圍</div>
                            <div>• 遊戲時長: 30-180分鐘</div>
                            <div>• 參與人數: 2-6人</div>
                        </div>
                        <div style="text-align: center;">
                            <button class="btn" style="padding: 10px 20px;">設定規則</button>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: var(--border-radius);">
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px;">邀請玩家</div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
                            <div>• 生成邀請連結</div>
                            <div>• 設置房間密碼</div>
                            <div>• 邀請好友列表</div>
                            <div>• 設定准入等級</div>
                        </div>
                        <div style="text-align: center;">
                            <button class="btn" style="padding: 10px 20px;">邀請玩家</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('tools-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('main-page')">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 免責聲明 -->
            <div class="disclaimer" style="margin-top: 60px;">
                <h4 style="color: var(--warning-color); margin-bottom: 15px;">
                    <i class="fas fa-exclamation-triangle"></i> 重要聲明
                </h4>
                <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                    本系統為純粹的博彩娛樂模擬體驗平台，僅供娛樂和教育目的。所有遊戲使用虛擬貨幣，不涉及真實金錢交易。本系統不鼓勵真實賭博行為，實際賭博可能導致嚴重的財務損失和心理問題。請理性遊戲，適度娛樂。
                </p>
            </div>
        </div>
        
        <!-- 賽馬/賽狗頁 -->
        <div id="racing-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-horse"></i> 賽馬/賽狗模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">還原澳門賽事場景，虛擬投注、賽事數據分析</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="racing-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>選擇您要投注的賽事類型，查看參賽者歷史戰績和賠率浮動，下注後觀看即時賽事動畫與解說。</p>
            </div>
            
            <!-- 賽馬/賽狗遊戲區域 -->
            <div class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    澳門賽馬模擬
                </h3>
                
                <!-- 賽馬場地 -->
                <div class="race-track" id="race-track">
                    <!-- 賽道線 -->
                    <div class="race-lane" style="top: 40px;">
                        <div class="race-horse" id="horse1" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path d=\"M30,50 Q50,30 70,50\" fill=\"%23ff5252\"/><circle cx=\"50\" cy=\"30\" r=\"10\" fill=\"%23ff5252\"/></svg>');"></div>
                    </div>
                    <div class="race-lane" style="top: 100px;">
                        <div class="race-horse" id="horse2" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path d=\"M30,50 Q50,30 70,50\" fill=\"%234caf50\"/><circle cx=\"50\" cy=\"30\" r=\"10\" fill=\"%234caf50\"/></svg>');"></div>
                    </div>
                    <div class="race-lane" style="top: 160px;">
                        <div class="race-horse" id="horse3" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path d=\"M30,50 Q50,30 70,50\" fill=\"%232196f3\"/><circle cx=\"50\" cy=\"30\" r=\"10\" fill=\"%232196f3\"/></svg>');"></div>
                    </div>
                    <div class="race-lane" style="top: 220px;">
                        <div class="race-horse" id="horse4" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path d=\"M30,50 Q50,30 70,50\" fill=\"%23ff9800\"/><circle cx=\"50\" cy=\"30\" r=\"10\" fill=\"%23ff9800\"/></svg>');"></div>
                    </div>
                    
                    <!-- 終點線 -->
                    <div style="position: absolute; top: 0; right: 50px; width: 5px; height: 100%; background: var(--accent-gold);"></div>
                </div>
                
                <!-- 參賽者信息 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
                    <div style="background: rgba(255,82,82,0.1); padding: 20px; border-radius: var(--border-radius); border-left: 4px solid #ff5252;">
                        <div style="font-weight: 700; color: #ff5252; margin-bottom: 10px;">1號馬: 閃電飛駒</div>
                        <div style="color: rgba(255,255,255,0.7);">
                            <div>勝率: 65%</div>
                            <div>最近5場: 4勝1負</div>
                            <div>賠率: 2.5</div>
                        </div>
                        <button class="btn" style="margin-top: 15px; padding: 8px 15px; width: 100%;" onclick="selectRacingBet(1)">投注此馬</button>
                    </div>
                    
                    <div style="background: rgba(76,175,80,0.1); padding: 20px; border-radius: var(--border-radius); border-left: 4px solid #4caf50;">
                        <div style="font-weight: 700; color: #4caf50; margin-bottom: 10px;">2號馬: 綠色旋風</div>
                        <div style="color: rgba(255,255,255,0.7);">
                            <div>勝率: 45%</div>
                            <div>最近5場: 2勝3負</div>
                            <div>賠率: 3.8</div>
                        </div>
                        <button class="btn" style="margin-top: 15px; padding: 8px 15px; width: 100%;" onclick="selectRacingBet(2)">投注此馬</button>
                    </div>
                    
                    <div style="background: rgba(33,150,243,0.1); padding: 20px; border-radius: var(--border-radius); border-left: 4px solid #2196f3;">
                        <div style="font-weight: 700; color: #2196f3; margin-bottom: 10px;">3號馬: 藍色雷霆</div>
                        <div style="color: rgba(255,255,255,0.7);">
                            <div>勝率: 55%</div>
                            <div>最近5場: 3勝2負</div>
                            <div>賠率: 3.2</div>
                        </div>
                        <button class="btn" style="margin-top: 15px; padding: 8px 15px; width: 100%;" onclick="selectRacingBet(3)">投注此馬</button>
                    </div>
                    
                    <div style="background: rgba(255,152,0,0.1); padding: 20px; border-radius: var(--border-radius); border-left: 4px solid #ff9800;">
                        <div style="font-weight: 700; color: #ff9800; margin-bottom: 10px;">4號馬: 金色閃電</div>
                        <div style="color: rgba(255,255,255,0.7);">
                            <div>勝率: 35%</div>
                            <div>最近5場: 1勝4負</div>
                            <div>賠率: 5.5</div>
                        </div>
                        <button class="btn" style="margin-top: 15px; padding: 8px 15px; width: 100%;" onclick="selectRacingBet(4)">投注此馬</button>
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="text-align: center; margin: 30px 0;">
                    <div style="margin-bottom: 20px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">下注金額 (MOP)</div>
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                            <input type="range" min="100" max="5000" value="500" step="100" id="racing-bet-slider" style="width: 300px;">
                            <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.2rem;">
                                <span id="racing-bet-amount">500</span> MOP
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">當前投注</div>
                        <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.2rem;" id="racing-current-bet">
                            未選擇
                        </div>
                    </div>
                    
                    <button class="btn btn-gold" onclick="startRace()" id="race-button">
                        <i class="fas fa-play"></i> 開始賽事
                    </button>
                </div>
                
                <!-- 賽事解說 -->
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: var(--border-radius); margin-top: 30px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 15px;"><i class="fas fa-bullhorn"></i> 賽事解說</h4>
                    <div id="race-commentary" style="color: rgba(255,255,255,0.8); min-height: 60px;">
                        等待賽事開始...
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
                <button class="btn btn-gold" onclick="showPage('lottery-page')">
                    下一頁：彩票模擬 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 彩票模擬頁 -->
        <div id="lottery-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('racing-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div class="game-header">
                <div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, var(--accent-gold), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        <i class="fas fa-ticket-alt"></i> 彩票模擬
                    </h2>
                    <p style="color: rgba(255,255,255,0.8);">包含樂透、賓果等玩法，隨機搖號、獎池累積</p>
                </div>
                
                <div class="balance-display">
                    <div>
                        <div style="font-size: 1rem; color: rgba(255, 255, 255, 0.7);">虛擬資金</div>
                        <div><i class="fas fa-coins"></i> <span id="lottery-balance">1,250,000</span> MOP</div>
                    </div>
                </div>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-info-circle"></i> 遊戲提示
                </div>
                <p>選擇彩票類型，選取號碼或使用快速選號，參與獎池累積，查看歷史開獎記錄與中獎統計。</p>
            </div>
            
            <!-- 彩票遊戲區域 -->
            <div class="game-simulation">
                <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                    澳門樂透模擬
                </h3>
                
                <!-- 獎池顯示 -->
                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">累積獎池</div>
                    <div style="font-size: 3rem; font-weight: 900; color: var(--accent-gold);" id="lottery-jackpot">15,780,500</div>
                    <div style="color: rgba(255,255,255,0.7);">MOP</div>
                </div>
                
                <!-- 號碼選擇區域 -->
                <div style="margin-bottom: 40px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">選擇號碼 (1-49，選擇6個)</h4>
                    <div class="lottery-numbers" id="lottery-numbers">
                        <!-- 號碼會在這裡動態生成 -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn" onclick="quickPickNumbers()">
                            <i class="fas fa-random"></i> 快速選號
                        </button>
                        <button class="btn" onclick="clearNumbers()" style="margin-left: 15px;">
                            <i class="fas fa-trash-alt"></i> 清空選擇
                        </button>
                    </div>
                </div>
                
                <!-- 遊戲控制 -->
                <div style="text-align: center; margin: 30px 0;">
                    <div style="margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">投注數量</div>
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
                            <button class="btn" style="padding: 10px 15px;" onclick="changeLotteryTickets(-1)">-1</button>
                            <div style="font-weight: 700; color: var(--accent-gold); font-size: 1.5rem; min-width: 80px;" id="lottery-tickets">1</div>
                            <button class="btn" style="padding: 10px 15px;" onclick="changeLotteryTickets(1)">+1</button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="color: rgba(255,255,255,0.8); margin-bottom: 10px;">總投注金額</div>
                        <div style="font-weight: 700; color: var(--accent-gold); font-size: 2rem;" id="lottery-total-bet">
                            20 MOP
                        </div>
                    </div>
                    
                    <button class="btn btn-gold" onclick="drawLottery()" id="lottery-draw-button">
                        <i class="fas fa-play"></i> 開始搖號
                    </button>
                </div>
                
                <!-- 最近開獎結果 -->
                <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                    <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">最近開獎結果</h4>
                    <div id="recent-draws">
                        <!-- 最近開獎結果會在這裡動態顯示 -->
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('racing-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('social-page')">
                    下一頁：社交互動 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 社交互動頁 -->
        <div id="social-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('lottery-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, #2196f3, #64b5f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-users"></i> 社交互動系統
                </h2>
                <p style="color: rgba(255,255,255,0.8);">排行榜系統、多人聯機模擬、遊戲錄影分享</p>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-share-alt"></i> 社交功能提示
                </div>
                <p>查看排行榜、錄製遊戲精彩瞬間、與好友聯機遊戲，提升遊戲參與感和社交互動體驗。</p>
            </div>
            
            <!-- 排行榜系統 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-trophy"></i> 玩家排行榜
                </h3>
                
                <div style="display: flex; gap: 20px; margin-bottom: 30px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn" onclick="showLeaderboard('profit')" id="profit-leaderboard-btn">
                        總盈利榜
                    </button>
                    <button class="btn" onclick="showLeaderboard('single')" id="single-leaderboard-btn">
                        單局最高獎金榜
                    </button>
                    <button class="btn" onclick="showLeaderboard('winrate')" id="winrate-leaderboard-btn">
                        勝率榜
                    </button>
                </div>
                
                <div class="leaderboard" id="leaderboard-container">
                    <!-- 排行榜內容會在這裡動態顯示 -->
                </div>
            </div>
            
            <!-- 遊戲錄影與分享 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-video"></i> 遊戲錄影與分享
                </h3>
                
                <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
                        <div>
                            <div style="color: rgba(255,255,255,0.8);">錄製遊戲精彩瞬間，生成圖片或短影片分享</div>
                        </div>
                        <div>
                            <button class="btn share-button" onclick="startRecording()">
                                <i class="fas fa-record-vinyl"></i> 開始錄影
                            </button>
                        </div>
                    </div>
                    
                    <div id="recording-status" style="color: rgba(255,255,255,0.7); text-align: center; padding: 20px; background: rgba(0,0,0,0.2); border-radius: var(--border-radius);">
                        點擊「開始錄影」按鈕錄製遊戲過程
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn share-button" style="background: linear-gradient(135deg, #25D366, #128C7E);" onclick="shareToSocial('whatsapp')">
                            <i class="fab fa-whatsapp"></i> 分享到WhatsApp
                        </button>
                        <button class="btn share-button" style="background: linear-gradient(135deg, #1877F2, #0D5FD9); margin-left: 15px;" onclick="shareToSocial('facebook')">
                            <i class="fab fa-facebook"></i> 分享到Facebook
                        </button>
                        <button class="btn share-button" style="background: linear-gradient(135deg, #1DA1F2, #0D8BD9); margin-left: 15px;" onclick="shareToSocial('twitter')">
                            <i class="fab fa-twitter"></i> 分享到Twitter
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 多人聯機模擬 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-gamepad"></i> 多人聯機模擬
                </h3>
                
                <div class="room-container">
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: var(--border-radius);">
                            <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px;">創建好友房間</div>
                            <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
                                <div>• 支援2-4人同步遊戲</div>
                                <div>• 模擬其他玩家AI行為</div>
                                <div>• 自定義遊戲規則與底注</div>
                                <div>• 邀請好友加入</div>
                            </div>
                            <div style="text-align: center;">
                                <button class="btn" style="padding: 10px 20px;" onclick="createFriendRoom()">創建房間</button>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: var(--border-radius);">
                            <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px;">加入現有房間</div>
                            <div style="color: rgba(255,255,255,0.7); margin-bottom: 15px;">
                                <div>• 輸入房間ID加入</div>
                                <div>• 查看公開房間列表</div>
                                <div>• 與其他玩家對戰</div>
                                <div>• 觀看其他玩家遊戲</div>
                            </div>
                            <div style="text-align: center;">
                                <input type="text" class="tool-input" placeholder="輸入房間ID" style="margin-bottom: 15px;">
                                <button class="btn" style="padding: 10px 20px; width: 100%;">加入房間</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 房間玩家列表 -->
                    <div style="margin-top: 30px;">
                        <h4 style="color: var(--accent-gold); margin-bottom: 15px;">房間玩家示例</h4>
                        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                            <div style="text-align: center;">
                                <div class="player-avatar" style="background: linear-gradient(135deg, var(--accent-gold), #ff8c00);">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div style="font-weight: 700; color: var(--accent-gold);">您</div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;">準備中</div>
                            </div>
                            
                            <div style="text-align: center;">
                                <div class="player-avatar" style="background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div style="font-weight: 700; color: var(--primary-color);">玩家A</div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;">已準備</div>
                            </div>
                            
                            <div style="text-align: center;">
                                <div class="player-avatar" style="background: linear-gradient(135deg, var(--vip-purple), #7b1fa2);">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div style="font-weight: 700; color: var(--vip-purple);">玩家B</div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;">已準備</div>
                            </div>
                            
                            <div style="text-align: center;">
                                <div class="player-avatar" style="background: linear-gradient(135deg, var(--diamond-blue), #0097a7);">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div style="font-weight: 700; color: var(--diamond-blue);">玩家C</div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.8rem;">等待中</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('lottery-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('main-page')">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
        </div>
        
        <!-- 任務與成就頁 -->
        <div id="tasks-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, #ff9800, #ffb74d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-tasks"></i> 任務與成就系統
                </h2>
                <p style="color: rgba(255,255,255,0.8);">完成任務獲取獎勵，解鎖成就徽章，提升遊戲體驗</p>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-medal"></i> 任務系統提示
                </div>
                <p>完成日常/週常任務可獲得虛擬積分或VIP經驗值，解鎖成就徽章可展示在個人資料頁。</p>
            </div>
            
            <!-- 任務系統 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px;">
                    <i class="fas fa-clipboard-list"></i> 日常任務
                </h3>
                
                <div id="daily-tasks">
                    <!-- 日常任務會在這裡動態顯示 -->
                </div>
                
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; margin-top: 40px;">
                    <i class="fas fa-calendar-week"></i> 週常任務
                </h3>
                
                <div id="weekly-tasks">
                    <!-- 週常任務會在這裡動態顯示 -->
                </div>
            </div>
            
            <!-- 成就系統 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-trophy"></i> 成就徽章
                </h3>
                
                <div class="badge-container" id="badge-container">
                    <!-- 成就徽章會在這裡動態顯示 -->
                </div>
            </div>
            
            <!-- 任務統計 -->
            <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">任務統計</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                    <div class="stat-card">
                        <div class="stat-value" id="total-tasks">0</div>
                        <div class="stat-label">總完成任務數</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-rewards">0</div>
                        <div class="stat-label">總獲得獎勵 (MOP)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-badges">0</div>
                        <div class="stat-label">獲得徽章數</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="current-streak">0</div>
                        <div class="stat-label">連續登入天數</div>
                    </div>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('main-page')">
                    <i class="fas fa-arrow-left"></i> 返回主頁
                </button>
                <button class="btn btn-gold" onclick="showPage('knowledge-page')">
                    下一頁：博彩知識 <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- 博彩知識頁 -->
        <div id="knowledge-page" class="page">
            <!-- 返回按鈕 -->
            <div style="margin-bottom: 30px;">
                <button class="btn" onclick="showPage('tasks-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn" onclick="showPage('main-page')" style="margin-left: 15px;">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
            
            <!-- 頁面標題 -->
            <div style="text-align: center; margin-bottom: 40px;">
                <h2 style="font-size: 2.5rem; margin-bottom: 10px; background: linear-gradient(90deg, #00bcd4, #80deea); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <i class="fas fa-graduation-cap"></i> 博彩知識科普
                </h2>
                <p style="color: rgba(255,255,255,0.8);">了解遊戲規則，學習理性遊戲，認識真實賭博風險</p>
            </div>
            
            <div class="hint-box">
                <div class="hint-title">
                    <i class="fas fa-book-open"></i> 學習提示
                </div>
                <p>詳細了解各遊戲規則和玩法，學習理性遊戲方法，認識真實賭博的風險和危害。</p>
            </div>
            
            <!-- 規則百科 -->
            <div style="margin-bottom: 40px;">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-book"></i> 規則百科
                </h3>
                
                <div class="knowledge-base">
                    <div class="knowledge-card" onclick="showKnowledgeDetail('poker')">
                        <div style="font-size: 3rem; color: var(--diamond-blue); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-club"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--diamond-blue); margin-bottom: 10px; text-align: center;">德州撲克規則</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            了解德州撲克的基本規則、牌型大小和下注流程。
                        </div>
                    </div>
                    
                    <div class="knowledge-card" onclick="showKnowledgeDetail('mahjong')">
                        <div style="font-size: 3rem; color: var(--success-color); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-chess-board"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--success-color); margin-bottom: 10px; text-align: center;">澳門麻將規則</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            了解澳門麻將的基本規則、番型計算和特殊玩法。
                        </div>
                    </div>
                    
                    <div class="knowledge-card" onclick="showKnowledgeDetail('roulette')">
                        <div style="font-size: 3rem; color: var(--primary-color); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-circle-notch"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--primary-color); margin-bottom: 10px; text-align: center;">輪盤規則</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            了解輪盤的基本規則、投注方式和賠率計算。
                        </div>
                    </div>
                    
                    <div class="knowledge-card" onclick="showKnowledgeDetail('baccarat')">
                        <div style="font-size: 3rem; color: var(--vip-purple); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-gem"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--vip-purple); margin-bottom: 10px; text-align: center;">百家樂規則</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            了解百家樂的基本規則、莊閒和計算和下注策略。
                        </div>
                    </div>
                    
                    <div class="knowledge-card" onclick="showKnowledgeDetail('strategy')">
                        <div style="font-size: 3rem; color: var(--accent-gold); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-chess"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--accent-gold); margin-bottom: 10px; text-align: center;">基本策略</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            學習各遊戲的基本策略和資金管理方法。
                        </div>
                    </div>
                    
                    <div class="knowledge-card" onclick="showKnowledgeDetail('risk')">
                        <div style="font-size: 3rem; color: var(--warning-color); margin-bottom: 15px; text-align: center;">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div style="font-weight: 700; color: var(--warning-color); margin-bottom: 10px; text-align: center;">風險控制</div>
                        <div style="color: rgba(255,255,255,0.7); text-align: center;">
                            了解理性遊戲的重要性，學習風險控制方法。
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 風險評測工具 -->
            <div class="risk-test-container" style="margin-bottom: 40px;">
                <h3 style="color: var(--primary-color); margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-clipboard-check"></i> 理性遊戲風險評測
                </h3>
                
                <div id="risk-test-questions">
                    <!-- 風險評測問題會在這裡動態顯示 -->
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="submitRiskTest()" id="submit-test-btn">
                        <i class="fas fa-paper-plane"></i> 提交評測
                    </button>
                </div>
                
                <div id="risk-test-result" style="display: none; margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: var(--border-radius);">
                    <!-- 評測結果會在這裡動態顯示 -->
                </div>
            </div>
            
            <!-- 真實案例研究 -->
            <div class="case-study">
                <h3 style="color: #607d8b; margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-exclamation-circle"></i> 真實賭博風險案例
                </h3>
                
                <div style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                    <p style="margin-bottom: 15px;">
                        <strong>案例一：</strong> 張先生，35歲，原本有穩定工作和幸福家庭。因接觸真實賭博，最初小贏後開始加大賭注，最終輸掉全部積蓄，欠下巨額債務，導致家庭破裂，失去工作。
                    </p>
                    <p style="margin-bottom: 15px;">
                        <strong>案例二：</strong> 李女士，28歲，因朋友介紹進入賭場，最初只是娛樂，逐漸沉迷其中。兩年內輸掉父母留下的房產，心理健康受到嚴重影響，需要接受心理治療。
                    </p>
                    <p style="margin-bottom: 15px;">
                        <strong>重要提醒：</strong> 真實賭博具有高度成癮性，可能導致嚴重的財務損失、家庭問題和心理疾病。本模擬系統僅供娛樂和教育目的，旨在讓用戶了解遊戲規則和風險，不鼓勵真實賭博行為。
                    </p>
                    <p>
                        <strong>理性遊戲建議：</strong> 設定遊戲時間限制、資金限制；將遊戲視為娛樂而非賺錢手段；如發現自己有沉迷傾向，應立即尋求專業幫助。
                    </p>
                </div>
            </div>
            
            <!-- 導航按鈕 -->
            <div class="nav-buttons">
                <button class="btn" onclick="showPage('tasks-page')">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="btn btn-gold" onclick="showPage('main-page')">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
            </div>
        </div>
        
        <!-- 頁腳 -->
        <footer class="main-footer">
            <div style="margin-bottom: 20px;">
                <div style="font-size: 1.2rem; margin-bottom: 10px; color: var(--accent-gold);">豪華博彩娛樂模擬系統體驗</div>
                <div style="color: rgba(255,255,255,0.6);">澳門至尊VIP娛樂平台 | 獨立頁面系統 | 真實模擬 | 專業工具 | 理性遊戲教育</div>
            </div>
            
            <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 20px; flex-wrap: wrap;">
                <div style="color: rgba(255,255,255,0.6);">
                    <i class="fas fa-shield-alt"></i> 公平遊戲系統
                </div>
                <div style="color: rgba(255,255,255,0.6);">
                    <i class="fas fa-mobile-alt"></i> 全平台支援
                </div>
                <div style="color: rgba(255,255,255,0.6);">
                    <i class="fas fa-user-lock"></i> 隱私保護
                </div>
                <div style="color: rgba(255,255,255,0.6);">
                    <i class="fas fa-headset"></i> 24/7 支援
                </div>
                <div style="color: rgba(255,255,255,0.6);">
                    <i class="fas fa-graduation-cap"></i> 理性遊戲教育
                </div>
            </div>
            
            <div style="color: rgba(255,255,255,0.5); font-size: 0.9rem;">
                © 2023 豪華博彩娛樂模擬系統體驗 | 本系統使用虛擬貨幣，不涉及真實金錢交易 | 僅供娛樂和教育目的 | 真實賭博有害，請理性遊戲
            </div>
        </footer>
    </div>
    
    <script>
        // 全局遊戲狀態管理
        const GameSystem = {
            // 玩家數據
            playerData: {
                balance: 1250000,
                vipLevel: 5,
                vipExp: 850,
                vipExpMax: 1000,
                totalGames: 0,
                totalWins: 0,
                totalLosses: 0,
                gameHistory: [],
                vipPoints: 1500,
                dailyTasksCompleted: 0,
                weeklyTasksCompleted: 0,
                badges: [],
                loginStreak: 5,
                totalTaskRewards: 0,
                theme: 'default',
                playTimeToday: 0, // 分鐘
                riskTestScore: 0,
                lastRiskTestDate: null
            },
            
            // 撲克遊戲狀態
            poker: {
                gameType: 'texas',
                betAmount: 500,
                selectedBet: null,
                isPlaying: false,
                playerChips: 100000,
                ai1Chips: 50000,
                ai2Chips: 75000,
                pot: 0,
                playerCards: [],
                communityCards: [],
                currentTurn: 'player'
            },
            
            // 麻將遊戲狀態
            mahjong: {
                isPlaying: false,
                playerTiles: 13,
                eastTiles: 13,
                southTiles: 13,
                westTiles: 13,
                wallTiles: 72,
                currentWind: '東風圈',
                currentRound: 1,
                baseBet: 100,
                selectedTile: null,
                playerHand: ['一萬', '二萬', '三萬', '東風', '發財', '一筒', '二筒', '三筒', '四筒', '五筒', '六筒', '七筒', '八筒']
            },
            
            // 輪盤遊戲狀態
            roulette: {
                betAmount: 100,
                selectedBet: null,
                recentResults: [17, 5, 32, 21, 0],
                isSpinning: false,
                chaseStrategy: false,
                chaseMultiplier: 2,
                consecutiveLosses: 0
            },
            
            // 老虎機遊戲狀態
            slots: {
                betAmount: 50,
                lines: 3,
                jackpot: 1248750,
                isSpinning: false,
                symbols: ['🍒', '7️⃣', '🔔', '⭐', '🍋'],
                payouts: {
                    '🍒🍒🍒': 10,
                    '7️⃣7️⃣7️⃣': 20,
                    '🔔🔔🔔': 15,
                    '⭐⭐⭐': 8,
                    '🍋🍋🍋': 5
                },
                autoSpin: false,
                autoSpinCount: 20,
                autoSpinRemaining: 0
            },
            
            // 賽馬遊戲狀態
            racing: {
                betAmount: 500,
                selectedHorse: null,
                isRacing: false,
                horses: [
                    { id: 1, name: '閃電飛駒', winRate: 0.65, odds: 2.5, position: 0 },
                    { id: 2, name: '綠色旋風', winRate: 0.45, odds: 3.8, position: 0 },
                    { id: 3, name: '藍色雷霆', winRate: 0.55, odds: 3.2, position: 0 },
                    { id: 4, name: '金色閃電', winRate: 0.35, odds: 5.5, position: 0 }
                ]
            },
            
            // 彩票遊戲狀態
            lottery: {
                selectedNumbers: [],
                tickets: 1,
                ticketPrice: 20,
                jackpot: 15780500,
                recentDraws: [
                    { numbers: [3, 15, 22, 31, 40, 49], date: '2023-11-15' },
                    { numbers: [7, 12, 19, 28, 35, 42], date: '2023-11-12' },
                    { numbers: [2, 10, 18, 27, 33, 46], date: '2023-11-08' },
                    { numbers: [5, 14, 21, 30, 38, 47], date: '2023-11-05' },
                    { numbers: [9, 16, 24, 32, 39, 44], date: '2023-11-01' }
                ]
            },
            
            // 社交數據
            social: {
                leaderboardType: 'profit',
                isRecording: false,
                recordingTime: 0
            },
            
            // 任務與成就數據
            tasks: {
                daily: [
                    { id: 1, name: '完成5局德州撲克', description: '在德州撲克遊戲中完成5局遊戲', reward: 100, completed: false, progress: 0, target: 5 },
                    { id: 2, name: '輪盤連續猜中3次紅色', description: '在輪盤遊戲中連續3次猜中紅色', reward: 150, completed: false, progress: 0, target: 3 },
                    { id: 3, name: '老虎機贏得一次獎金', description: '在老虎機遊戲中贏得任何獎金', reward: 80, completed: false, progress: 0, target: 1 },
                    { id: 4, name: '麻將胡牌一次', description: '在麻將遊戲中成功胡牌一次', reward: 120, completed: false, progress: 0, target: 1 },
                    { id: 5, name: '使用專業工具一次', description: '使用任何專業工具進行計算或分析', reward: 50, completed: false, progress: 0, target: 1 }
                ],
                weekly: [
                    { id: 101, name: '累積贏得50,000 MOP', description: '在所有遊戲中累積贏得50,000 MOP', reward: 500, completed: false, progress: 0, target: 50000 },
                    { id: 102, name: '完成20局遊戲', description: '在所有遊戲中完成20局遊戲', reward: 300, completed: false, progress: 0, target: 20 },
                    { id: 103, name: '連贏5局', description: '在任何遊戲中連續贏得5局', reward: 400, completed: false, progress: 0, target: 5 },
                    { id: 104, name: '解鎖3個成就徽章', description: '解鎖3個不同的成就徽章', reward: 350, completed: false, progress: 0, target: 3 }
                ],
                badges: [
                    { id: 1, name: '百戰百勝', description: '在任何遊戲中連續贏得10局', icon: 'fas fa-trophy', color: '#ffd700', unlocked: false },
                    { id: 2, name: '賭王榮耀', description: '累積贏得1,000,000 MOP', icon: 'fas fa-crown', color: '#9c27b0', unlocked: false },
                    { id: 3, name: '初出茅廬', description: '完成第一局遊戲', icon: 'fas fa-seedling', color: '#4caf50', unlocked: true },
                    { id: 4, name: '工具達人', description: '使用所有專業工具', icon: 'fas fa-tools', color: '#00bcd4', unlocked: false },
                    { id: 5, name: '社交之星', description: '分享遊戲錄影3次', icon: 'fas fa-share-alt', color: '#2196f3', unlocked: false },
                    { id: 6, name: 'VIP貴賓', description: '達到VIP等級5', icon: 'fas fa-gem', color: '#ff9800', unlocked: true },
                    { id: 7, name: '知識達人', description: '完成所有規則學習', icon: 'fas fa-graduation-cap', color: '#607d8b', unlocked: false },
                    { id: 8, name: '理性玩家', description: '完成風險評測並獲得高分', icon: 'fas fa-brain', color: '#795548', unlocked: false }
                ]
            },
            
            // 工具數據
            tools: {
                selectedTool: 'odds'
            },
            
            // 風險評測問題
            riskTest: {
                questions: [
                    {
                        id: 1,
                        text: '您玩遊戲的主要目的是什麼？',
                        options: [
                            { text: '純粹娛樂和放鬆', score: 0 },
                            { text: '贏取虛擬貨幣', score: 2 },
                            { text: '體驗刺激感', score: 3 },
                            { text: '忘記現實壓力', score: 4 }
                        ],
                        selected: null
                    },
                    {
                        id: 2,
                        text: '您通常每次玩遊戲的時間是多久？',
                        options: [
                            { text: '少於30分鐘', score: 0 },
                            { text: '30分鐘到1小時', score: 1 },
                            { text: '1到2小時', score: 2 },
                            { text: '超過2小時', score: 4 }
                        ],
                        selected: null
                    },
                    {
                        id: 3,
                        text: '當您輸掉遊戲時，您通常會怎麼做？',
                        options: [
                            { text: '停止遊戲，改天再玩', score: 0 },
                            { text: '稍微增加下注金額', score: 2 },
                            { text: '顯著增加下注金額以贏回損失', score: 4 },
                            { text: '繼續玩直到贏回損失', score: 5 }
                        ],
                        selected: null
                    },
                    {
                        id: 4,
                        text: '您是否有設定遊戲時間或金額限制？',
                        options: [
                            { text: '是，嚴格遵守', score: 0 },
                            { text: '是，但有時會超過', score: 2 },
                            { text: '沒有設定', score: 4 },
                            { text: '不需要限制', score: 5 }
                        ],
                        selected: null
                    },
                    {
                        id: 5,
                        text: '遊戲是否影響您的日常生活或工作？',
                        options: [
                            { text: '完全沒有影響', score: 0 },
                            { text: '偶爾會想到遊戲', score: 1 },
                            { text: '經常想到遊戲，有時影響專注力', score: 3 },
                            { text: '嚴重影響日常生活', score: 5 }
                        ],
                        selected: null
                    }
                ]
            },
            
            // 知識庫數據
            knowledge: {
                poker: {
                    title: '德州撲克規則',
                    content: '<h4>基本規則</h4><p>德州撲克使用標準52張撲克牌，沒有鬼牌。每個玩家發兩張底牌，然後依次發出五張公共牌。玩家使用自己的兩張底牌和五張公共牌中的任意五張組成最佳牌型。</p><h4>牌型大小</h4><p>從大到小：皇家同花順 > 同花順 > 四條 > 滿堂紅 > 同花 > 順子 > 三條 > 兩對 > 一對 > 高牌</p><h4>下注流程</h4><p>1. 盲注<br>2. 發底牌<br>3. 第一輪下注<br>4. 發翻牌（三張公共牌）<br>5. 第二輪下注<br>6. 發轉牌（第四張公共牌）<br>7. 第三輪下注<br>8. 發河牌（第五張公共牌）<br>9. 最後一輪下注<br>10. 攤牌比大小</p>'
                },
                mahjong: {
                    title: '澳門麻將規則',
                    content: '<h4>基本規則</h4><p>澳門麻將使用144張牌，包含花牌和風牌。四人遊戲，目標是通過吃、碰、槓等方式組成特定的牌型後胡牌。</p><h4>基本牌型</h4><p>• 順子：同花色連續的三張牌<br>• 刻子：相同的三張牌<br>• 槓子：相同的四張牌<br>• 對子：相同的兩張牌（作將）</p><h4>胡牌條件</h4><p>• 基本胡牌：4組順子/刻子 + 1對將<br>• 至少有一番才能胡牌<br>• 可自摸或點炮胡牌</p><h4>常見番型</h4><p>• 平胡（一番）<br>• 碰碰胡（四番）<br>• 清一色（四番）<br>• 混一色（兩番）<br>• 小三元（四番）<br>• 大三元（八番）<br>• 十三幺（十三番）</p>'
                },
                roulette: {
                    title: '輪盤規則',
                    content: '<h4>基本規則</h4><p>輪盤有37個數字（0-36），0為綠色，其餘紅色和黑色交替。玩家可以投注單一數字、數字組合、顏色、奇偶等。</p><h4>投注類型</h4><p>• 直接投注：單一數字，賠率35:1<br>• 分注：兩個相鄰數字，賠率17:1<br>• 街注：一行三個數字，賠率11:1<br>• 角注：四個數字交匯處，賠率8:1<br>• 線注：兩行六個數字，賠率5:1<br>• 列注：一列12個數字，賠率2:1<br>• 打注：1-12、13-24、25-36，賠率2:1<br>• 紅色/黑色：賠率1:1<br>• 奇數/偶數：賠率1:1<br>• 小數/大數（1-18/19-36）：賠率1:1</p><h4>概率計算</h4><p>• 單一數字：1/37 ≈ 2.70%<br>• 紅色/黑色：18/37 ≈ 48.65%<br>• 奇數/偶數：18/37 ≈ 48.65%<br>• 小數/大數：18/37 ≈ 48.65%</p>'
                },
                baccarat: {
                    title: '百家樂規則',
                    content: '<h4>基本規則</h4><p>百家樂使用6-8副撲克牌，玩家可以投注莊家、閒家或和局。目標是預測哪一方（莊家或閒家）的牌面總和最接近9點。</p><h4>點數計算</h4><p>• A = 1點<br>• 2-9 = 面值點數<br>• 10, J, Q, K = 0點<br>• 總和超過9點時，只取個位數（如15點=5點）</p><h4>發牌規則</h4><p>1. 先發兩張牌給閒家，再發兩張牌給莊家<br>2. 根據補牌規則決定是否需要補第三張牌<br>3. 比較雙方點數，點數高者贏</p><h4>補牌規則</h4><p>• 閒家：0-5點補牌，6-7點停牌，8-9點自然贏<br>• 莊家：根據閒家第三張牌和自己的點數決定是否補牌</p><h4>賠率</h4><p>• 莊家贏：1賠0.95（扣除5%佣金）<br>• 閒家贏：1賠1<br>• 和局：1賠8<br>• 莊對/閒對：1賠11</p>'
                },
                strategy: {
                    title: '基本策略',
                    content: '<h4>資金管理</h4><p>1. 設定遊戲預算，絕不超過<br>2. 每次下注不超過總資金的2-5%<br>3. 設定止損點和止盈點<br>4. 記錄遊戲結果，分析表現</p><h4>德州撲克策略</h4><p>• 起手牌選擇：只玩優質起手牌<br>• 位置優勢：後位可以觀察對手行動<br>• 讀牌技巧：觀察對手下注模式<br>• 詐唬策略：適時使用，但不可濫用</p><h4>輪盤策略</h4><p>• 避免單一數字投注（概率低）<br>• 紅色/黑色、奇數/偶數投注風險較低<br>• 不要使用「輸了加倍」策略<br>• 設定每局最高下注金額</p><h4>麻將策略</h4><p>• 優先完成順子<br>• 保留有用的風牌和箭牌<br>• 注意其他玩家打出的牌<br>• 根據手牌決定進攻或防守</p>'
                },
                risk: {
                    title: '風險控制',
                    content: '<h4>理性遊戲原則</h4><p>1. 將遊戲視為娛樂，而非賺錢手段<br>2. 只使用可承受損失的資金<br>3. 設定時間限制，避免長時間遊戲<br>4. 輸錢後不要追趕損失<br>5. 贏錢時知道何時停止</p><h4>成癮跡象</h4><p>• 花費越來越多時間和金錢在遊戲上<br>• 因遊戲影響工作、學習或家庭關係<br>• 試圖追回損失而不斷加大賭注<br>• 對遊戲有強烈的渴望感<br>• 說謊隱瞞遊戲行為</p><h4>預防措施</h4><p>• 設定每日/每週遊戲時間上限<br>• 使用資金管理工具設定下注限制<br>• 定期進行風險評測<br>• 如有需要，尋求專業幫助<br>• 參加其他健康娛樂活動</p><h4>尋求幫助</h4><p>如果您或您認識的人可能對賭博成癮，請聯繫專業機構：<br>• 澳門社會工作局：+853 2822 1133<br>• 香港明愛展晴中心：+852 2827 1000<br>• 台灣衛生福利部：1925（安心專線）</p>'
                }
            },
            
            // 初始化系統
            init() {
                this.loadFromStorage();
                this.setupEventListeners();
                this.updateAllBalances();
                this.updateVIPDisplay();
                this.updateGameHistory();
                this.initLotteryNumbers();
                this.updateTaskDisplay();
                this.updateBadgeDisplay();
                this.updateTheme();
                this.startPlayTimeTracker();
                this.initRiskTest();
            },
            
            // 從本地存儲加載數據
            loadFromStorage() {
                const savedData = localStorage.getItem('casinoSimData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    this.playerData = { ...this.playerData, ...data.playerData };
                    this.playerData.gameHistory = data.playerData.gameHistory || [];
                    this.playerData.badges = data.playerData.badges || [];
                    this.playerData.theme = data.playerData.theme || 'default';
                    this.playerData.playTimeToday = data.playerData.playTimeToday || 0;
                    this.playerData.riskTestScore = data.playerData.riskTestScore || 0;
                    this.playerData.lastRiskTestDate = data.playerData.lastRiskTestDate || null;
                    
                    // 更新任務狀態
                    if (data.tasks) {
                        this.tasks.daily = data.tasks.daily || this.tasks.daily;
                        this.tasks.weekly = data.tasks.weekly || this.tasks.weekly;
                        this.tasks.badges = data.tasks.badges || this.tasks.badges;
                    }
                }
                
                // 檢查是否需要重置日常任務（每天）
                const lastReset = localStorage.getItem('lastTaskReset');
                const today = new Date().toDateString();
                if (lastReset !== today) {
                    this.resetDailyTasks();
                    localStorage.setItem('lastTaskReset', today);
                }
            },
            
            // 保存數據到本地存儲
            saveToStorage() {
                const data = {
                    playerData: this.playerData,
                    tasks: {
                        daily: this.tasks.daily,
                        weekly: this.tasks.weekly,
                        badges: this.tasks.badges
                    }
                };
                localStorage.setItem('casinoSimData', JSON.stringify(data));
            },
            
            // 重置日常任務
            resetDailyTasks() {
                this.tasks.daily.forEach(task => {
                    task.completed = false;
                    task.progress = 0;
                });
                this.updateTaskDisplay();
            },
            
            // 設置事件監聽器
            setupEventListeners() {
                // 撲克下注滑動條
                const pokerSlider = document.getElementById('poker-bet-slider');
                if (pokerSlider) {
                    pokerSlider.addEventListener('input', (e) => {
                        this.poker.betAmount = parseInt(e.target.value);
                        document.getElementById('poker-bet-amount').textContent = this.poker.betAmount;
                    });
                }
                
                // 輪盤下注滑動條
                const rouletteSlider = document.getElementById('roulette-bet-slider');
                if (rouletteSlider) {
                    rouletteSlider.addEventListener('input', (e) => {
                        this.roulette.betAmount = parseInt(e.target.value);
                        document.getElementById('roulette-bet-amount').textContent = this.roulette.betAmount;
                    });
                }
                
                // 賽馬下注滑動條
                const racingSlider = document.getElementById('racing-bet-slider');
                if (racingSlider) {
                    racingSlider.addEventListener('input', (e) => {
                        this.racing.betAmount = parseInt(e.target.value);
                        document.getElementById('racing-bet-amount').textContent = this.racing.betAmount;
                    });
                }
                
                // 追號策略滑動條
                const chaseSlider = document.getElementById('chase-multiplier');
                if (chaseSlider) {
                    chaseSlider.addEventListener('input', (e) => {
                        this.roulette.chaseMultiplier = parseFloat(e.target.value);
                        document.getElementById('chase-multiplier-value').textContent = this.roulette.chaseMultiplier + 'x';
                    });
                }
                
                // 自動旋轉滑動條
                const autoSpinSlider = document.getElementById('auto-spin-count');
                if (autoSpinSlider) {
                    autoSpinSlider.addEventListener('input', (e) => {
                        this.slots.autoSpinCount = parseInt(e.target.value);
                        document.getElementById('auto-spin-count-value').textContent = this.slots.autoSpinCount + '次';
                    });
                }
                
                // 頁面切換時更新數據
                document.addEventListener('DOMContentLoaded', () => {
                    this.updateAllBalances();
                    this.updateVIPDisplay();
                    this.updateGameHistory();
                    this.updateTheme();
                });
                
                // 遊戲時間提醒
                setInterval(() => {
                    this.checkPlayTime();
                }, 60000); // 每分鐘檢查一次
            },
            
            // 開始遊戲時間追蹤
            startPlayTimeTracker() {
                setInterval(() => {
                    if (document.visibilityState === 'visible') {
                        this.playerData.playTimeToday++;
                        this.saveToStorage();
                        
                        // 每30分鐘檢查一次任務
                        if (this.playerData.playTimeToday % 30 === 0) {
                            this.updateTaskProgress('playTime', 30);
                        }
                    }
                }, 60000); // 每分鐘增加1分鐘
            },
            
            // 檢查遊戲時間
            checkPlayTime() {
                // 1小時提醒
                if (this.playerData.playTimeToday === 60) {
                    this.showTimeReminder('您已連續遊戲超過1小時，建議休息一下！');
                }
                
                // 2小時提醒
                if (this.playerData.playTimeToday === 120) {
                    this.showTimeReminder('您已連續遊戲超過2小時，建議停止遊戲休息！');
                }
            },
            
            // 顯示時間提醒
            showTimeReminder(message) {
                const reminder = document.getElementById('time-reminder');
                if (reminder) {
                    reminder.querySelector('i').nextSibling.textContent = ' ' + message;
                    reminder.style.display = 'block';
                }
            },
            
            // 更新所有頁面的餘額顯示
            updateAllBalances() {
                const balance = this.formatCurrency(this.playerData.balance);
                
                // 更新所有頁面的餘額顯示
                const balanceElements = [
                    'main-balance',
                    'poker-balance',
                    'mahjong-balance',
                    'roulette-balance',
                    'slot-balance',
                    'racing-balance',
                    'lottery-balance'
                ];
                
                balanceElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = balance;
                    }
                });
                
                // 更新老虎機累積獎金
                const jackpotElement = document.getElementById('jackpot');
                if (jackpotElement) {
                    jackpotElement.textContent = this.formatCurrency(this.slots.jackpot);
                }
                
                // 更新彩票獎池
                const lotteryJackpotElement = document.getElementById('lottery-jackpot');
                if (lotteryJackpotElement) {
                    lotteryJackpotElement.textContent = this.formatCurrency(this.lottery.jackpot);
                }
            },
            
            // 更新VIP顯示
            updateVIPDisplay() {
                // 計算VIP等級和名稱
                let vipLevel = this.playerData.vipLevel;
                let vipName = '';
                let vipIcon = 'fas fa-gem';
                
                if (vipLevel <= 3) {
                    vipName = '青銅會員';
                    vipIcon = 'fas fa-medal';
                } else if (vipLevel <= 6) {
                    vipName = '白銀會員';
                    vipIcon = 'fas fa-medal';
                } else if (vipLevel <= 9) {
                    vipName = '黃金會員';
                    vipIcon = 'fas fa-medal';
                } else {
                    vipName = '鑽石會員';
                    vipIcon = 'fas fa-gem';
                }
                
                // 更新VIP顯示
                const vipIconElement = document.getElementById('vip-icon');
                const vipNameElement = document.getElementById('vip-level-name');
                const vipLevelElement = document.getElementById('vip-level');
                const vipExpElement = document.getElementById('vip-exp');
                const expProgressElement = document.getElementById('exp-progress');
                const expPercentageElement = document.getElementById('exp-percentage');
                const nextLevelTextElement = document.getElementById('next-level-text');
                
                if (vipIconElement) vipIconElement.className = vipIcon;
                if (vipNameElement) vipNameElement.textContent = vipName;
                if (vipLevelElement) vipLevelElement.textContent = `等級 ${vipLevel}`;
                
                const expPercentage = Math.floor((this.playerData.vipExp / this.playerData.vipExpMax) * 100);
                if (vipExpElement) vipExpElement.textContent = `${this.playerData.vipExp}/${this.playerData.vipExpMax}`;
                if (expProgressElement) expProgressElement.style.width = `${expPercentage}%`;
                if (expPercentageElement) expPercentageElement.textContent = `${expPercentage}%`;
                if (nextLevelTextElement) nextLevelTextElement.textContent = `升級到等級 ${vipLevel + 1}`;
                
                // 計算勝率加成
                const winRate = this.playerData.totalGames > 0 ? 
                    (this.playerData.totalWins / this.playerData.totalGames) * 100 : 0;
                const winRateBonus = Math.floor(winRate * (vipLevel * 0.1));
                const winRateBonusElement = document.getElementById('win-rate-bonus');
                if (winRateBonusElement) winRateBonusElement.textContent = `+${winRateBonus}%`;
            },
            
            // 更新遊戲歷史記錄
            updateGameHistory() {
                const historyContainer = document.getElementById('main-history');
                if (!historyContainer) return;
                
                if (this.playerData.gameHistory.length === 0) {
                    historyContainer.innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.5); padding: 20px;">尚無遊戲記錄</div>';
                    return;
                }
                
                // 只顯示最近的10條記錄
                const recentHistory = this.playerData.gameHistory.slice(-10).reverse();
                
                historyContainer.innerHTML = recentHistory.map(record => `
                    <div class="history-item ${record.win ? 'win' : 'loss'}">
                        <div>${record.game} - ${record.time}</div>
                        <div>${record.win ? '+' : '-'}${this.formatCurrency(record.amount)} MOP</div>
                    </div>
                `).join('');
            },
            
            // 添加遊戲記錄
            addGameRecord(game, win, amount) {
                const now = new Date();
                const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                this.playerData.gameHistory.push({
                    game,
                    win,
                    amount,
                    time: timeStr
                });
                
                // 更新遊戲統計
                this.playerData.totalGames++;
                if (win) {
                    this.playerData.totalWins++;
                    this.updateTaskProgress('win', 1);
                    this.updateTaskProgress('winAmount', amount);
                } else {
                    this.playerData.totalLosses++;
                }
                
                // 更新餘額
                this.playerData.balance += win ? amount : -amount;
                
                // 更新VIP經驗值
                this.playerData.vipExp += Math.abs(Math.floor(amount / 1000));
                if (this.playerData.vipExp >= this.playerData.vipExpMax) {
                    this.playerData.vipLevel++;
                    this.playerData.vipExp = this.playerData.vipExp - this.playerData.vipExpMax;
                    this.playerData.vipExpMax = Math.floor(this.playerData.vipExpMax * 1.5);
                    
                    // 檢查是否解鎖VIP成就
                    if (this.playerData.vipLevel >= 5) {
                        this.unlockBadge(6); // VIP貴賓徽章
                    }
                }
                
                // 檢查連勝任務
                if (win) {
                    this.updateTaskProgress('streak', 1);
                } else {
                    // 重置連勝計數
                    this.updateTaskProgress('streak', 0, true);
                }
                
                // 更新顯示
                this.updateAllBalances();
                this.updateVIPDisplay();
                this.updateGameHistory();
                this.saveToStorage();
            },
            
            // 格式化貨幣顯示
            formatCurrency(amount) {
                return amount.toLocaleString('zh-HK', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                });
            },
            
            // 顯示結果彈窗
            showResultModal(title, message, isWin, amount) {
                const modal = document.createElement('div');
                modal.className = 'result-modal';
                modal.innerHTML = `
                    <div class="result-content">
                        <div style="font-size: 4rem; color: ${isWin ? 'var(--accent-gold)' : 'var(--primary-color)'}; margin-bottom: 20px;">
                            <i class="fas fa-${isWin ? 'trophy' : 'times-circle'}"></i>
                        </div>
                        <div style="font-size: 2rem; color: ${isWin ? 'var(--accent-gold)' : 'var(--primary-color)'}; margin-bottom: 10px;">
                            ${title}
                        </div>
                        <div style="font-size: 1.5rem; color: ${isWin ? 'var(--accent-gold)' : 'var(--primary-color)'}; margin-bottom: 20px;">
                            ${isWin ? '+' : '-'}${this.formatCurrency(amount)} MOP
                        </div>
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 30px;">
                            ${message}
                        </div>
                        <button class="btn ${isWin ? 'btn-gold' : ''}" onclick="this.parentElement.parentElement.remove()">
                            確定
                        </button>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // 點擊背景關閉彈窗
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
            },
            
            // 初始化彩票號碼
            initLotteryNumbers() {
                const container = document.getElementById('lottery-numbers');
                if (!container) return;
                
                container.innerHTML = '';
                for (let i = 1; i <= 49; i++) {
                    const ball = document.createElement('div');
                    ball.className = 'lottery-ball';
                    ball.textContent = i;
                    ball.onclick = () => this.selectLotteryNumber(i);
                    container.appendChild(ball);
                }
                
                this.updateLotteryTotalBet();
            },
            
            // 選擇彩票號碼
            selectLotteryNumber(number) {
                const index = this.lottery.selectedNumbers.indexOf(number);
                if (index === -1) {
                    if (this.lottery.selectedNumbers.length >= 6) {
                        alert('最多只能選擇6個號碼');
                        return;
                    }
                    this.lottery.selectedNumbers.push(number);
                } else {
                    this.lottery.selectedNumbers.splice(index, 1);
                }
                
                this.updateLotterySelection();
            },
            
            // 更新彩票選擇顯示
            updateLotterySelection() {
                const balls = document.querySelectorAll('.lottery-ball');
                balls.forEach(ball => {
                    const number = parseInt(ball.textContent);
                    if (this.lottery.selectedNumbers.includes(number)) {
                        ball.style.background = 'radial-gradient(circle at 30% 30%, #ffffff, var(--accent-gold))';
                    } else {
                        ball.style.background = 'radial-gradient(circle at 30% 30%, #ffffff, #ff5252)';
                    }
                });
                
                document.getElementById('lottery-current-bet').textContent = 
                    this.lottery.selectedNumbers.length > 0 ? 
                    `已選擇: ${this.lottery.selectedNumbers.sort((a,b) => a-b).join(', ')}` : 
                    '未選擇號碼';
                
                this.updateLotteryTotalBet();
            },
            
            // 更新彩票總投注金額
            updateLotteryTotalBet() {
                const totalBet = this.lottery.tickets * this.lottery.ticketPrice;
                document.getElementById('lottery-total-bet').textContent = `${this.formatCurrency(totalBet)} MOP`;
            },
            
            // 快速選號
            quickPickNumbers() {
                this.lottery.selectedNumbers = [];
                while (this.lottery.selectedNumbers.length < 6) {
                    const num = Math.floor(Math.random() * 49) + 1;
                    if (!this.lottery.selectedNumbers.includes(num)) {
                        this.lottery.selectedNumbers.push(num);
                    }
                }
                this.updateLotterySelection();
            },
            
            // 清空彩票號碼
            clearNumbers() {
                this.lottery.selectedNumbers = [];
                this.updateLotterySelection();
            },
            
            // 更改彩票數量
            changeLotteryTickets(change) {
                this.lottery.tickets += change;
                if (this.lottery.tickets < 1) this.lottery.tickets = 1;
                if (this.lottery.tickets > 10) this.lottery.tickets = 10;
                
                document.getElementById('lottery-tickets').textContent = this.lottery.tickets;
                this.updateLotteryTotalBet();
            },
            
            // 更新任務顯示
            updateTaskDisplay() {
                // 更新日常任務
                const dailyContainer = document.getElementById('daily-tasks');
                if (dailyContainer) {
                    dailyContainer.innerHTML = this.tasks.daily.map(task => `
                        <div class="task-item">
                            <div>
                                <div style="font-weight: 700; color: ${task.completed ? 'var(--success-color)' : 'var(--accent-gold)'}; margin-bottom: 5px;">
                                    ${task.name} ${task.completed ? '✓' : ''}
                                </div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-bottom: 10px;">
                                    ${task.description}
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="flex-grow: 1;">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${(task.progress / task.target) * 100}%;"></div>
                                        </div>
                                    </div>
                                    <div style="color: var(--accent-gold); font-weight: 700;">
                                        ${task.progress}/${task.target}
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: var(--accent-gold); font-weight: 700; margin-bottom: 10px;">
                                    ${this.formatCurrency(task.reward)} MOP
                                </div>
                                ${task.completed ? 
                                    '<div style="color: var(--success-color);">已完成</div>' : 
                                    '<button class="btn" style="padding: 8px 15px;" onclick="GameSystem.claimTaskReward(\'daily\', ' + task.id + ')">領取獎勵</button>'}
                            </div>
                        </div>
                    `).join('');
                }
                
                // 更新週常任務
                const weeklyContainer = document.getElementById('weekly-tasks');
                if (weeklyContainer) {
                    weeklyContainer.innerHTML = this.tasks.weekly.map(task => `
                        <div class="task-item">
                            <div>
                                <div style="font-weight: 700; color: ${task.completed ? 'var(--success-color)' : 'var(--accent-gold)'}; margin-bottom: 5px;">
                                    ${task.name} ${task.completed ? '✓' : ''}
                                </div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-bottom: 10px;">
                                    ${task.description}
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="flex-grow: 1;">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${(task.progress / task.target) * 100}%;"></div>
                                        </div>
                                    </div>
                                    <div style="color: var(--accent-gold); font-weight: 700;">
                                        ${task.progress}/${task.target}
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: var(--accent-gold); font-weight: 700; margin-bottom: 10px;">
                                    ${this.formatCurrency(task.reward)} MOP
                                </div>
                                ${task.completed ? 
                                    '<div style="color: var(--success-color);">已完成</div>' : 
                                    '<button class="btn" style="padding: 8px 15px;" onclick="GameSystem.claimTaskReward(\'weekly\', ' + task.id + ')">領取獎勵</button>'}
                            </div>
                        </div>
                    `).join('');
                }
                
                // 更新任務統計
                document.getElementById('total-tasks').textContent = 
                    this.playerData.dailyTasksCompleted + this.playerData.weeklyTasksCompleted;
                document.getElementById('total-rewards').textContent = 
                    this.formatCurrency(this.playerData.totalTaskRewards);
                document.getElementById('total-badges').textContent = 
                    this.tasks.badges.filter(b => b.unlocked).length;
                document.getElementById('current-streak').textContent = 
                    this.playerData.loginStreak;
            },
            
            // 更新任務進度
            updateTaskProgress(type, value, reset = false) {
                let updated = false;
                
                // 處理日常任務
                this.tasks.daily.forEach(task => {
                    if (task.completed) return;
                    
                    let progressChanged = false;
                    
                    switch(type) {
                        case 'texasGames':
                            if (task.name.includes('德州撲克')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'rouletteRed':
                            if (task.name.includes('紅色')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'slotWin':
                            if (task.name.includes('老虎機')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'mahjongWin':
                            if (task.name.includes('麻將')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'toolUse':
                            if (task.name.includes('專業工具')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'playTime':
                            // 遊戲時間任務
                            task.progress = reset ? 0 : task.progress + value;
                            progressChanged = true;
                            break;
                    }
                    
                    if (progressChanged && task.progress >= task.target) {
                        task.completed = true;
                        updated = true;
                    }
                });
                
                // 處理週常任務
                this.tasks.weekly.forEach(task => {
                    if (task.completed) return;
                    
                    let progressChanged = false;
                    
                    switch(type) {
                        case 'winAmount':
                            if (task.name.includes('贏得')) {
                                task.progress = reset ? 0 : task.progress + value;
                                progressChanged = true;
                            }
                            break;
                        case 'gamesPlayed':
                            if (task.name.includes('完成')) {
                                task.progress = reset ? 0 : task.progress + 1;
                                progressChanged = true;
                            }
                            break;
                        case 'streak':
                            if (task.name.includes('連贏')) {
                                task.progress = reset ? 0 : Math.max(task.progress, value);
                                progressChanged = true;
                            }
                            break;
                        case 'badges':
                            if (task.name.includes('徽章')) {
                                task.progress = reset ? 0 : value;
                                progressChanged = true;
                            }
                            break;
                    }
                    
                    if (progressChanged && task.progress >= task.target) {
                        task.completed = true;
                        updated = true;
                    }
                });
                
                if (updated) {
                    this.updateTaskDisplay();
                    this.saveToStorage();
                }
            },
            
            // 領取任務獎勵
            claimTaskReward(taskType, taskId) {
                let taskList, playerDataField;
                
                if (taskType === 'daily') {
                    taskList = this.tasks.daily;
                    playerDataField = 'dailyTasksCompleted';
                } else {
                    taskList = this.tasks.weekly;
                    playerDataField = 'weeklyTasksCompleted';
                }
                
                const task = taskList.find(t => t.id === taskId);
                if (!task || !task.completed || task.rewardClaimed) return;
                
                // 發放獎勵
                this.playerData.balance += task.reward;
                this.playerData[playerDataField]++;
                this.playerData.totalTaskRewards += task.reward;
                task.rewardClaimed = true;
                
                // 更新顯示
                this.updateAllBalances();
                this.updateTaskDisplay();
                this.saveToStorage();
                
                // 顯示獎勵通知
                this.showResultModal('任務完成！', `您已成功完成任務並獲得 ${this.formatCurrency(task.reward)} MOP 獎勵`, true, task.reward);
            },
            
            // 更新成就徽章顯示
            updateBadgeDisplay() {
                const container = document.getElementById('badge-container');
                if (!container) return;
                
                container.innerHTML = this.tasks.badges.map(badge => `
                    <div class="badge-item">
                        <div class="badge-icon ${badge.unlocked ? '' : 'badge-locked'}" style="background: ${badge.unlocked ? badge.color : 'rgba(255,255,255,0.1)'}; color: ${badge.unlocked ? 'white' : 'rgba(255,255,255,0.3)'};">
                            <i class="${badge.icon}"></i>
                        </div>
                        <div style="font-weight: 700; color: ${badge.unlocked ? badge.color : 'rgba(255,255,255,0.5)'}; margin-bottom: 5px;">
                            ${badge.name}
                        </div>
                        <div style="color: ${badge.unlocked ? 'rgba(255,255,255,0.7)' : 'rgba(255,255,255,0.3)'}; font-size: 0.8rem; text-align: center;">
                            ${badge.description}
                        </div>
                    </div>
                `).join('');
            },
            
            // 解鎖成就徽章
            unlockBadge(badgeId) {
                const badge = this.tasks.badges.find(b => b.id === badgeId);
                if (!badge || badge.unlocked) return;
                
                badge.unlocked = true;
                this.updateBadgeDisplay();
                this.saveToStorage();
                
                // 檢查徽章任務進度
                const unlockedCount = this.tasks.badges.filter(b => b.unlocked).length;
                this.updateTaskProgress('badges', unlockedCount);
                
                // 顯示解鎖通知
                this.showResultModal('成就解鎖！', `您已解鎖「${badge.name}」成就徽章`, true, 0);
            },
            
            // 切換主題
            changeTheme(themeName) {
                this.playerData.theme = themeName;
                this.updateTheme();
                this.saveToStorage();
                
                // 更新主題選擇器
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('selected');
                });
                document.querySelector(`.theme-option[onclick*="${themeName}"]`).classList.add('selected');
            },
            
            // 更新主題
            updateTheme() {
                const body = document.body;
                const root = document.documentElement;
                
                // 移除舊主題類
                body.classList.remove('theme-christmas', 'theme-lunar', 'theme-ocean');
                
                // 添加新主題類
                if (this.playerData.theme !== 'default') {
                    body.classList.add(`theme-${this.playerData.theme}`);
                }
                
                // 根據主題更新CSS變量
                switch(this.playerData.theme) {
                    case 'christmas':
                        root.style.setProperty('--primary-color', '#2e7d32'); // 綠色
                        root.style.setProperty('--primary-dark', '#1b5e20');
                        root.style.setProperty('--primary-light', '#4caf50');
                        break;
                    case 'lunar':
                        root.style.setProperty('--primary-color', '#ff9800'); // 橙色
                        root.style.setProperty('--primary-dark', '#f57c00');
                        root.style.setProperty('--primary-light', '#ffb74d');
                        break;
                    case 'ocean':
                        root.style.setProperty('--primary-color', '#1976d2'); // 藍色
                        root.style.setProperty('--primary-dark', '#0d47a1');
                        root.style.setProperty('--primary-light', '#42a5f5');
                        break;
                    default:
                        // 恢復默認值
                        root.style.setProperty('--primary-color', '#c62828');
                        root.style.setProperty('--primary-dark', '#8b0000');
                        root.style.setProperty('--primary-light', '#ff5252');
                        break;
                }
            },
            
            // 初始化風險評測
            initRiskTest() {
                const container = document.getElementById('risk-test-questions');
                if (!container) return;
                
                container.innerHTML = this.riskTest.questions.map((question, index) => `
                    <div class="test-question">
                        <div style="color: rgba(255,255,255,0.9); margin-bottom: 15px;">
                            ${index + 1}. ${question.text}
                        </div>
                        <div>
                            ${question.options.map((option, optIndex) => `
                                <div class="test-option ${question.selected === optIndex ? 'selected' : ''}" 
                                     onclick="GameSystem.selectRiskTestOption(${question.id}, ${optIndex})">
                                    ${option.text}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            },
            
            // 選擇風險評測選項
            selectRiskTestOption(questionId, optionIndex) {
                const question = this.riskTest.questions.find(q => q.id === questionId);
                if (!question) return;
                
                question.selected = optionIndex;
                
                // 更新UI
                const questionElement = document.querySelector(`.test-question:nth-child(${questionId})`);
                if (questionElement) {
                    questionElement.querySelectorAll('.test-option').forEach((opt, idx) => {
                        opt.classList.toggle('selected', idx === optionIndex);
                    });
                }
            },
            
            // 提交風險評測
            submitRiskTest() {
                // 檢查是否所有問題都已回答
                const unanswered = this.riskTest.questions.some(q => q.selected === null);
                if (unanswered) {
                    alert('請回答所有問題後再提交');
                    return;
                }
                
                // 計算總分
                let totalScore = 0;
                this.riskTest.questions.forEach(q => {
                    totalScore += q.options[q.selected].score;
                });
                
                // 保存結果
                this.playerData.riskTestScore = totalScore;
                this.playerData.lastRiskTestDate = new Date().toISOString();
                this.saveToStorage();
                
                // 顯示結果
                this.showRiskTestResult(totalScore);
            },
            
            // 顯示風險評測結果
            showRiskTestResult(score) {
                const resultContainer = document.getElementById('risk-test-result');
                const submitButton = document.getElementById('submit-test-btn');
                
                if (!resultContainer || !submitButton) return;
                
                let riskLevel, advice, color;
                
                if (score <= 5) {
                    riskLevel = '低風險';
                    advice = '您的遊戲習慣非常理性，請繼續保持！';
                    color = 'var(--success-color)';
                } else if (score <= 12) {
                    riskLevel = '中低風險';
                    advice = '您的遊戲習慣基本理性，建議設定一些遊戲限制以保持健康遊戲習慣。';
                    color = 'var(--warning-color)';
                } else if (score <= 18) {
                    riskLevel = '中高風險';
                    advice = '您的遊戲習慣可能存在一些風險，建議設定嚴格的遊戲限制，並考慮減少遊戲時間。';
                    color = 'var(--warning-color)';
                } else {
                    riskLevel = '高風險';
                    advice = '您的遊戲習慣可能存在較高風險，建議立即尋求專業幫助，並考慮暫停遊戲。';
                    color = 'var(--primary-color)';
                }
                
                resultContainer.style.display = 'block';
                resultContainer.innerHTML = `
                    <h4 style="color: ${color}; margin-bottom: 15px;">評測結果: ${riskLevel}</h4>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 15px;">
                        您的得分: ${score}/25
                    </div>
                    <div style="color: rgba(255,255,255,0.8); margin-bottom: 20px;">
                        ${advice}
                    </div>
                    <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">
                        評測時間: ${new Date().toLocaleDateString('zh-TW')}
                    </div>
                `;
                
                submitButton.disabled = true;
                submitButton.innerHTML = '<i class="fas fa-check"></i> 已提交';
                
                // 檢查是否解鎖理性玩家徽章
                if (score <= 5) {
                    this.unlockBadge(8); // 理性玩家徽章
                }
            }
        };
        
        // 頁面系統
        const PageSystem = {
            currentPage: 'main-page',
            previousPage: null,
            
            // 顯示頁面
            show(pageId) {
                // 保存當前頁面為上一頁
                if (this.currentPage !== pageId) {
                    this.previousPage = this.currentPage;
                }
                
                // 隱藏所有頁面
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                // 顯示目標頁面
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.classList.add('active');
                    this.currentPage = pageId;
                    
                    // 滾動到頂部
                    window.scrollTo(0, 0);
                    
                    // 頁面特定初始化
                    switch(pageId) {
                        case 'poker-page':
                            PokerGame.init();
                            break;
                        case 'mahjong-page':
                            MahjongGame.init();
                            break;
                        case 'roulette-page':
                            RouletteGame.init();
                            break;
                        case 'slot-page':
                            SlotGame.init();
                            break;
                        case 'tools-page':
                            ToolsSystem.init();
                            break;
                        case 'vip-page':
                            GameSystem.updateVIPDisplay();
                            break;
                        case 'racing-page':
                            RacingGame.init();
                            break;
                        case 'lottery-page':
                            LotteryGame.init();
                            break;
                        case 'social-page':
                            SocialSystem.init();
                            break;
                        case 'tasks-page':
                            GameSystem.updateTaskDisplay();
                            GameSystem.updateBadgeDisplay();
                            break;
                        case 'knowledge-page':
                            KnowledgeSystem.init();
                            break;
                    }
                }
            },
            
            // 返回上一頁
            goBack() {
                if (this.previousPage) {
                    this.show(this.previousPage);
                } else {
                    this.show('main-page');
                }
            }
        };
        
        // 撲克遊戲系統
        const PokerGame = {
            init() {
                this.resetGame();
                this.updateUI();
            },
            
            resetGame() {
                GameSystem.poker = {
                    gameType: 'texas',
                    betAmount: 500,
                    selectedBet: null,
                    isPlaying: false,
                    playerChips: 100000,
                    ai1Chips: 50000,
                    ai2Chips: 75000,
                    pot: 0,
                    playerCards: [],
                    communityCards: [],
                    currentTurn: 'player'
                };
            },
            
            updateUI() {
                // 更新籌碼顯示
                document.getElementById('player-chips').textContent = GameSystem.formatCurrency(GameSystem.poker.playerChips);
                document.getElementById('ai1-chips').textContent = GameSystem.formatCurrency(GameSystem.poker.ai1Chips);
                document.getElementById('ai2-chips').textContent = GameSystem.formatCurrency(GameSystem.poker.ai2Chips);
                document.getElementById('pot-amount').textContent = `底池: ${GameSystem.formatCurrency(GameSystem.poker.pot)} MOP`;
                
                // 更新遊戲狀態
                const statusElement = document.getElementById('poker-status');
                if (statusElement) {
                    statusElement.textContent = GameSystem.poker.isPlaying ? '遊戲進行中...' : '等待遊戲開始...';
                }
                
                // 更新按鈕狀態
                const actionButtons = ['fold-btn', 'call-btn', 'raise-btn'];
                actionButtons.forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn) {
                        btn.disabled = !GameSystem.poker.isPlaying;
                    }
                });
                
                const startBtn = document.getElementById('start-poker-btn');
                if (startBtn) {
                    startBtn.disabled = GameSystem.poker.isPlaying;
                }
            },
            
            selectGame(gameType) {
                GameSystem.poker.gameType = gameType;
                
                // 更新UI按鈕狀態
                const buttons = ['texas-btn', 'blackjack-btn', 'baccarat-btn', 'dragon-btn', 'three-btn'];
                buttons.forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn) {
                        btn.classList.remove('btn-gold');
                    }
                });
                
                const selectedBtn = document.getElementById(`${gameType}-btn`);
                if (selectedBtn) {
                    selectedBtn.classList.add('btn-gold');
                }
                
                // 更新標題
                const gameTitle = document.querySelector('#poker-page .game-header h2');
                if (gameTitle) {
                    switch(gameType) {
                        case 'texas':
                            gameTitle.innerHTML = '<i class="fas fa-club"></i> 德州撲克模擬';
                            break;
                        case 'blackjack':
                            gameTitle.innerHTML = '<i class="fas fa-spade"></i> 二十一點模擬';
                            break;
                        case 'baccarat':
                            gameTitle.innerHTML = '<i class="fas fa-gem"></i> 百家樂模擬';
                            break;
                        case 'dragon':
                            gameTitle.innerHTML = '<i class="fas fa-dragon"></i> 龍虎鬥模擬';
                            break;
                        case 'three':
                            gameTitle.innerHTML = '<i class="fas fa-crown"></i> 三公模擬';
                            break;
                    }
                }
            },
            
            play() {
                if (GameSystem.poker.isPlaying) return;
                
                GameSystem.poker.isPlaying = true;
                GameSystem.poker.pot = 0;
                
                // 生成玩家手牌
                const cards = ['A♠', 'K♠', 'Q♠', 'J♠', '10♠', '9♠', '8♠', '7♠'];
                GameSystem.poker.playerCards = [
                    cards[Math.floor(Math.random() * cards.length)],
                    cards[Math.floor(Math.random() * cards.length)]
                ];
                
                // 生成公共牌（初始為問號）
                GameSystem.poker.communityCards = ['?', '?', '?', '?', '?'];
                
                // 下注
                const betAmount = GameSystem.poker.betAmount;
                GameSystem.poker.playerChips -= betAmount;
                GameSystem.poker.ai1Chips -= betAmount;
                GameSystem.poker.ai2Chips -= betAmount;
                GameSystem.poker.pot = betAmount * 3;
                
                // 更新任務進度
                GameSystem.updateTaskProgress('texasGames', 1);
                
                // 更新UI
                this.updateCards();
                this.updateUI();
                
                // 顯示遊戲開始消息
                const statusElement = document.getElementById('poker-status');
                if (statusElement) {
                    statusElement.textContent = '遊戲開始！請選擇您的動作';
                }
                
                // 啟用動作按鈕
                const actionButtons = ['fold-btn', 'call-btn', 'raise-btn'];
                actionButtons.forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn) {
                        btn.disabled = false;
                    }
                });
            },
            
            updateCards() {
                // 更新玩家手牌
                document.getElementById('player-card1').textContent = GameSystem.poker.playerCards[0] || '?';
                document.getElementById('player-card2').textContent = GameSystem.poker.playerCards[1] || '?';
                
                // 更新公共牌
                for (let i = 1; i <= 5; i++) {
                    const cardElement = document.getElementById(`community-card${i}`);
                    if (cardElement) {
                        cardElement.textContent = GameSystem.poker.communityCards[i-1] || '?';
                    }
                }
            },
            
            action(action) {
                if (!GameSystem.poker.isPlaying) return;
                
                let result = '';
                let isWin = false;
                let winAmount = 0;
                
                switch(action) {
                    case 'fold':
                        result = '您選擇了棄牌';
                        isWin = false;
                        winAmount = 0;
                        break;
                        
                    case 'call':
                        // 模擬跟注
                        const callAmount = GameSystem.poker.betAmount;
                        GameSystem.poker.playerChips -= callAmount;
                        GameSystem.poker.pot += callAmount;
                        
                        // AI行動
                        this.aiAction();
                        
                        // 決定勝負
                        const playerWins = Math.random() > 0.5;
                        isWin = playerWins;
                        winAmount = playerWins ? GameSystem.poker.pot : 0;
                        
                        result = playerWins ? '恭喜您贏得底池！' : '很遺憾，您輸掉了這局';
                        break;
                        
                    case 'raise':
                        // 模擬加注
                        const raiseAmount = GameSystem.poker.betAmount * 2;
                        GameSystem.poker.playerChips -= raiseAmount;
                        GameSystem.poker.pot += raiseAmount;
                        
                        // AI行動（可能棄牌）
                        const ai1Folds = Math.random() > 0.7;
                        const ai2Folds = Math.random() > 0.7;
                        
                        if (!ai1Folds) {
                            GameSystem.poker.ai1Chips -= raiseAmount;
                            GameSystem.poker.pot += raiseAmount;
                        }
                        
                        if (!ai2Folds) {
                            GameSystem.poker.ai2Chips -= raiseAmount;
                            GameSystem.poker.pot += raiseAmount;
                        }
                        
                        // 決定勝負
                        const playerWinsRaise = Math.random() > 0.3;
                        isWin = playerWinsRaise;
                        winAmount = playerWinsRaise ? GameSystem.poker.pot : 0;
                        
                        result = playerWinsRaise ? '加注成功！您贏得了底池！' : '加注失敗，您輸掉了這局';
                        break;
                }
                
                // 結束遊戲
                GameSystem.poker.isPlaying = false;
                
                // 更新籌碼
                if (isWin) {
                    GameSystem.poker.playerChips += winAmount;
                } else {
                    // 分配底池給AI
                    if (!isWin) {
                        GameSystem.poker.ai1Chips += GameSystem.poker.pot / 2;
                        GameSystem.poker.ai2Chips += GameSystem.poker.pot / 2;
                    }
                }
                
                // 添加遊戲記錄
                GameSystem.addGameRecord(GameSystem.poker.gameType === 'texas' ? '德州撲克' : 
                                       GameSystem.poker.gameType === 'blackjack' ? '二十一點' :
                                       GameSystem.poker.gameType === 'baccarat' ? '百家樂' :
                                       GameSystem.poker.gameType === 'dragon' ? '龍虎鬥' : '三公', 
                                       isWin, winAmount || GameSystem.poker.betAmount);
                
                // 顯示結果
                GameSystem.showResultModal(
                    isWin ? '恭喜獲勝！' : '遊戲結束',
                    result,
                    isWin,
                    winAmount || GameSystem.poker.betAmount
                );
                
                // 更新UI
                this.updateUI();
                
                // 重置公共牌（顯示實際牌面）
                if (isWin) {
                    GameSystem.poker.communityCards = ['A♠', 'K♠', 'Q♠', 'J♠', '10♠'];
                } else {
                    GameSystem.poker.communityCards = ['7♠', '8♠', '9♠', '10♠', 'J♠'];
                }
                this.updateCards();
            },
            
            aiAction() {
                // 簡單的AI邏輯
                const ai1Action = Math.random() > 0.3 ? 'call' : 'fold';
                const ai2Action = Math.random() > 0.4 ? 'call' : 'fold';
                
                if (ai1Action === 'fold') {
                    GameSystem.poker.ai1Chips -= GameSystem.poker.betAmount;
                    GameSystem.poker.pot += GameSystem.poker.betAmount;
                }
                
                if (ai2Action === 'fold') {
                    GameSystem.poker.ai2Chips -= GameSystem.poker.betAmount;
                    GameSystem.poker.pot += GameSystem.poker.betAmount;
                }
            },
            
            // 手牌分析
            analyzeHand() {
                if (GameSystem.poker.playerCards.length < 2) {
                    alert('請先開始遊戲獲得手牌');
                    return;
                }
                
                const analysisContainer = document.getElementById('poker-analysis');
                const analysisContent = document.getElementById('analysis-content');
                
                if (!analysisContainer || !analysisContent) return;
                
                // 簡單的手牌分析邏輯
                const card1 = GameSystem.poker.playerCards[0];
                const card2 = GameSystem.poker.playerCards[1];
                
                let analysis = '';
                let recommendation = '';
                
                // 檢查是否為同花
                const isSuited = card1.includes('♠') && card2.includes('♠') || 
                                card1.includes('♥') && card2.includes('♥') ||
                                card1.includes('♦') && card2.includes('♦') ||
                                card1.includes('♣') && card2.includes('♣');
                
                // 檢查是否為對子
                const card1Value = card1.replace(/[♠♥♦♣]/g, '');
                const card2Value = card2.replace(/[♠♥♦♣]/g, '');
                const isPair = card1Value === card2Value;
                
                // 檢查是否為高牌
                const highCards = ['A', 'K', 'Q', 'J', '10'];
                const isHighCard = highCards.includes(card1Value) && highCards.includes(card2Value);
                
                // 檢查是否為連牌
                const cardValues = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
                const index1 = cardValues.indexOf(card1Value);
                const index2 = cardValues.indexOf(card2Value);
                const isConnector = Math.abs(index1 - index2) <= 2;
                
                analysis = `
                    <div style="margin-bottom: 15px;">
                        <div style="color: var(--diamond-blue); font-weight: 700; margin-bottom: 5px;">手牌分析</div>
                        <div style="color: rgba(255,255,255,0.8);">
                            <div>手牌: ${card1} ${card2}</div>
                            <div>同花: ${isSuited ? '是' : '否'}</div>
                            <div>對子: ${isPair ? '是' : '否'}</div>
                            <div>高牌: ${isHighCard ? '是' : '否'}</div>
                            <div>連牌: ${isConnector ? '是' : '否'}</div>
                        </div>
                    </div>
                `;
                
                // 根據手牌給出建議
                if (isPair && ['A','K','Q','J'].includes(card1Value)) {
                    recommendation = '強力手牌，建議加注或全押';
                } else if (isHighCard && isSuited) {
                    recommendation = '優質手牌，建議加注';
                } else if (isPair) {
                    recommendation = '中等手牌，建議跟注';
                } else if (isHighCard) {
                    recommendation = '可玩手牌，建議跟注或少量加注';
                } else if (isSuited && isConnector) {
                    recommendation = '潛力手牌，建議跟注';
                } else {
                    recommendation = '弱手牌，建議棄牌或謹慎跟注';
                }
                
                analysisContent.innerHTML = analysis + `
                    <div>
                        <div style="color: var(--diamond-blue); font-weight: 700; margin-bottom: 5px;">建議</div>
                        <div style="color: rgba(255,255,255,0.8);">
                            ${recommendation}
                        </div>
                    </div>
                `;
                
                analysisContainer.style.display = 'block';
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            }
        };
        
        // 麻將遊戲系統
        const MahjongGame = {
            init() {
                this.resetGame();
                this.updateUI();
            },
            
            resetGame() {
                GameSystem.mahjong = {
                    isPlaying: false,
                    playerTiles: 13,
                    eastTiles: 13,
                    southTiles: 13,
                    westTiles: 13,
                    wallTiles: 72,
                    currentWind: '東風圈',
                    currentRound: 1,
                    baseBet: 100,
                    selectedTile: null,
                    playerHand: ['一萬', '二萬', '三萬', '東風', '發財', '一筒', '二筒', '三筒', '四筒', '五筒', '六筒', '七筒', '八筒']
                };
                
                this.updatePlayerHand();
            },
            
            updateUI() {
                // 更新牌數顯示
                document.getElementById('player-tiles').textContent = GameSystem.mahjong.playerTiles;
                document.getElementById('east-tiles').textContent = GameSystem.mahjong.eastTiles;
                document.getElementById('south-tiles').textContent = GameSystem.mahjong.southTiles;
                document.getElementById('west-tiles').textContent = GameSystem.mahjong.westTiles;
                document.getElementById('wall-tiles').textContent = GameSystem.mahjong.wallTiles;
                
                // 更新遊戲信息
                document.getElementById('current-wind').textContent = GameSystem.mahjong.currentWind;
                document.getElementById('current-round').textContent = `第${GameSystem.mahjong.currentRound}局`;
                document.getElementById('base-bet').textContent = GameSystem.mahjong.baseBet;
                
                // 更新遊戲狀態
                const statusElement = document.getElementById('mahjong-status');
                if (statusElement) {
                    statusElement.textContent = GameSystem.mahjong.isPlaying ? '遊戲進行中...' : '等待遊戲開始...';
                }
                
                // 更新按鈕狀態
                const actionButtons = ['draw-btn', 'discard-btn', 'pong-btn', 'kong-btn', 'win-btn'];
                actionButtons.forEach(id => {
                    const btn = document.getElementById(id);
                    if (btn) {
                        btn.disabled = !GameSystem.mahjong.isPlaying;
                    }
                });
                
                const startBtn = document.getElementById('start-mahjong-btn');
                if (startBtn) {
                    startBtn.disabled = GameSystem.mahjong.isPlaying;
                }
            },
            
            updatePlayerHand() {
                const handContainer = document.getElementById('player-hand');
                if (!handContainer) return;
                
                handContainer.innerHTML = GameSystem.mahjong.playerHand.map((tile, index) => `
                    <div class="mahjong-tile ${GameSystem.mahjong.selectedTile === index ? 'selected' : ''}" 
                         onclick="MahjongGame.selectTile(${index})">
                        ${tile}
                    </div>
                `).join('');
            },
            
            selectTile(index) {
                if (!GameSystem.mahjong.isPlaying) return;
                
                GameSystem.mahjong.selectedTile = GameSystem.mahjong.selectedTile === index ? null : index;
                this.updatePlayerHand();
            },
            
            play() {
                if (GameSystem.mahjong.isPlaying) return;
                
                GameSystem.mahjong.isPlaying = true;
                GameSystem.mahjong.selectedTile = null;
                
                // 重置牌數
                GameSystem.mahjong.playerTiles = 13;
                GameSystem.mahjong.eastTiles = 13;
                GameSystem.mahjong.southTiles = 13;
                GameSystem.mahjong.westTiles = 13;
                GameSystem.mahjong.wallTiles = 72;
                
                // 更新UI
                this.updateUI();
                
                // 顯示遊戲開始消息
                const statusElement = document.getElementById('mahjong-status');
                if (statusElement) {
                    statusElement.textContent = '遊戲開始！請選擇動作';
                }
            },
            
            action(action) {
                if (!GameSystem.mahjong.isPlaying) return;
                
                let result = '';
                let isWin = false;
                let winAmount = 0;
                
                switch(action) {
                    case 'draw':
                        // 摸牌
                        GameSystem.mahjong.playerTiles++;
                        GameSystem.mahjong.wallTiles--;
                        
                        // 添加新牌到手牌
                        const tiles = ['一萬', '二萬', '三萬', '四萬', '五萬', '六萬', '七萬', '八萬', '九萬',
                                      '一筒', '二筒', '三筒', '四筒', '五筒', '六筒', '七筒', '八筒', '九筒',
                                      '一條', '二條', '三條', '四條', '五條', '六條', '七條', '八條', '九條',
                                      '東風', '南風', '西風', '北風', '紅中', '發財', '白板'];
                        
                        const newTile = tiles[Math.floor(Math.random() * tiles.length)];
                        GameSystem.mahjong.playerHand.push(newTile);
                        
                        result = `您摸到了一張${newTile}`;
                        this.updatePlayerHand();
                        break;
                        
                    case 'discard':
                        // 出牌
                        if (GameSystem.mahjong.selectedTile === null) {
                            alert('請先選擇要出的牌');
                            return;
                        }
                        
                        GameSystem.mahjong.playerTiles--;
                        const discardedTile = GameSystem.mahjong.playerHand[GameSystem.mahjong.selectedTile];
                        GameSystem.mahjong.playerHand.splice(GameSystem.mahjong.selectedTile, 1);
                        GameSystem.mahjong.selectedTile = null;
                        
                        result = `您打出了一張${discardedTile}`;
                        this.updatePlayerHand();
                        
                        // AI行動
                        this.aiAction();
                        break;
                        
                    case 'win':
                        // 胡牌
                        const canWin = Math.random() > 0.7; // 70%機率可以胡牌
                        
                        if (canWin) {
                            isWin = true;
                            winAmount = GameSystem.mahjong.baseBet * 8; // 8倍底注
                            result = '恭喜胡牌！';
                            
                            // 結束遊戲
                            GameSystem.mahjong.isPlaying = false;
                            GameSystem.addGameRecord('澳門麻將', isWin, winAmount);
                            GameSystem.showResultModal('恭喜胡牌！', result, isWin, winAmount);
                            
                            // 更新任務進度
                            GameSystem.updateTaskProgress('mahjongWin', 1);
                        } else {
                            result = '牌型不符合胡牌條件';
                        }
                        break;
                        
                    case 'pong':
                        result = '碰！';
                        break;
                        
                    case 'kong':
                        result = '槓！';
                        break;
                }
                
                // 更新狀態顯示
                const statusElement = document.getElementById('mahjong-status');
                if (statusElement && result) {
                    statusElement.textContent = result;
                }
                
                this.updateUI();
            },
            
            aiAction() {
                // AI隨機行動
                const actions = ['draw', 'discard', 'pong', 'kong'];
                const aiAction = actions[Math.floor(Math.random() * actions.length)];
                
                // 更新AI牌數
                switch(aiAction) {
                    case 'draw':
                        GameSystem.mahjong.eastTiles++;
                        GameSystem.mahjong.wallTiles--;
                        break;
                    case 'discard':
                        GameSystem.mahjong.eastTiles--;
                        break;
                }
                
                this.updateUI();
            },
            
            // 麻將牌型分析
            analyzeHand() {
                if (!GameSystem.mahjong.isPlaying) {
                    alert('請先開始遊戲');
                    return;
                }
                
                const analysisContainer = document.getElementById('mahjong-analysis');
                const analysisContent = document.getElementById('mahjong-analysis-content');
                
                if (!analysisContainer || !analysisContent) return;
                
                // 簡單的麻將分析邏輯
                const hand = GameSystem.mahjong.playerHand;
                
                // 統計牌型
                const suits = {
                    '萬': 0,
                    '筒': 0,
                    '條': 0,
                    '字': 0
                };
                
                hand.forEach(tile => {
                    if (tile.includes('萬')) suits['萬']++;
                    else if (tile.includes('筒')) suits['筒']++;
                    else if (tile.includes('條')) suits['條']++;
                    else suits['字']++;
                });
                
                // 檢查是否清一色
                const isPureSuit = suits['萬'] === hand.length || suits['筒'] === hand.length || suits['條'] === hand.length;
                
                // 檢查是否混一色
                const isMixedSuit = (suits['萬'] > 0 && suits['筒'] === 0 && suits['條'] === 0 && suits['字'] > 0) ||
                                   (suits['筒'] > 0 && suits['萬'] === 0 && suits['條'] === 0 && suits['字'] > 0) ||
                                   (suits['條'] > 0 && suits['萬'] === 0 && suits['筒'] === 0 && suits['字'] > 0);
                
                // 檢查是否有對子
                const tileCounts = {};
                hand.forEach(tile => {
                    tileCounts[tile] = (tileCounts[tile] || 0) + 1;
                });
                
                const pairs = Object.values(tileCounts).filter(count => count >= 2).length;
                const hasPair = pairs > 0;
                
                // 檢查是否有刻子
                const pongs = Object.values(tileCounts).filter(count => count >= 3).length;
                const hasPong = pongs > 0;
                
                let analysis = `
                    <div style="margin-bottom: 15px;">
                        <div style="color: var(--diamond-blue); font-weight: 700; margin-bottom: 5px;">手牌分析</div>
                        <div style="color: rgba(255,255,255,0.8);">
                            <div>手牌數: ${hand.length}張</div>
                            <div>萬子: ${suits['萬']}張</div>
                            <div>筒子: ${suits['筒']}張</div>
                            <div>條子: ${suits['條']}張</div>
                            <div>字牌: ${suits['字']}張</div>
                            <div>清一色: ${isPureSuit ? '是' : '否'}</div>
                            <div>混一色: ${isMixedSuit ? '是' : '否'}</div>
                            <div>對子數: ${pairs}</div>
                            <div>刻子數: ${pongs}</div>
                        </div>
                    </div>
                `;
                
                // 給出建議
                let recommendations = [];
                
                if (isPureSuit) {
                    recommendations.push('清一色牌型，有機會做成大牌');
                } else if (isMixedSuit) {
                    recommendations.push('混一色牌型，有較高番數');
                }
                
                if (hasPong) {
                    recommendations.push('已有刻子，考慮做碰碰胡');
                }
                
                if (hand.length >= 10) {
                    recommendations.push('手牌較多，建議先出無用字牌或孤張');
                }
                
                if (recommendations.length === 0) {
                    recommendations.push('正常牌型，建議先完成順子');
                }
                
                analysisContent.innerHTML = analysis + `
                    <div>
                        <div style="color: var(--diamond-blue); font-weight: 700; margin-bottom: 5px;">建議</div>
                        <div style="color: rgba(255,255,255,0.8);">
                            ${recommendations.map(rec => `<div>• ${rec}</div>`).join('')}
                        </div>
                    </div>
                `;
                
                analysisContainer.style.display = 'block';
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            }
        };
        
        // 輪盤遊戲系統
        const RouletteGame = {
            init() {
                this.resetGame();
                this.updateRecentResults();
            },
            
            resetGame() {
                GameSystem.roulette.selectedBet = null;
                GameSystem.roulette.isSpinning = false;
                
                // 重置輪盤位置
                const wheel = document.getElementById('roulette-wheel');
                if (wheel) {
                    wheel.style.transform = 'rotate(0deg)';
                }
                
                // 清除選中的投注
                document.querySelectorAll('.bet-cell.selected').forEach(cell => {
                    cell.classList.remove('selected');
                });
                
                document.getElementById('current-bet').textContent = '未選擇';
                
                // 更新按鈕狀態
                const spinBtn = document.getElementById('spin-button');
                if (spinBtn) {
                    spinBtn.disabled = false;
                    spinBtn.innerHTML = '<i class="fas fa-play"></i> 旋轉輪盤';
                }
            },
            
            updateRecentResults() {
                const container = document.getElementById('recent-results');
                if (!container) return;
                
                container.innerHTML = GameSystem.roulette.recentResults.map(number => {
                    let color = 'green';
                    if (number !== 0) {
                        const redNumbers = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
                        color = redNumbers.includes(number) ? 'red' : 'black';
                    }
                    
                    return `<div style="width: 40px; height: 40px; background: ${color}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; color: white;">${number}</div>`;
                }).join('');
            },
            
            selectBet(bet) {
                if (GameSystem.roulette.isSpinning) return;
                
                GameSystem.roulette.selectedBet = bet;
                
                // 清除所有選中的投注
                document.querySelectorAll('.bet-cell.selected').forEach(cell => {
                    cell.classList.remove('selected');
                });
                
                // 標記選中的投注
                const betCells = document.querySelectorAll('.bet-cell');
                betCells.forEach(cell => {
                    if (cell.textContent === bet || 
                        (bet === 'red' && cell.textContent === '紅色') ||
                        (bet === 'black' && cell.textContent === '黑色') ||
                        (bet === 'even' && cell.textContent === '偶數') ||
                        (bet === 'odd' && cell.textContent === '奇數')) {
                        cell.classList.add('selected');
                    }
                });
                
                // 更新當前投注顯示
                let betName = '';
                switch(bet) {
                    case '0': betName = '數字 0 (綠色)'; break;
                    case 'red': betName = '紅色 (1:1)'; break;
                    case 'black': betName = '黑色 (1:1)'; break;
                    case 'even': betName = '偶數 (1:1)'; break;
                    case 'odd': betName = '奇數 (1:1)'; break;
                    default: betName = `數字 ${bet} (35:1)`;
                }
                
                document.getElementById('current-bet').textContent = betName;
            },
            
            spin() {
                if (GameSystem.roulette.isSpinning || !GameSystem.roulette.selectedBet) {
                    if (!GameSystem.roulette.selectedBet) {
                        alert('請先選擇投注項目！');
                    }
                    return;
                }
                
                GameSystem.roulette.isSpinning = true;
                
                const wheel = document.getElementById('roulette-wheel');
                const spinBtn = document.getElementById('spin-button');
                
                if (!wheel || !spinBtn) return;
                
                // 禁用按鈕
                spinBtn.disabled = true;
                spinBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 旋轉中...';
                
                // 旋轉動畫
                const spins = 5 + Math.random() * 3; // 5-8圈
                const degrees = 360 * spins + Math.floor(Math.random() * 360);
                
                wheel.style.transform = `rotate(${degrees}deg)`;
                
                // 計算結果
                setTimeout(() => {
                    const normalizedDegrees = degrees % 360;
                    const winningNumber = Math.floor((normalizedDegrees / 360) * 37);
                    
                    // 確定顏色
                    let winningColor = 'green';
                    if (winningNumber !== 0) {
                        const redNumbers = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
                        winningColor = redNumbers.includes(winningNumber) ? 'red' : 'black';
                    }
                    
                    // 確定奇偶
                    const isEven = winningNumber % 2 === 0;
                    
                    // 檢查是否贏得投注
                    let isWin = false;
                    let winMultiplier = 1;
                    
                    if (GameSystem.roulette.selectedBet === '0' && winningNumber === 0) {
                        isWin = true;
                        winMultiplier = 35;
                    } else if (GameSystem.roulette.selectedBet === 'red' && winningColor === 'red') {
                        isWin = true;
                        
                        // 更新輪盤紅色連續猜中任務進度
                        if (GameSystem.roulette.consecutiveLosses === 0) {
                            GameSystem.updateTaskProgress('rouletteRed', 1);
                        } else {
                            // 如果之前有輸局，重置計數
                            GameSystem.updateTaskProgress('rouletteRed', 0, true);
                        }
                        GameSystem.roulette.consecutiveLosses = 0;
                    } else if (GameSystem.roulette.selectedBet === 'black' && winningColor === 'black') {
                        isWin = true;
                        GameSystem.roulette.consecutiveLosses = 0;
                    } else if (GameSystem.roulette.selectedBet === 'even' && isEven && winningNumber !== 0) {
                        isWin = true;
                        GameSystem.roulette.consecutiveLosses = 0;
                    } else if (GameSystem.roulette.selectedBet === 'odd' && !isEven && winningNumber !== 0) {
                        isWin = true;
                        GameSystem.roulette.consecutiveLosses = 0;
                    } else if (parseInt(GameSystem.roulette.selectedBet) === winningNumber) {
                        isWin = true;
                        winMultiplier = 35;
                        GameSystem.roulette.consecutiveLosses = 0;
                    } else {
                        // 輸局
                        isWin = false;
                        GameSystem.roulette.consecutiveLosses++;
                        
                        // 重置輪盤紅色連續猜中任務進度
                        GameSystem.updateTaskProgress('rouletteRed', 0, true);
                    }
                    
                    // 計算贏得金額
                    let betAmount = GameSystem.roulette.betAmount;
                    
                    // 如果啟用追號策略且輸局
                    if (GameSystem.roulette.chaseStrategy && !isWin && GameSystem.roulette.consecutiveLosses > 0) {
                        betAmount = Math.min(betAmount * Math.pow(GameSystem.roulette.chaseMultiplier, GameSystem.roulette.consecutiveLosses), 10000);
                    }
                    
                    const winAmount = isWin ? betAmount * winMultiplier : 0;
                    
                    // 更新最近結果
                    GameSystem.roulette.recentResults.push(winningNumber);
                    if (GameSystem.roulette.recentResults.length > 5) {
                        GameSystem.roulette.recentResults.shift();
                    }
                    this.updateRecentResults();
                    
                    // 添加遊戲記錄
                    GameSystem.addGameRecord('輪盤賭博', isWin, isWin ? winAmount : betAmount);
                    
                    // 顯示結果
                    const resultColor = winningColor === 'green' ? '#00ff00' : winningColor === 'red' ? '#ff5252' : '#000000';
                    const resultText = `結果: ${winningNumber} (${winningColor === 'green' ? '綠色' : winningColor === 'red' ? '紅色' : '黑色'} ${isEven ? '偶數' : '奇數'})`;
                    
                    GameSystem.showResultModal(
                        isWin ? '恭喜贏得投注！' : '投注未中獎',
                        resultText,
                        isWin,
                        isWin ? winAmount : betAmount
                    );
                    
                    // 重置遊戲狀態
                    setTimeout(() => {
                        this.resetGame();
                    }, 3000);
                    
                }, 4000);
            },
            
            // 切換追號策略
            toggleChaseStrategy() {
                const chaseCheckbox = document.getElementById('chase-strategy');
                const chaseSettings = document.getElementById('chase-settings');
                
                if (!chaseCheckbox || !chaseSettings) return;
                
                GameSystem.roulette.chaseStrategy = chaseCheckbox.checked;
                chaseSettings.style.display = chaseCheckbox.checked ? 'block' : 'none';
            },
            
            // 顯示走勢圖
            showTrendChart() {
                const container = document.getElementById('trend-chart-container');
                const chartContainer = document.getElementById('trend-chart');
                
                if (!container || !chartContainer) return;
                
                container.style.display = 'block';
                
                // 生成簡單的走勢圖
                const results = GameSystem.roulette.recentResults;
                const redNumbers = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];
                
                // 統計紅黑分佈
                let redCount = 0;
                let blackCount = 0;
                let greenCount = 0;
                
                results.forEach(num => {
                    if (num === 0) {
                        greenCount++;
                    } else if (redNumbers.includes(num)) {
                        redCount++;
                    } else {
                        blackCount++;
                    }
                });
                
                // 統計奇偶分佈
                let evenCount = 0;
                let oddCount = 0;
                
                results.forEach(num => {
                    if (num !== 0) {
                        if (num % 2 === 0) {
                            evenCount++;
                        } else {
                            oddCount++;
                        }
                    }
                });
                
                chartContainer.innerHTML = `
                    <div style="display: flex; height: 100%; align-items: flex-end; gap: 20px; padding: 20px;">
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="height: ${(redCount / results.length) * 100}%; width: 40px; background: #ff5252; border-radius: 5px;"></div>
                            <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">紅色 ${redCount}</div>
                        </div>
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="height: ${(blackCount / results.length) * 100}%; width: 40px; background: #000; border-radius: 5px;"></div>
                            <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">黑色 ${blackCount}</div>
                        </div>
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="height: ${(greenCount / results.length) * 100}%; width: 40px; background: #00ff00; border-radius: 5px;"></div>
                            <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">綠色 ${greenCount}</div>
                        </div>
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="height: ${(evenCount / (results.length - greenCount)) * 100 || 0}%; width: 40px; background: #2196f3; border-radius: 5px;"></div>
                            <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">偶數 ${evenCount}</div>
                        </div>
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="height: ${(oddCount / (results.length - greenCount)) * 100 || 0}%; width: 40px; background: #ff9800; border-radius: 5px;"></div>
                            <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">奇數 ${oddCount}</div>
                        </div>
                    </div>
                `;
                
                // 滾動到走勢圖
                container.scrollIntoView({ behavior: 'smooth' });
            },
            
            // 隱藏走勢圖
            hideTrendChart() {
                const container = document.getElementById('trend-chart-container');
                if (container) {
                    container.style.display = 'none';
                }
            }
        };
        
        // 老虎機遊戲系統
        const SlotGame = {
            init() {
                this.updateTotalBet();
            },
            
            updateTotalBet() {
                const totalBet = GameSystem.slots.betAmount * GameSystem.slots.lines;
                const totalBetElement = document.getElementById('slot-total-bet');
                if (totalBetElement) {
                    totalBetElement.textContent = `${GameSystem.formatCurrency(totalBet)} MOP`;
                }
            },
            
            changeBet(change) {
                let newBet = GameSystem.slots.betAmount + change;
                if (newBet < 10) newBet = 10;
                if (newBet > 500) newBet = 500;
                
                GameSystem.slots.betAmount = newBet;
                document.getElementById('slot-bet-amount').textContent = newBet;
                this.updateTotalBet();
            },
            
            changeLines(change) {
                let newLines = GameSystem.slots.lines + change;
                if (newLines < 1) newLines = 1;
                if (newLines > 5) newLines = 5;
                
                GameSystem.slots.lines = newLines;
                document.getElementById('slot-lines').textContent = newLines;
                this.updateTotalBet();
            },
            
            spin() {
                if (GameSystem.slots.isSpinning) return;
                
                GameSystem.slots.isSpinning = true;
                
                const spinButton = document.getElementById('slot-spin-button');
                const reels = [
                    document.getElementById('slot-reel1'),
                    document.getElementById('slot-reel2'),
                    document.getElementById('slot-reel3'),
                    document.getElementById('slot-reel4'),
                    document.getElementById('slot-reel5')
                ];
                
                if (!spinButton || reels.some(reel => !reel)) return;
                
                // 禁用按鈕
                spinButton.disabled = true;
                spinButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 旋轉中...';
                
                // 開始旋轉動畫
                reels.forEach(reel => {
                    reel.classList.add('spinning');
                });
                
                // 旋轉動畫
                let spins = 0;
                const spinInterval = setInterval(() => {
                    reels.forEach(reel => {
                        const randomSymbol = GameSystem.slots.symbols[Math.floor(Math.random() * GameSystem.slots.symbols.length)];
                        reel.textContent = randomSymbol;
                    });
                    spins++;
                    
                    if (spins > 30) { // 增加旋轉次數以獲得更好的動畫效果
                        clearInterval(spinInterval);
                        
                        // 停止旋轉動畫
                        reels.forEach(reel => {
                            reel.classList.remove('spinning');
                        });
                        
                        // 生成最終結果
                        const results = [];
                        reels.forEach(reel => {
                            const randomSymbol = GameSystem.slots.symbols[Math.floor(Math.random() * GameSystem.slots.symbols.length)];
                            reel.textContent = randomSymbol;
                            results.push(randomSymbol);
                        });
                        
                        // 檢查贏獎
                        let winMultiplier = 0;
                        let resultText = '';
                        
                        // 檢查中獎線（簡化版本）
                        if (results[0] === results[1] && results[1] === results[2]) {
                            // 三個相同
                            const symbol = results[0];
                            if (GameSystem.slots.payouts[`${symbol}${symbol}${symbol}`]) {
                                winMultiplier = GameSystem.slots.payouts[`${symbol}${symbol}${symbol}`];
                                
                                switch(symbol) {
                                    case '🍒': resultText = '三個櫻桃'; break;
                                    case '7️⃣': resultText = '三個7'; break;
                                    case '🔔': resultText = '三個鈴鐺'; break;
                                    case '⭐': resultText = '三個星星'; break;
                                    case '🍋': resultText = '三個檸檬'; break;
                                }
                            }
                        } else if (results[0] === results[1] || results[1] === results[2] || results[2] === results[3]) {
                            // 兩個相同
                            winMultiplier = 3;
                            resultText = '兩個相同符號';
                        }
                        
                        // 計算獎金
                        const totalBet = GameSystem.slots.betAmount * GameSystem.slots.lines;
                        const winAmount = winMultiplier > 0 ? totalBet * winMultiplier : 0;
                        
                        // 更新累積獎金
                        if (winMultiplier === 20) { // 三個7
                            GameSystem.slots.jackpot = Math.floor(GameSystem.slots.jackpot * 0.9);
                            document.getElementById('jackpot').textContent = GameSystem.formatCurrency(GameSystem.slots.jackpot);
                        }
                        
                        // 添加遊戲記錄
                        GameSystem.addGameRecord('老虎機', winAmount > 0, winAmount > 0 ? winAmount : totalBet);
                        
                        // 更新任務進度
                        if (winAmount > 0) {
                            GameSystem.updateTaskProgress('slotWin', 1);
                        }
                        
                        // 顯示結果
                        setTimeout(() => {
                            GameSystem.showResultModal(
                                winAmount > 0 ? '恭喜中獎！' : '未中獎',
                                resultText || '下次再試試！',
                                winAmount > 0,
                                winAmount > 0 ? winAmount : totalBet
                            );
                            
                            // 重新啟用按鈕
                            spinButton.disabled = false;
                            spinButton.innerHTML = '<i class="fas fa-play"></i> 旋轉';
                            GameSystem.slots.isSpinning = false;
                            
                            // 如果啟用自動旋轉且有剩餘次數
                            if (GameSystem.slots.autoSpin && GameSystem.slots.autoSpinRemaining > 0) {
                                GameSystem.slots.autoSpinRemaining--;
                                if (GameSystem.slots.autoSpinRemaining > 0) {
                                    setTimeout(() => {
                                        this.spin();
                                    }, 1000);
                                }
                            }
                        }, 500);
                    }
                }, 50);
            },
            
            // 切換自動旋轉
            toggleAutoSpin() {
                const autoSpinCheckbox = document.getElementById('auto-spin');
                const autoSpinSettings = document.getElementById('auto-spin-settings');
                
                if (!autoSpinCheckbox || !autoSpinSettings) return;
                
                GameSystem.slots.autoSpin = autoSpinCheckbox.checked;
                autoSpinSettings.style.display = autoSpinCheckbox.checked ? 'block' : 'none';
                
                if (GameSystem.slots.autoSpin) {
                    GameSystem.slots.autoSpinRemaining = GameSystem.slots.autoSpinCount;
                } else {
                    GameSystem.slots.autoSpinRemaining = 0;
                }
            },
            
            // 錄影老虎機贏獎
            recordSlotWin() {
                const reels = [
                    document.getElementById('slot-reel1'),
                    document.getElementById('slot-reel2'),
                    document.getElementById('slot-reel3'),
                    document.getElementById('slot-reel4'),
                    document.getElementById('slot-reel5')
                ];
                
                const symbols = reels.map(reel => reel.textContent).join(' ');
                const result = `老虎機結果: ${symbols}`;
                
                // 顯示錄影成功消息
                alert('遊戲結果已保存，可以分享到社交平台！\n\n' + result);
                
                // 更新任務進度（社交分享）
                GameSystem.updateTaskProgress('socialShare', 1);
            }
        };
        
        // 賽馬遊戲系統
        const RacingGame = {
            init() {
                this.resetRace();
            },
            
            resetRace() {
                GameSystem.racing.selectedHorse = null;
                GameSystem.racing.isRacing = false;
                
                // 重置馬匹位置
                GameSystem.racing.horses.forEach(horse => {
                    horse.position = 0;
                    const horseElement = document.getElementById(`horse${horse.id}`);
                    if (horseElement) {
                        horseElement.style.left = '10px';
                    }
                });
                
                // 更新按鈕狀態
                const raceButton = document.getElementById('race-button');
                if (raceButton) {
                    raceButton.disabled = false;
                    raceButton.innerHTML = '<i class="fas fa-play"></i> 開始賽事';
                }
                
                document.getElementById('race-commentary').textContent = '等待賽事開始...';
            },
            
            selectHorse(horseId) {
                if (GameSystem.racing.isRacing) return;
                
                GameSystem.racing.selectedHorse = horseId;
                
                // 更新顯示
                const horse = GameSystem.racing.horses.find(h => h.id === horseId);
                if (horse) {
                    document.getElementById('racing-current-bet').textContent = 
                        `${horse.name} (賠率: ${horse.odds.toFixed(1)})`;
                }
            },
            
            startRace() {
                if (GameSystem.racing.isRacing || !GameSystem.racing.selectedHorse) {
                    if (!GameSystem.racing.selectedHorse) {
                        alert('請先選擇要投注的馬匹！');
                    }
                    return;
                }
                
                GameSystem.racing.isRacing = true;
                
                const raceButton = document.getElementById('race-button');
                const commentary = document.getElementById('race-commentary');
                
                if (!raceButton || !commentary) return;
                
                // 禁用按鈕
                raceButton.disabled = true;
                raceButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 賽事進行中...';
                
                // 開始賽事解說
                let commentaryText = '比賽開始！閘門打開，所有馬匹同時衝出...';
                commentary.textContent = commentaryText;
                
                // 賽事進程
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 10;
                    
                    // 更新馬匹位置
                    GameSystem.racing.horses.forEach(horse => {
                        // 根據勝率計算速度（加入隨機因素）
                        const speed = horse.winRate * 0.8 + Math.random() * 0.4;
                        horse.position += speed;
                        
                        const horseElement = document.getElementById(`horse${horse.id}`);
                        if (horseElement) {
                            const trackWidth = document.getElementById('race-track').offsetWidth - 60;
                            const leftPosition = Math.min(horse.position / 100 * trackWidth, trackWidth);
                            horseElement.style.left = `${leftPosition}px`;
                        }
                    });
                    
                    // 更新解說
                    if (progress === 30) {
                        commentaryText += '\n\n現在領先的是閃電飛駒，緊隨其後的是藍色雷霆...';
                        commentary.textContent = commentaryText;
                    } else if (progress === 60) {
                        commentaryText += '\n\n比賽進入中段，綠色旋風開始加速...';
                        commentary.textContent = commentaryText;
                    } else if (progress === 80) {
                        commentaryText += '\n\n最後衝刺階段！所有馬匹都在全力加速...';
                        commentary.textContent = commentaryText;
                    }
                    
                    // 檢查是否有馬匹到達終點
                    const finishedHorses = GameSystem.racing.horses.filter(h => h.position >= 100);
                    if (finishedHorses.length > 0 || progress >= 100) {
                        clearInterval(interval);
                        
                        // 確定贏家
                        const winner = GameSystem.racing.horses.reduce((prev, current) => 
                            (prev.position > current.position) ? prev : current);
                        
                        // 檢查是否贏得投注
                        const isWin = winner.id === GameSystem.racing.selectedHorse;
                        const horse = GameSystem.racing.horses.find(h => h.id === GameSystem.racing.selectedHorse);
                        const winAmount = isWin ? GameSystem.racing.betAmount * horse.odds : 0;
                        
                        // 最終解說
                        commentaryText += `\n\n比賽結束！冠軍是：${winner.name}！`;
                        commentary.textContent = commentaryText;
                        
                        // 添加遊戲記錄
                        GameSystem.addGameRecord('賽馬', isWin, isWin ? winAmount : GameSystem.racing.betAmount);
                        
                        // 顯示結果
                        setTimeout(() => {
                            GameSystem.showResultModal(
                                isWin ? '恭喜贏得投注！' : '投注未中獎',
                                `冠軍: ${winner.name}`,
                                isWin,
                                isWin ? winAmount : GameSystem.racing.betAmount
                            );
                            
                            // 重置賽事
                            setTimeout(() => {
                                this.resetRace();
                            }, 3000);
                        }, 2000);
                    }
                }, 200);
            }
        };
        
        // 彩票遊戲系統
        const LotteryGame = {
            init() {
                this.updateRecentDraws();
            },
            
            updateRecentDraws() {
                const container = document.getElementById('recent-draws');
                if (!container) return;
                
                container.innerHTML = GameSystem.lottery.recentDraws.map(draw => `
                    <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="color: rgba(255,255,255,0.7); margin-bottom: 10px;">
                            ${draw.date}
                        </div>
                        <div class="lottery-numbers" style="justify-content: flex-start;">
                            ${draw.numbers.map(num => `
                                <div class="lottery-ball" style="width: 40px; height: 40px; font-size: 1.2rem;">
                                    ${num}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            },
            
            draw() {
                if (GameSystem.lottery.selectedNumbers.length !== 6) {
                    alert('請選擇6個號碼');
                    return;
                }
                
                const drawButton = document.getElementById('lottery-draw-button');
                if (!drawButton) return;
                
                drawButton.disabled = true;
                drawButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 搖號中...';
                
                // 模擬搖號過程
                setTimeout(() => {
                    // 生成中獎號碼
                    const winningNumbers = [];
                    while (winningNumbers.length < 6) {
                        const num = Math.floor(Math.random() * 49) + 1;
                        if (!winningNumbers.includes(num)) {
                            winningNumbers.push(num);
                        }
                    }
                    winningNumbers.sort((a, b) => a - b);
                    
                    // 檢查中獎情況
                    const selectedNumbers = [...GameSystem.lottery.selectedNumbers].sort((a, b) => a - b);
                    const matchedNumbers = selectedNumbers.filter(num => winningNumbers.includes(num));
                    
                    // 計算獎金
                    let winAmount = 0;
                    let resultText = '';
                    
                    switch(matchedNumbers.length) {
                        case 6:
                            winAmount = GameSystem.lottery.jackpot * 0.6; // 頭獎60%
                            resultText = '恭喜中頭獎！';
                            GameSystem.lottery.jackpot = Math.floor(GameSystem.lottery.jackpot * 0.4); // 獎池剩餘40%
                            break;
                        case 5:
                            winAmount = 100000;
                            resultText = '恭喜中二獎！';
                            break;
                        case 4:
                            winAmount = 5000;
                            resultText = '恭喜中三獎！';
                            break;
                        case 3:
                            winAmount = 100;
                            resultText = '恭喜中小獎！';
                            break;
                        default:
                            resultText = '很遺憾，未中獎';
                            break;
                    }
                    
                    // 計算總獎金
                    const totalWinAmount = winAmount * GameSystem.lottery.tickets;
                    const isWin = totalWinAmount > 0;
                    
                    // 添加遊戲記錄
                    GameSystem.addGameRecord('彩票', isWin, isWin ? totalWinAmount : GameSystem.lottery.tickets * GameSystem.lottery.ticketPrice);
                    
                    // 顯示結果
                    GameSystem.showResultModal(
                        isWin ? '恭喜中獎！' : '未中獎',
                        `中獎號碼: ${winningNumbers.join(', ')}<br>您的號碼: ${selectedNumbers.join(', ')}<br>匹配號碼: ${matchedNumbers.length}個`,
                        isWin,
                        isWin ? totalWinAmount : GameSystem.lottery.tickets * GameSystem.lottery.ticketPrice
                    );
                    
                    // 更新最近開獎記錄
                    GameSystem.lottery.recentDraws.unshift({
                        numbers: winningNumbers,
                        date: new Date().toLocaleDateString('zh-TW')
                    });
                    
                    if (GameSystem.lottery.recentDraws.length > 5) {
                        GameSystem.lottery.recentDraws.pop();
                    }
                    
                    this.updateRecentDraws();
                    
                    // 重置按鈕
                    drawButton.disabled = false;
                    drawButton.innerHTML = '<i class="fas fa-play"></i> 開始搖號';
                    
                    // 清空選擇
                    GameSystem.clearNumbers();
                    
                    // 更新獎池顯示
                    document.getElementById('lottery-jackpot').textContent = 
                        GameSystem.formatCurrency(GameSystem.lottery.jackpot);
                        
                }, 3000);
            }
        };
        
        // 社交系統
        const SocialSystem = {
            init() {
                this.showLeaderboard('profit');
            },
            
            showLeaderboard(type) {
                GameSystem.social.leaderboardType = type;
                
                // 更新按鈕狀態
                document.querySelectorAll('#social-page .btn').forEach(btn => {
                    btn.classList.remove('btn-gold');
                });
                
                const selectedBtn = document.getElementById(`${type}-leaderboard-btn`);
                if (selectedBtn) {
                    selectedBtn.classList.add('btn-gold');
                }
                
                // 生成排行榜數據
                let leaderboardData = [];
                let title = '';
                
                switch(type) {
                    case 'profit':
                        title = '總盈利排行榜';
                        leaderboardData = [
                            { name: '賭王之王', value: 3250000, rank: 1 },
                            { name: '幸運之星', value: 2850000, rank: 2 },
                            { name: '澳門之光', value: 2420000, rank: 3 },
                            { name: 'VIP玩家', value: 1250000, rank: 4 },
                            { name: '新手玩家', value: 850000, rank: 5 },
                            { name: '冒險家', value: 620000, rank: 6 },
                            { name: '策略大師', value: 450000, rank: 7 },
                            { name: '娛樂玩家', value: 220000, rank: 8 }
                        ];
                        break;
                    case 'single':
                        title = '單局最高獎金排行榜';
                        leaderboardData = [
                            { name: '賭王之王', value: 1250000, rank: 1 },
                            { name: '幸運之星', value: 980000, rank: 2 },
                            { name: '澳門之光', value: 850000, rank: 3 },
                            { name: '冒險家', value: 620000, rank: 4 },
                            { name: 'VIP玩家', value: 500000, rank: 5 },
                            { name: '策略大師', value: 380000, rank: 6 },
                            { name: '新手玩家', value: 250000, rank: 7 },
                            { name: '娛樂玩家', value: 150000, rank: 8 }
                        ];
                        break;
                    case 'winrate':
                        title = '勝率排行榜';
                        leaderboardData = [
                            { name: '策略大師', value: 78.5, rank: 1 },
                            { name: '賭王之王', value: 72.3, rank: 2 },
                            { name: '澳門之光', value: 68.7, rank: 3 },
                            { name: 'VIP玩家', value: 65.2, rank: 4 },
                            { name: '幸運之星', value: 61.8, rank: 5 },
                            { name: '冒險家', value: 58.4, rank: 6 },
                            { name: '新手玩家', value: 52.1, rank: 7 },
                            { name: '娛樂玩家', value: 48.7, rank: 8 }
                        ];
                        break;
                }
                
                // 更新排行榜顯示
                const container = document.getElementById('leaderboard-container');
                if (!container) return;
                
                container.innerHTML = `
                    <h4 style="color: var(--accent-gold); margin-bottom: 20px; text-align: center;">${title}</h4>
                    ${leaderboardData.map(player => `
                        <div class="leaderboard-item">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="leaderboard-rank">
                                    ${player.rank}
                                </div>
                                <div>
                                    <div style="font-weight: 700; color: ${player.name === 'VIP玩家' ? 'var(--accent-gold)' : 'rgba(255,255,255,0.9)'};">
                                        ${player.name} ${player.name === 'VIP玩家' ? '(您)' : ''}
                                    </div>
                                    <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">
                                        ${type === 'winrate' ? '勝率' : type === 'single' ? '單局最高' : '總盈利'}
                                    </div>
                                </div>
                            </div>
                            <div style="font-weight: 700; color: var(--accent-gold);">
                                ${type === 'winrate' ? player.value.toFixed(1) + '%' : GameSystem.formatCurrency(player.value)} ${type !== 'winrate' ? 'MOP' : ''}
                            </div>
                        </div>
                    `).join('')}
                `;
            },
            
            // 開始錄影
            startRecording() {
                GameSystem.social.isRecording = true;
                GameSystem.social.recordingTime = 0;
                
                const statusElement = document.getElementById('recording-status');
                if (statusElement) {
                    statusElement.innerHTML = '<i class="fas fa-record-vinyl fa-spin"></i> 錄影中... 點擊停止錄影';
                    statusElement.style.color = 'var(--primary-color)';
                    statusElement.style.cursor = 'pointer';
                    statusElement.onclick = () => this.stopRecording();
                }
                
                // 模擬錄影計時
                const timer = setInterval(() => {
                    if (!GameSystem.social.isRecording) {
                        clearInterval(timer);
                        return;
                    }
                    
                    GameSystem.social.recordingTime++;
                    if (statusElement) {
                        statusElement.innerHTML = `<i class="fas fa-record-vinyl fa-spin"></i> 錄影中... ${GameSystem.social.recordingTime}秒 (點擊停止)`;
                    }
                }, 1000);
            },
            
            // 停止錄影
            stopRecording() {
                GameSystem.social.isRecording = false;
                
                const statusElement = document.getElementById('recording-status');
                if (statusElement) {
                    statusElement.innerHTML = `<i class="fas fa-check-circle"></i> 錄影完成！共${GameSystem.social.recordingTime}秒，可以分享到社交平台`;
                    statusElement.style.color = 'var(--success-color)';
                    statusElement.style.cursor = 'default';
                    statusElement.onclick = null;
                }
                
                // 更新任務進度（社交分享）
                GameSystem.updateTaskProgress('socialShare', 1);
            },
            
            // 分享到社交平台
            shareToSocial(platform) {
                let message = '';
                
                switch(platform) {
                    case 'whatsapp':
                        message = '我在澳門豪華博彩模擬平台贏得了大獎！快來試試你的運氣！';
                        break;
                    case 'facebook':
                        message = '剛剛在澳門豪華博彩模擬平台體驗了真實的博彩遊戲，太刺激了！';
                        break;
                    case 'twitter':
                        message = '澳門豪華博彩模擬平台 #博彩模擬 #娛樂遊戲 #澳門';
                        break;
                }
                
                alert(`已準備分享到${platform}：\n\n${message}\n\n(此為模擬功能，實際使用需要連接社交平台API)`);
                
                // 更新任務進度（社交分享）
                GameSystem.updateTaskProgress('socialShare', 1);
                
                // 檢查是否解鎖社交之星徽章
                if (GameSystem.playerData.socialShares >= 3) {
                    GameSystem.unlockBadge(5); // 社交之星徽章
                }
            },
            
            // 創建好友房間
            createFriendRoom() {
                alert('好友房間已創建！\n房間ID: CASINO123\n密碼: 8888\n\n邀請好友加入房間一起遊戲吧！');
            }
        };
        
        // 專業工具系統
        const ToolsSystem = {
            init() {
                this.selectTool('odds');
            },
            
            selectTool(toolId) {
                GameSystem.tools.selectedTool = toolId;
                
                const toolDetail = document.getElementById('tool-detail');
                if (!toolDetail) return;
                
                switch(toolId) {
                    case 'odds':
                        toolDetail.innerHTML = this.getOddsCalculatorHTML();
                        break;
                        
                    case 'bankroll':
                        toolDetail.innerHTML = this.getBankrollManagerHTML();
                        break;
                        
                    case 'analysis':
                        toolDetail.innerHTML = this.getAnalysisToolHTML();
                        break;
                        
                    case 'report':
                        toolDetail.innerHTML = this.getReportToolHTML();
                        break;
                        
                    case 'trend':
                        toolDetail.innerHTML = this.getTrendToolHTML();
                        break;
                        
                    case 'plan':
                        toolDetail.innerHTML = this.getPlanToolHTML();
                        break;
                }
                
                // 滾動到工具詳細區域
                toolDetail.scrollIntoView({ behavior: 'smooth' });
            },
            
            getOddsCalculatorHTML() {
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--diamond-blue);">
                            <i class="fas fa-calculator"></i> 賠率計算器
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">下注金額 (MOP)</div>
                                <input type="number" class="tool-input" value="100" min="1" max="1000000" id="tool-bet-amount">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">賠率</div>
                                <input type="number" class="tool-input" value="2.0" min="1" max="100" step="0.1" id="tool-odds">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">勝率 (%)</div>
                                <input type="number" class="tool-input" value="50" min="1" max="100" id="tool-win-rate">
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <button class="btn btn-blue" onclick="ToolsSystem.calculateOdds()">
                                <i class="fas fa-calculator"></i> 計算
                            </button>
                        </div>
                        
                        <div id="odds-result" style="background: rgba(0,188,212,0.1); padding: 25px; border-radius: var(--border-radius);">
                            <div style="text-align: center; color: rgba(255,255,255,0.7);">
                                輸入參數後點擊「計算」按鈕查看結果
                            </div>
                        </div>
                    </div>
                `;
            },
            
            getBankrollManagerHTML() {
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--success-color);">
                            <i class="fas fa-wallet"></i> 資金管理工具
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">總資金 (MOP)</div>
                                <input type="number" class="tool-input" value="100000" min="1000" max="10000000" id="total-bankroll">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">每局下注比例 (%)</div>
                                <input type="number" class="tool-input" value="2" min="0.1" max="10" step="0.1" id="bet-percentage">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">止損點 (%)</div>
                                <input type="number" class="tool-input" value="20" min="5" max="50" id="stop-loss">
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <button class="btn btn-green" onclick="ToolsSystem.calculateBankroll()">
                                <i class="fas fa-calculator"></i> 計算
                            </button>
                        </div>
                        
                        <div id="bankroll-result" style="background: rgba(76,175,80,0.1); padding: 25px; border-radius: var(--border-radius);">
                            <div style="text-align: center; color: rgba(255,255,255,0.7);">
                                輸入參數後點擊「計算」按鈕查看資金管理建議
                            </div>
                        </div>
                    </div>
                `;
            },
            
            getAnalysisToolHTML() {
                const totalGames = GameSystem.playerData.totalGames;
                const winRate = totalGames > 0 ? 
                    Math.round((GameSystem.playerData.totalWins / totalGames) * 100 * 10) / 10 : 0;
                
                const pokerRate = Math.round((70 + Math.random() * 10) * 10) / 10;
                const mahjongRate = Math.round((60 + Math.random() * 10) * 10) / 10;
                const rouletteRate = Math.round((45 + Math.random() * 10) * 10) / 10;
                
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--accent-gold);">
                            <i class="fas fa-chart-pie"></i> 勝率分析
                        </h3>
                        
                        <div style="text-align: center; margin-bottom: 40px;">
                            <div style="display: inline-block; padding: 30px; background: rgba(0,0,0,0.3); border-radius: var(--border-radius-xl);">
                                <div style="font-size: 4rem; color: var(--accent-gold); margin-bottom: 10px;">${winRate}%</div>
                                <div style="color: rgba(255,255,255,0.8);">總勝率 (${totalGames} 局)</div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                            <h4 style="color: var(--accent-gold); margin-bottom: 20px;">遊戲表現分析</h4>
                            
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">德州撲克</span>
                                    <span style="color: var(--accent-gold); font-weight: 700;">${pokerRate}% 勝率</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${pokerRate}%;"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">澳門麻將</span>
                                    <span style="color: var(--success-color); font-weight: 700;">${mahjongRate}% 勝率</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${mahjongRate}%; background: var(--success-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">輪盤賭</span>
                                    <span style="color: var(--primary-color); font-weight: 700;">${rouletteRate}% 勝率</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${rouletteRate}%; background: var(--primary-color);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; padding: 20px; background: rgba(255,215,0,0.05); border-radius: var(--border-radius); border-left: 4px solid var(--accent-gold);">
                            <h4 style="color: var(--accent-gold); margin-bottom: 15px;">分析建議</h4>
                            <div style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                                1. 您在德州撲克表現優秀，建議增加該遊戲的投入時間<br>
                                2. 輪盤賭勝率偏低，建議減少該遊戲的投注金額<br>
                                3. 資金管理表現良好，請繼續保持當前風險控制水平<br>
                                4. 建議使用賠率計算器輔助下注決策
                            </div>
                        </div>
                    </div>
                `;
            },
            
            getReportToolHTML() {
                // 模擬消費數據
                const pokerSpent = 25000;
                const mahjongSpent = 18000;
                const rouletteSpent = 32000;
                const slotSpent = 15000;
                const racingSpent = 12000;
                const lotterySpent = 8000;
                
                const totalSpent = pokerSpent + mahjongSpent + rouletteSpent + slotSpent + racingSpent + lotterySpent;
                const totalWon = 42000;
                const netProfit = totalWon - totalSpent;
                const profitRate = totalSpent > 0 ? ((netProfit / totalSpent) * 100).toFixed(1) : 0;
                
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--warning-color);">
                            <i class="fas fa-file-invoice-dollar"></i> 消費報表
                        </h3>
                        
                        <div style="text-align: center; margin-bottom: 40px;">
                            <div style="display: inline-block; padding: 30px; background: rgba(0,0,0,0.3); border-radius: var(--border-radius-xl);">
                                <div style="font-size: 4rem; color: ${netProfit >= 0 ? 'var(--accent-gold)' : 'var(--primary-color)'}; margin-bottom: 10px;">
                                    ${netProfit >= 0 ? '+' : ''}${GameSystem.formatCurrency(netProfit)} MOP
                                </div>
                                <div style="color: rgba(255,255,255,0.8);">本月淨盈利 (${profitRate}%)</div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: var(--border-radius);">
                            <h4 style="color: var(--warning-color); margin-bottom: 20px;">各遊戲消費分析</h4>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">德州撲克</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(pokerSpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(pokerSpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">澳門麻將</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(mahjongSpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(mahjongSpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">輪盤賭</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(rouletteSpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(rouletteSpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">老虎機</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(slotSpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(slotSpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">賽馬/賽狗</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(racingSpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(racingSpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: rgba(255,255,255,0.8);">彩票</span>
                                    <span style="color: var(--warning-color); font-weight: 700;">${GameSystem.formatCurrency(lotterySpent)} MOP</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(lotterySpent / totalSpent) * 100}%; background: var(--warning-color);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; padding: 20px; background: rgba(255,152,0,0.05); border-radius: var(--border-radius); border-left: 4px solid var(--warning-color);">
                            <h4 style="color: var(--warning-color); margin-bottom: 15px;">消費建議</h4>
                            <div style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                                1. 輪盤賭消費最高，佔總消費的 ${Math.round((rouletteSpent / totalSpent) * 100)}%，建議適當減少該遊戲投入<br>
                                2. 本月淨盈利${netProfit >= 0 ? '為正' : '為負'}，${netProfit >= 0 ? '表現良好' : '建議調整策略'}<br>
                                3. 老虎機消費相對較低，但潛在回報率有限<br>
                                4. 建議設定每月消費上限，控制在總資金的20%以內
                            </div>
                        </div>
                    </div>
                `;
            },
            
            getTrendToolHTML() {
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--primary-color);">
                            <i class="fas fa-chart-line"></i> 走勢圖生成器
                        </h3>
                        
                        <div style="margin-bottom: 30px;">
                            <div style="color: rgba(255,255,255,0.8); margin-bottom: 15px;">選擇遊戲類型</div>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <button class="btn" onclick="ToolsSystem.generateTrendChart('roulette')">
                                    輪盤走勢圖
                                </button>
                                <button class="btn" onclick="ToolsSystem.generateTrendChart('slots')">
                                    老虎機走勢圖
                                </button>
                                <button class="btn" onclick="ToolsSystem.generateTrendChart('racing')">
                                    賽馬走勢圖
                                </button>
                            </div>
                        </div>
                        
                        <div id="trend-chart-result" style="background: rgba(198,40,40,0.1); padding: 25px; border-radius: var(--border-radius); min-height: 300px; display: flex; align-items: center; justify-content: center;">
                            <div style="text-align: center; color: rgba(255,255,255,0.7);">
                                選擇遊戲類型後點擊按鈕生成走勢圖
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; padding: 20px; background: rgba(198,40,40,0.05); border-radius: var(--border-radius); border-left: 4px solid var(--primary-color);">
                            <h4 style="color: var(--primary-color); margin-bottom: 15px;">使用提示</h4>
                            <div style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                                1. 走勢圖顯示歷史數據的統計分析，可幫助識別模式<br>
                                2. 請注意：歷史數據不代表未來結果<br>
                                3. 走勢圖僅供參考，不應作為唯一決策依據<br>
                                4. 建議結合其他分析工具使用
                            </div>
                        </div>
                    </div>
                `;
            },
            
            getPlanToolHTML() {
                return `
                    <div class="game-simulation">
                        <h3 style="text-align: center; font-size: 2rem; margin-bottom: 30px; color: var(--vip-purple);">
                            <i class="fas fa-clipboard-list"></i> 投注計劃制定
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">起始資金 (MOP)</div>
                                <input type="number" class="tool-input" value="10000" min="1000" max="1000000" id="plan-starting-bankroll">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">每局下注比例 (%)</div>
                                <input type="number" class="tool-input" value="5" min="1" max="20" step="0.5" id="plan-bet-percentage">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">盈利目標 (%)</div>
                                <input type="number" class="tool-input" value="20" min="5" max="100" id="plan-profit-target">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">止損點 (%)</div>
                                <input type="number" class="tool-input" value="30" min="10" max="50" id="plan-stop-loss">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">追號策略倍數</div>
                                <input type="number" class="tool-input" value="2" min="1" max="5" step="0.5" id="plan-chase-multiplier">
                            </div>
                            
                            <div>
                                <div style="margin-bottom: 10px; color: rgba(255,255,255,0.8);">最大追號次數</div>
                                <input type="number" class="tool-input" value="3" min="1" max="10" id="plan-max-chase">
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <button class="btn btn-purple" onclick="ToolsSystem.generateBettingPlan()">
                                <i class="fas fa-calculator"></i> 生成投注計劃
                            </button>
                        </div>
                        
                        <div id="plan-result" style="background: rgba(156,39,176,0.1); padding: 25px; border-radius: var(--border-radius);">
                            <div style="text-align: center; color: rgba(255,255,255,0.7);">
                                輸入參數後點擊「生成投注計劃」按鈕查看詳細計劃
                            </div>
                        </div>
                    </div>
                `;
            },
            
            calculateOdds() {
                const betAmount = parseFloat(document.getElementById('tool-bet-amount').value) || 0;
                const odds = parseFloat(document.getElementById('tool-odds').value) || 0;
                const winRate = parseFloat(document.getElementById('tool-win-rate').value) || 0;
                
                if (betAmount <= 0 || odds <= 0 || winRate <= 0) {
                    return;
                }
                
                const potentialWin = betAmount * odds;
                const expectedValue = (winRate / 100) * (potentialWin - betAmount) - ((100 - winRate) / 100) * betAmount;
                const roi = (expectedValue / betAmount) * 100;
                
                const oddsResult = document.getElementById('odds-result');
                if (!oddsResult) return;
                
                oddsResult.innerHTML = `
                    <h4 style="color: var(--diamond-blue); margin-bottom: 15px;">計算結果</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="stat-card">
                            <div class="stat-value">${GameSystem.formatCurrency(potentialWin)}</div>
                            <div class="stat-label">潛在盈利 (MOP)</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: ${expectedValue >= 0 ? 'var(--success-color)' : 'var(--primary-color)'};">${GameSystem.formatCurrency(expectedValue)}</div>
                            <div class="stat-label">期望值 (MOP)</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: ${roi >= 0 ? 'var(--success-color)' : 'var(--primary-color)'};">${roi.toFixed(2)}%</div>
                            <div class="stat-label">投資回報率</div>
                        </div>
                    </div>
                    
                    <div style="padding: 15px; background: rgba(${expectedValue >= 0 ? '76,175,80' : '198,40,40'},0.1); border-radius: var(--border-radius); border-left: 4px solid ${expectedValue >= 0 ? 'var(--success-color)' : 'var(--primary-color)'};">
                        <div style="color: ${expectedValue >= 0 ? 'var(--success-color)' : 'var(--primary-color)'}; font-weight: 700; margin-bottom: 5px;">
                            ${expectedValue >= 0 ? '建議下注' : '不建議下注'}
                        </div>
                        <div style="color: rgba(255,255,255,0.8); font-size: 0.9rem;">
                            ${expectedValue >= 0 ? 
                              '根據計算結果，此下注具有正期望值，長期來看可能會帶來盈利。' : 
                              '根據計算結果，此下注具有負期望值，長期來看可能會導致虧損。'}
                        </div>
                    </div>
                `;
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            },
            
            calculateBankroll() {
                const totalBankroll = parseFloat(document.getElementById('total-bankroll').value) || 0;
                const betPercentage = parseFloat(document.getElementById('bet-percentage').value) || 0;
                const stopLoss = parseFloat(document.getElementById('stop-loss').value) || 0;
                
                if (totalBankroll <= 0 || betPercentage <= 0 || stopLoss <= 0) {
                    return;
                }
                
                const betPerGame = totalBankroll * (betPercentage / 100);
                const stopLossAmount = totalBankroll * (stopLoss / 100);
                const maxGamesBeforeStopLoss = Math.floor(stopLossAmount / betPerGame);
                
                const bankrollResult = document.getElementById('bankroll-result');
                if (!bankrollResult) return;
                
                bankrollResult.innerHTML = `
                    <h4 style="color: var(--success-color); margin-bottom: 15px;">資金管理建議</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="stat-card">
                            <div class="stat-value">${GameSystem.formatCurrency(betPerGame)}</div>
                            <div class="stat-label">每局下注金額 (MOP)</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--primary-color);">${GameSystem.formatCurrency(stopLossAmount)}</div>
                            <div class="stat-label">止損金額 (MOP)</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--diamond-blue);">${maxGamesBeforeStopLoss}</div>
                            <div class="stat-label">最大連續輸局</div>
                        </div>
                    </div>
                    
                    <div style="padding: 15px; background: rgba(255,152,0,0.1); border-radius: var(--border-radius); border-left: 4px solid var(--warning-color);">
                        <div style="color: var(--warning-color); font-weight: 700; margin-bottom: 5px;">
                            風險控制建議
                        </div>
                        <div style="color: rgba(255,255,255,0.8); font-size: 0.9rem; line-height: 1.5;">
                            1. 每局下注不超過總資金的 ${betPercentage}%<br>
                            2. 當日虧損達到 ${stopLoss}% 時停止遊戲<br>
                            3. 連續輸掉 ${maxGamesBeforeStopLoss} 局後休息<br>
                            4. 根據遊戲表現定期調整下注策略
                        </div>
                    </div>
                `;
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            },
            
            generateTrendChart(gameType) {
                const resultContainer = document.getElementById('trend-chart-result');
                if (!resultContainer) return;
                
                let chartHTML = '';
                let title = '';
                
                switch(gameType) {
                    case 'roulette':
                        title = '輪盤走勢圖';
                        
                        // 模擬輪盤數據
                        const redCount = Math.floor(Math.random() * 10) + 5;
                        const blackCount = Math.floor(Math.random() * 10) + 5;
                        const greenCount = Math.floor(Math.random() * 3) + 1;
                        const evenCount = Math.floor(Math.random() * 8) + 4;
                        const oddCount = Math.floor(Math.random() * 8) + 4;
                        const total = redCount + blackCount + greenCount;
                        
                        chartHTML = `
                            <div style="width: 100%;">
                                <h4 style="color: var(--primary-color); margin-bottom: 20px; text-align: center;">${title} (最近${total}局)</h4>
                                <div style="display: flex; height: 200px; align-items: flex-end; gap: 20px; margin-bottom: 30px;">
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${(redCount / total) * 100}%; width: 60%; background: #ff5252; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">紅色 ${redCount}</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${(blackCount / total) * 100}%; width: 60%; background: #000; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">黑色 ${blackCount}</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${(greenCount / total) * 100}%; width: 60%; background: #00ff00; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">綠色 ${greenCount}</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${(evenCount / (total - greenCount)) * 100}%; width: 60%; background: #2196f3; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">偶數 ${evenCount}</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${(oddCount / (total - greenCount)) * 100}%; width: 60%; background: #ff9800; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">奇數 ${oddCount}</div>
                                    </div>
                                </div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; text-align: center;">
                                    數據分析: 紅色出現率 ${((redCount / total) * 100).toFixed(1)}%, 黑色出現率 ${((blackCount / total) * 100).toFixed(1)}%
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'slots':
                        title = '老虎機走勢圖';
                        
                        chartHTML = `
                            <div style="width: 100%;">
                                <h4 style="color: var(--primary-color); margin-bottom: 20px; text-align: center;">${title} (最近50次旋轉)</h4>
                                <div style="display: flex; height: 200px; align-items: flex-end; gap: 15px; margin-bottom: 30px;">
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 25%; width: 60%; background: #ff5252; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">櫻桃 12次</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 10%; width: 60%; background: #ff9800; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">7 5次</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 18%; width: 60%; background: #4caf50; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">鈴鐺 9次</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 22%; width: 60%; background: #2196f3; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">星星 11次</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 30%; width: 60%; background: #9c27b0; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">檸檬 15次</div>
                                    </div>
                                </div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; text-align: center;">
                                    數據分析: 中獎率 18%, 平均回報率 85%
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'racing':
                        title = '賽馬走勢圖';
                        
                        chartHTML = `
                            <div style="width: 100%;">
                                <h4 style="color: var(--primary-color); margin-bottom: 20px; text-align: center;">${title} (最近20場賽事)</h4>
                                <div style="display: flex; height: 200px; align-items: flex-end; gap: 15px; margin-bottom: 30px;">
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 65%; width: 60%; background: #ff5252; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">閃電飛駒 13勝</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 45%; width: 60%; background: #4caf50; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">綠色旋風 9勝</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 55%; width: 60%; background: #2196f3; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">藍色雷霆 11勝</div>
                                    </div>
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: 35%; width: 60%; background: #ff9800; border-radius: 5px;"></div>
                                        <div style="color: rgba(255,255,255,0.8); margin-top: 10px;">金色閃電 7勝</div>
                                    </div>
                                </div>
                                <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; text-align: center;">
                                    數據分析: 閃電飛駒勝率最高 (65%), 金色閃電賠率最高 (5.5)
                                </div>
                            </div>
                        `;
                        break;
                }
                
                resultContainer.innerHTML = chartHTML;
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            },
            
            generateBettingPlan() {
                const startingBankroll = parseFloat(document.getElementById('plan-starting-bankroll').value) || 0;
                const betPercentage = parseFloat(document.getElementById('plan-bet-percentage').value) || 0;
                const profitTarget = parseFloat(document.getElementById('plan-profit-target').value) || 0;
                const stopLoss = parseFloat(document.getElementById('plan-stop-loss').value) || 0;
                const chaseMultiplier = parseFloat(document.getElementById('plan-chase-multiplier').value) || 0;
                const maxChase = parseFloat(document.getElementById('plan-max-chase').value) || 0;
                
                if (startingBankroll <= 0 || betPercentage <= 0 || profitTarget <= 0 || stopLoss <= 0 || chaseMultiplier <= 0 || maxChase <= 0) {
                    return;
                }
                
                const betPerGame = startingBankroll * (betPercentage / 100);
                const profitTargetAmount = startingBankroll * (profitTarget / 100);
                const stopLossAmount = startingBankroll * (stopLoss / 100);
                const maxBetAfterChase = betPerGame * Math.pow(chaseMultiplier, maxChase);
                
                const planResult = document.getElementById('plan-result');
                if (!planResult) return;
                
                planResult.innerHTML = `
                    <h4 style="color: var(--vip-purple); margin-bottom: 15px;">投注計劃詳情</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div class="stat-card">
                            <div class="stat-value">${GameSystem.formatCurrency(betPerGame)}</div>
                            <div class="stat-label">初始下注金額</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--success-color);">${GameSystem.formatCurrency(profitTargetAmount)}</div>
                            <div class="stat-label">盈利目標金額</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--primary-color);">${GameSystem.formatCurrency(stopLossAmount)}</div>
                            <div class="stat-label">止損金額</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--warning-color);">${GameSystem.formatCurrency(maxBetAfterChase)}</div>
                            <div class="stat-label">最大追號下注</div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h5 style="color: var(--vip-purple); margin-bottom: 10px;">追號策略表</h5>
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: var(--border-radius);">
                            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; text-align: center;">
                                <div style="font-weight: 700; color: var(--vip-purple);">輸局次數</div>
                                <div style="font-weight: 700; color: var(--vip-purple);">下注倍數</div>
                                <div style="font-weight: 700; color: var(--vip-purple);">下注金額</div>
                                <div style="font-weight: 700; color: var(--vip-purple);">累積損失</div>
                                <div style="font-weight: 700; color: var(--vip-purple);">贏回目標</div>
                                
                                ${Array.from({length: maxChase + 1}, (_, i) => {
                                    const multiplier = i === 0 ? 1 : Math.pow(chaseMultiplier, i);
                                    const betAmount = betPerGame * multiplier;
                                    const totalLoss = i === 0 ? 0 : betPerGame * (Math.pow(chaseMultiplier, i) - 1) / (chaseMultiplier - 1);
                                    const winBack = totalLoss + betAmount;
                                    
                                    return `
                                        <div>${i}</div>
                                        <div>${multiplier.toFixed(1)}x</div>
                                        <div>${GameSystem.formatCurrency(betAmount)}</div>
                                        <div>${GameSystem.formatCurrency(totalLoss)}</div>
                                        <div>${GameSystem.formatCurrency(winBack)}</div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 15px; background: rgba(156,39,176,0.1); border-radius: var(--border-radius); border-left: 4px solid var(--vip-purple);">
                        <div style="color: var(--vip-purple); font-weight: 700; margin-bottom: 5px;">
                            計劃執行要點
                        </div>
                        <div style="color: rgba(255,255,255,0.8); font-size: 0.9rem; line-height: 1.5;">
                            1. 起始下注: ${GameSystem.formatCurrency(betPerGame)} MOP (${betPercentage}% 起始資金)<br>
                            2. 盈利目標: 達到 ${GameSystem.formatCurrency(profitTargetAmount)} MOP 時停止遊戲<br>
                            3. 止損點: 損失達到 ${GameSystem.formatCurrency(stopLossAmount)} MOP 時停止遊戲<br>
                            4. 追號策略: 輸局後下注增加 ${chaseMultiplier}倍，最多追 ${maxChase} 次<br>
                            5. 注意: 追號策略風險較高，建議謹慎使用
                        </div>
                    </div>
                `;
                
                // 更新任務進度（工具使用）
                GameSystem.updateTaskProgress('toolUse', 1);
            }
        };
        
        // 知識系統
        const KnowledgeSystem = {
            init() {
                // 初始化知識系統
            },
            
            showDetail(knowledgeType) {
                const knowledge = GameSystem.knowledge[knowledgeType];
                if (!knowledge) return;
                
                // 創建知識詳情彈窗
                const modal = document.createElement('div');
                modal.className = 'result-modal';
                modal.innerHTML = `
                    <div class="result-content" style="max-width: 800px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div style="font-size: 2rem; color: var(--diamond-blue);">
                                ${knowledge.title}
                            </div>
                            <button class="btn" onclick="this.parentElement.parentElement.remove()" style="padding: 10px 20px;">
                                <i class="fas fa-times"></i> 關閉
                            </button>
                        </div>
                        <div style="color: rgba(255,255,255,0.8); line-height: 1.6; max-height: 500px; overflow-y: auto; padding-right: 10px;">
                            ${knowledge.content}
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // 點擊背景關閉彈窗
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
                
                // 更新任務進度（知識學習）
                GameSystem.updateTaskProgress('knowledgeLearn', 1);
                
                // 檢查是否解鎖知識達人徽章
                if (GameSystem.playerData.knowledgeLearned >= 5) {
                    GameSystem.unlockBadge(7); // 知識達人徽章
                }
            }
        };
        
        // AI教練系統
        const AICoach = {
            askCoach(topic) {
                const messageElement = document.getElementById('coach-message');
                if (!messageElement) return;
                
                let response = '';
                
                switch(topic) {
                    case 'texas':
                        response = '德州撲克關鍵技巧：<br>1. 起手牌選擇至關重要<br>2. 位置優勢：後位可以觀察對手行動<br>3. 讀牌技巧：觀察對手下注模式<br>4. 資金管理：每局下注不超過總資金的5%';
                        break;
                    case 'mahjong':
                        response = '麻將進階技巧：<br>1. 優先完成順子<br>2. 保留有用的風牌和箭牌<br>3. 注意其他玩家打出的牌<br>4. 根據手牌決定進攻或防守策略';
                        break;
                    case 'roulette':
                        response = '輪盤策略建議：<br>1. 避免單一數字投注（概率低）<br>2. 紅色/黑色、奇數/偶數投注風險較低<br>3. 不要使用「輸了加倍」策略<br>4. 設定每局最高下注金額';
                        break;
                    case 'bankroll':
                        response = '資金管理要點：<br>1. 設定遊戲預算，絕不超過<br>2. 每次下注不超過總資金的2-5%<br>3. 設定止損點和止盈點<br>4. 記錄遊戲結果，分析表現';
                        break;
                    default:
                        response = '請選擇具體的指導項目，我可以為您提供專業建議。';
                }
                
                messageElement.innerHTML = response;
                
                // 檢查是否解鎖AI教練使用成就
                if (!GameSystem.playerData.aiCoachUsed) {
                    GameSystem.playerData.aiCoachUsed = true;
                    GameSystem.saveToStorage();
                }
            }
        };
        
        // 全局函數（用於HTML中的onclick事件）
        function showPage(pageId) {
            PageSystem.show(pageId);
        }
        
        function goBack() {
            PageSystem.goBack();
        }
        
        // 撲克遊戲函數
        function selectPokerGame(gameType) {
            PokerGame.selectGame(gameType);
        }
        
        function playTexasPoker() {
            PokerGame.play();
        }
        
        function texasPokerAction(action) {
            PokerGame.action(action);
        }
        
        // 麻將遊戲函數
        function playMahjong() {
            MahjongGame.play();
        }
        
        function mahjongAction(action) {
            MahjongGame.action(action);
        }
        
        function selectTile(index) {
            MahjongGame.selectTile(index);
        }
        
        // 輪盤遊戲函數
        function selectRouletteBet(bet) {
            RouletteGame.selectBet(bet);
        }
        
        function spinRoulette() {
            RouletteGame.spin();
        }
        
        // 老虎機遊戲函數
        function changeSlotBet(change) {
            SlotGame.changeBet(change);
        }
        
        function changeSlotLines(change) {
            SlotGame.changeLines(change);
        }
        
        function spinSlots() {
            SlotGame.spin();
        }
        
        // 賽馬遊戲函數
        function selectRacingBet(horseId) {
            RacingGame.selectHorse(horseId);
        }
        
        function startRace() {
            RacingGame.startRace();
        }
        
        // 彩票遊戲函數
        function quickPickNumbers() {
            GameSystem.quickPickNumbers();
        }
        
        function clearNumbers() {
            GameSystem.clearNumbers();
        }
        
        function changeLotteryTickets(change) {
            GameSystem.changeLotteryTickets(change);
        }
        
        function drawLottery() {
            LotteryGame.draw();
        }
        
        // 社交系統函數
        function showLeaderboard(type) {
            SocialSystem.showLeaderboard(type);
        }
        
        function startRecording() {
            SocialSystem.startRecording();
        }
        
        function shareToSocial(platform) {
            SocialSystem.shareToSocial(platform);
        }
        
        function createFriendRoom() {
            SocialSystem.createFriendRoom();
        }
        
        // 工具系統函數
        function selectTool(toolId) {
            ToolsSystem.selectTool(toolId);
        }
        
        // 主題切換函數
        function toggleThemeSelector() {
            const selector = document.getElementById('theme-selector');
            if (selector) {
                selector.style.display = selector.style.display === 'none' ? 'block' : 'none';
            }
        }
        
        function changeTheme(themeName) {
            GameSystem.changeTheme(themeName);
        }
        
        // 時間提醒函數
        function hideReminder() {
            const reminder = document.getElementById('time-reminder');
            if (reminder) {
                reminder.style.display = 'none';
            }
        }
        
        // 追號策略函數
        function toggleChaseStrategy() {
            RouletteGame.toggleChaseStrategy();
        }
        
        // 自動旋轉函數
        function toggleAutoSpin() {
            SlotGame.toggleAutoSpin();
        }
        
        // 走勢圖函數
        function showRouletteTrendChart() {
            RouletteGame.showTrendChart();
        }
        
        function hideTrendChart() {
            RouletteGame.hideTrendChart();
        }
        
        // 錄影分享函數
        function recordSlotWin() {
            SlotGame.recordSlotWin();
        }
        
        // 手牌分析函數
        function analyzePokerHand() {
            PokerGame.analyzeHand();
        }
        
        function analyzeMahjongHand() {
            MahjongGame.analyzeHand();
        }
        
        // AI教練函數
        function askCoach(topic) {
            AICoach.askCoach(topic);
        }
        
        // 風險評測函數
        function selectRiskTestOption(questionId, optionIndex) {
            GameSystem.selectRiskTestOption(questionId, optionIndex);
        }
        
        function submitRiskTest() {
            GameSystem.submitRiskTest();
        }
        
        // 知識系統函數
        function showKnowledgeDetail(knowledgeType) {
            KnowledgeSystem.showDetail(knowledgeType);
        }
        
        // 創建私人房間
        function createPrivateRoom() {
            alert('私人遊戲房間已創建！\n房間ID: VIPROOM888\n密碼: 私密\n\n您可以自定義遊戲規則並邀請其他VIP玩家加入。');
        }
        
        // 工具系統函數
        function generateTrendChart(gameType) {
            ToolsSystem.generateTrendChart(gameType);
        }
        
        // 初始化系統
        document.addEventListener('DOMContentLoaded', () => {
            GameSystem.init();
            
            // 設置滑動條事件
            const pokerSlider = document.getElementById('poker-bet-slider');
            if (pokerSlider) {
                pokerSlider.addEventListener('input', function() {
                    const betAmount = this.value;
                    document.getElementById('poker-bet-amount').textContent = betAmount;
                    GameSystem.poker.betAmount = parseInt(betAmount);
                });
            }
            
            const rouletteSlider = document.getElementById('roulette-bet-slider');
            if (rouletteSlider) {
                rouletteSlider.addEventListener('input', function() {
                    const betAmount = this.value;
                    document.getElementById('roulette-bet-amount').textContent = betAmount;
                    GameSystem.roulette.betAmount = parseInt(betAmount);
                });
            }
            
            const racingSlider = document.getElementById('racing-bet-slider');
            if (racingSlider) {
                racingSlider.addEventListener('input', function() {
                    const betAmount = this.value;
                    document.getElementById('racing-bet-amount').textContent = betAmount;
                    GameSystem.racing.betAmount = parseInt(betAmount);
                });
            }
            
            // 檢查是否首次訪問，顯示歡迎消息
            const firstVisit = !localStorage.getItem('casinoSimFirstVisit');
            if (firstVisit) {
                setTimeout(() => {
                    GameSystem.showResultModal(
                        '歡迎來到澳門豪華博彩模擬平台！',
                        '本系統為純粹的博彩娛樂模擬體驗平台，僅供娛樂和教育目的。所有遊戲使用虛擬貨幣，不涉及真實金錢交易。',
                        true,
                        0
                    );
                    localStorage.setItem('casinoSimFirstVisit', 'true');
                }, 1000);
            }
        });
    </script>
</body>
</html>